#!/usr/bin/env node 
import*as e from"node:path";import{resolve as r,parse as n,basename as i,relative as o,sep as a,join as s,extname as l,delimiter as p,dirname as c}from"node:path";import{fileURLToPath as u,pathToFileURL as d}from"node:url";import*as f from"node:fs";import{statSync as m,readFileSync as h,writeFileSync as g,openSync as y,writevSync as v,closeSync as w,unlinkSync as b,readdirSync as x,existsSync as E,readSync as T,createWriteStream as k}from"node:fs";import{basename as S,extname as A}from"node:path/posix";import{Blob as O}from"node:buffer";import{AsyncLocalStorage as N}from"node:async_hooks";import*as j from"node:util";import{inspect as I,formatWithOptions as L}from"node:util";import{Console as $}from"node:console";import*as q from"node:crypto";import{randomUUID as R}from"node:crypto";import D from"node:http";import"node:inspector";function U(e,...t){let r=e[0];for(let n=0;n<t.length;++n)r+=JSON.stringify(t[n])+e[n+1];return r}function _(e){try{return m(e)}catch{return null}}(void 0===Object.groupBy||globalThis.CHECK_POYFILLS)&&(Object.groupBy=(e,t)=>e.reduce(((e,r)=>{const n=t(r);return e[n]??=[],e[n].push(r),e}),{})),("function"!=typeof Set.prototype.intersection||globalThis.CHECK_POYFILLS)&&(Set.prototype.intersection=function(e){const t=new Set;for(const r of e)this.has(r)&&t.add(r);return t}),async function(){process.removeAllListeners("warning");const e=await Promise.resolve().then((function(){return Lp})),t=await e.default();process.exit(t)}();const C="dir",M="file",P="";function z(e){const t="string"==typeof e?_(e):e;if(null==t)return P;if(t.isDirectory())return C;if(t.isFile())return M;if(t.isFIFO()||t.isSocket())return"pipe";if(t.isSymbolLink())return"link";if(t.isBlockDevice()||t.isCharacterDevice())return"device";throw new TypeError("What the hell file type is it then?!")}const B=new RegExp(`.*?(?=${/[!?$%^=@#~()[\]{}<>&|,;`'"]/.source}|\\s|::|$)`,"y"),F=/(["'])(.*?)\1/sy,V=/\s+--(?=\s)/y,J=/.*?(?=\r?\n|$)/y,W=/.*?(?:\r?\n|$)/y,G="::",H="$0";function K(e,t){if(!t.match(V))return e;const r=t.match(J);return e.annotation=r,e}function X(e){let t;return(t=e.exec(F))?{value:t[2],quoted:!0}:{value:e.match(B),quoted:!1}}function Z(e){const{value:t,quoted:r}=X(e),n=new String(t);return n.quoted=r,n}const Y=/\s+/y;function Q(e,t,r=0){return e.lastIndex=r,e.test(t)?e.lastIndex-r:0}function ee(e,t,r=0){if("string"==typeof e)return t.startsWith(e,r)?e.length:0;if("function"==typeof e){const n=e(t,r);if(!Number.isInteger(n)||n<0||r+n>t.length)throw new TypeError("Invalid matcher result");return n}if(void 0!==e.sticky&&!0!==e.sticky)throw new TypeError("RegExp-like must be sticky");return Q(e,t,r)}class te{#e;#t;#r;#n;#i;constructor(e,{pos:t=0,ws:r=Y,autoTrim:n=!1,trimStart:i=n}={}){this.#e=e,this.#t=i?t+Q(r,e,t):t,this.#n=n,this.#r=r,this.#i=this.#t}match(e,t=this.#n){const{trimEnd:r=!1,lookahead:n=!1}="object"==typeof t&&t?t:{trimEnd:!!t,lookahead:!1},i=this.#t,o=this.#e,a=ee(e,o,i);if(!a)return"";const s=i+a;return n||(this.#i=i,this.#t=r?s+Q(this.#r,o,s):s),"string"==typeof e?e:o.slice(i,s)}exec(e,t=this.#n){const{trimEnd:r=!1,lookahead:n=!1}="object"==typeof t&&t?t:{trimEnd:!!t,lookahead:!1};if(!0!==e.sticky)throw new TypeError("Must be a sticky RegExp-like");const i=this.#e,o=this.#t;e.lastIndex=o;const a=e.exec(i);if(!n&&a){const t=e.lastIndex;this.#i=o,this.#t=r?t+Q(this.#r,i,t):t}return a}startsWith(e){return 0!==ee(e,this.#e,this.#t)}trimStart(){const e=Q(this.#r,this.#e,this.#t);return!!e&&(this.#t+=e,!0)}get lastIndex(){return this.#i}get pos(){return this.#t}getPos(){return this.#t}atEof(){return this.#t>=this.#e.length}slice(e){const t=this.#t;return e>t?this.#e.slice(t,e):this.#e.slice(e,t)}tail(){return this.#e.slice(this.#t)}error(e,t=this.#t,r=this.#t){t<0&&(t+=this.#t);const n=new Error(e+=` at ${r}`);return n.type="parse",n.sourceIndex=t,n.sourceStartIndex=t,n.sourceEndIndex=r,n.sourceText=this.#e,n}warn(e,t){const r=this.error(e,t);console.warn(r.message)}getText(){return this.#e}fence(){return this.#t}rollback(e=this.#i){this.#t=e}}const re=Symbol.for("js-hell.realiseTo"),ne=Symbol.for("js-hell.valueForEquals"),ie=Symbol.for("js-hell.typeof"),oe=Symbol("default-missing-bool"),ae=Symbol.for("js-hell.explict-variables"),se="[]",le="*",pe="",ce="async*",ue=Symbol("is async?"),de="lookup",fe="array",me="object",he="callback",ge="call",ye="method",ve="value",we="unary",be="binary",xe="ternary",Ee="??",Te="as",ke="instanceof",Se="index",Ae="sync",Oe="typeof",Ne="globals",je="imports",Ie="locals";function Le(e){return{type:ve,async:!1,value:e}}function $e(e){return e.type===ve}function qe(e,{scope:t,defaultValue:r,option:n=!1,typename:i="",write:o=!1}={}){return{type:de,parent:null,name:e,scope:t,defaultValue:r,option:n,typename:i,write:o}}function Re(e){return{type:fe,value:e}}function De(e,t,r,{defaulted:n=!1,pipeIndex:i=0,exprType:o}={}){return{type:be,op:e,lhs:t,rhs:r,defaulted:n,pipeIndex:i,exprType:o}}function Ue(e,t,r){if("function"==typeof t)throw new TypeError("Not supported");let n,i,o;if("object"==typeof t)({start:i,end:o}=t);else{if(void 0===t)throw new TypeError("subscripts may not be undefined");n=t}return{type:we,op:Se,object:e,property:n,start:i,end:o}}function _e(e,t,{exprType:r}={}){return{type:we,op:e,object:t,exprType:r}}function Ce(e,t,r,n=[],{new:i=!1,import:o=!1}={}){return{type:e,new:i,object:r,name:t,args:n,import:e===ge&&o}}function Me(e,t=[],r){return Ce(ge,e,null,t,r)}function Pe(e,t,r=[],n){const i=Ce(ye,e,t,r,n);return t.parent=i,i}function ze(e){return _e(Ae,e)}function Be(e,t){if(void 0===e&&void 0===t)return!0;if(e.type!==ve||t.type!==ve)throw new Error("Cannot compare nodes");if(!1!==e.async||!1!==t.async)throw new Error("Async should be false on all nodes");return Object.is(e.value,t.value)}function Fe(e=null,t){const r=Object.create(e);for(let e=0;e<t.length;e+=2){const n=t[e],i=t[e+1];Object.defineProperty(r,n,{value:i,writable:!1,configurable:!1,enumerable:!0})}return r}const Ve=/[A-Za-z0-9_$]/y;function Je(e){return(t,r)=>function(e,t,r){return t.startsWith(e,r)?(Ve.lastIndex=r+e.length,Ve.test(t)?0:e.length):0}(e,t,r)}function We(e){const{basetype:t}=e;switch(e.enum){case ce:return`async*${t}`;case le:return`*${t}`;case se:return`${t}[]`;case pe:return t;default:throw new Error("Unknown enumeration type")}}class Ge{basetype;enum;constructor(e,t=""){this.basetype=e,this.enum=t}isScalar(e){return this.enum===pe&&this.basetype===e}}const He=/\$-|[A-Za-z_$][A-Za-z_$0-9]*/y,Ke=/[A-Za-z_][A-Za-z_$0-9]*/y,Xe=/async(?![A-Za-z_$0-9]|\s*\*)/y,Ze=/=(?![=>])/y,Ye=/[-+]?\d+/y,Qe=/[-+]?\d+/y,et=/%\d*/y,tt=/[^"\\\r\n\u2028\u2029]+/y,rt=/[^'\\\r\n\u2028\u2029]+/y,nt=/['"\\]/y,it=/[\n\u2028\u2029]|\r\n?/y,ot=/[bfnrtv]/y,at=/u[0-9A-Fa-f]{4}/y,st=/\[(?!\s*\])/y,lt=/\?(?!\?)/y,pt=/[^`\\$\r\n\u2028\u2029]*/y,ct=/[\n\u2028\u2029]|\r\n?/y,ut=/['"\\bfnrtv]/y,dt=/x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}/y,ft=/u\{[0-9A-Fa-f]+\}/y,mt="every reference";function ht(e){let t="";for(;;){if(e.type===de)return t||e.name;if(e.type!==we||e.op!==Se)return"";if("string"!=typeof e.property||void 0!==e.property.start||void 0!==e.end)return"";t||(t=e.property),e=e.object}}function gt(e,t,r=!0){if(e.type===be){if(","!==e.op)return null;const n=gt(e.lhs,t,r),i=gt(e.rhs,t,r);return n&&i?[...n,...i]:null}return e.type===de?(r&&St(t,e),[e.name]):null}function yt(e,t,r){let n="";for(;;){if(n+=e.match(t,!1),e.match(r,!0))return n;if(!e.match("\\",!1))throw e.error("Unterminated string");let i;if(""!==(i=e.match(nt,!1)))n+=i;else if(""!==(i=e.match(at,!1)))n+=String.fromCharCode(parseInt(i.slice(1),16));else if(""!==(i=e.match(ot,!1))){const e="bfnrtv".indexOf(i);n+="\b\f\n\r\t\v".charAt(e)}else{if(""!==e.match(/[x0-9]/y,!1))throw e.error("unsupported escape sequence");e.match(it,!1)}}}function vt(e){return""!==e.match('"',!1)?Le(yt(e,tt,'"')):""!==e.match("'",!1)?Le(yt(e,rt,"'")):null}function wt(e,t){let r,n,i;return""!==(r=e.match(Ye,!0))?Le(parseFloat(r)):(n=vt(e))?n:(i=function(e,t,r=!1){if(!e.match("`"))return null;const n=er(e,t,{raw:r,terminated:!0});return e.trimStart(),n}(e,t))?i:""!==e.match("true",!0)?Le(!0):""!==e.match("false",!0)?Le(!1):""!==e.match("null",!0)?Le(null):""!==e.match("undefined",!0)?Le(void 0):null}function bt(e,t,r){if(e.match(".",!0)){const n=e.match(He,!0);if(!n)throw e.error("expected identifier");if(!e.match("(",!0))return Ue(t,n);return Pe(n,t,Ct(e,")",r))}const n=function(e,t){if(!e.match(st,!0))return;let r,n;if(n=vt(e))r=n.value;else{const n=e.match(Qe,!0);r=""!==n?parseInt(n,10):Rt(e,t)}if(!e.match("]",!0))throw e.error("expected ']'");return e.trimStart(),r}(e,r);return void 0===n?t:"object"==typeof n?De(".",t,n):Ue(t,n)}function xt(e){const t=e.match(He,!0);if(!t)throw e.error("expected identifier");return t}function Et(e){return qe(xt(e))}function Tt(e,t,r={}){const n=xt(e),i=At(t,n),o=qe(n,{scope:i,...r});return Ot(t,o,n,i),o}function kt(e,t){const r=wt(e,t)||function(e,t){if(!e.match("@"))return null;if(!e.match(Je("option")))throw e.error("@option is the only decorated currently supported");let r="";if(e.match("(",!0)){if(r=xt(e),!e.match(")",!0))throw e.error("expected ')'")}else e.trimStart();const n=Tt(e,t,{option:!0,typename:r});if(n.scope!==Ne)throw e.error("@option can only decorate globals");return n}(e,t);if(r)return r;if(e.match("(",!0)){let r=Ft(e,t);for(;e.match(",",!0);)r=De(",",r,Ft(e,t));if(!e.match(")",!0))throw e.error("expected ')'");return r}{const r=e.match(et,!0);if(r)return qe(r,{scope:Ie});{const r=Et(e);return function(e,t){const{name:r}=t,n=At(e,r);Ot(e,t,r,n),t.scope=n}(t,r),r}}}function St(e,t){if(t.scope===Ie)return;const r=t.scope===Ne?e.globals:t.scope===je?e.imports:null;if(!r.has(t.name))return;const n=r.get(t.name);n.delete(t),0===n.size&&t.scope===Ne&&r.delete(t.name)}function At(e,t){return void 0!==e.locals?.[t]?Ie:e.imports.has(t)?je:Ne}function Ot(e,t,r,n){n===je?e.imports.get(r).add(t):n===Ne&&(e.globals.has(r)?e.globals.get(r).add(t):e.globals.set(r,new Set([t])))}function Nt(e,t){const r=e.pos;let n=!!e.match(Je("new"),!0),i=kt(e,t);if(i.type===de){if(e.match("(",!0)){if(i.option)throw e.error("@option can decorate function calls");const r=i;i=Me(r.name,Ct(e,")",t)),i.new=n,n=!1,function(e,t,r){if(t.scope===Ie)return;const n=(t.scope===Ne?e.globals:t.scope===je?e.imports:null).get(t.name);n.delete(t),n.add(r),r.import=t.scope===je}(t,r,i)}}else if(n)throw e.error("`new` not allowed here",r);for(;;){const o=bt(e,i,t);if(n){if(o.type===ye){if(!ht(o.object))throw e.error("`new` not allowed here",r);o.new=n,n=!1}else if(o===i)throw e.error("`new` not allowed here",r)}else if(o===i)return i;i=o}}function jt(e){const t=!!e.match(Je("async"),!0);if(e.match("*",!0))return t?ce:le;if(t)throw e.error("expected '*' following 'async'");return pe}function It(e,t){if(e.match(Je("typeof"),!0))return _e(Oe,It(e,t),{exprType:new Ge("string")});if(e.match("!",!0))return _e("!",It(e,t),{exprType:new Ge("boolean")});const r=jt(e),n=r===pe&&function(e,t){if("await"!==e.match(Je("await"),!0))return!1;if(!0!==t.async)throw e.error("await cannot be used outside of an async context");return!0}(e,t);let i=Nt(e,t);return n?i=ze(i):r===le?i=Pe(Symbol.iterator,i,[]):r===ce&&(i=Pe(Symbol.asyncIterator,i,[])),i}function Lt(e,t){const r=It(e,t);if(!e.match(Je("instanceof"),!0))return r;const n=function(e,t){let r=Tt(e,t);for(;e.match(".",!0);){const t=r;r=Ue(t,xt(e)),null===t.parent&&(t.parent=r)}return r}(e,t);return De(ke,r,n,{exprType:new Ge("boolean")})}const $t=function(e,t){let r=Lt(e,t);if(e.match("===",!0))r=De("===",r,Lt(e,t),{exprType:new Ge("boolean")});else{if(!e.match("!==",!0))return r;r=De("!==",r,Lt(e,t),{exprType:new Ge("boolean")})}if(e.match("===")||e.match("!=="))throw e.error("another equality operator is not permitted here (without brackets)");return r};function qt(e,t,r){const n=zt(e,r);if(!e.match(":",!0))throw e.error("expected ':'");return function(e,t,r){return{type:xe,condition:e,true:t,false:r}}(t,n,zt(e,r))}function Rt(e,t,r=0){const n=function(e,t,r){if(!e.match("??",!0))return t;if($e(t))throw e.Error("Can't use a literal on the LHS of ??");const n=zt(e,r);return De(Ee,t,n)}(e,$t(e,t),t);if(e.match(lt,!0)){if(r)throw e.error("cannot mix ternary and pipe expressions");if($e(n))throw e.Error("Can't use a literal on the LHS of a ternary");const i=qt(e,n,t);if(e.match("|>",!0))throw e.error("cannot mix ternary and pipe expressions");return i}if(e.match("|>",!0)){return De("|>",n,Rt(e,t,r+1),{pipeIndex:r+1})}return n}function Dt(e,t){const r=Rt(e,t),{pos:n}=e,i=function(e,t){if(!e.match(Ze,!0))return null;const r=e.pos,n=wt(e,t);if(!n||!$e(n))throw e.error("expected literal",r);return n}(e,t);if(!i)return r;if(!ht(r))throw e.error("defaulting not permitted here",n);if(r.type===de){if(r.option&&r.typename&&typeof i.value!==r.typename)throw e.error("defaulted value must have the same type as is declared in the option",n);return r.defaultValue=i,r}return De(Ee,r,i,{defaulted:!0})}function Ut(e){return e.type===be&&e.op===Ee&&!0===e.defaulted}function _t(e,t,r){if(e.match("...",!0))return _e("...",zt(e,r));const n=!!e.match(Xe,!0),i=zt(e,r);if(t){const t=gt(i,r,!1);if(t){const o=function(e,t,r,n){if(!e.match("=>",!0))return;const i=Fe(t,["async",r,"locals",Fe(t.locals,n.flatMap((e=>[e,!0])))]);return Bt(e,i)}(e,r,n,t);if(o)return gt(i,r,!0),function(e,t,r=!1){return{type:he,async:r,expr:t,freeVariableNames:e}}(t,o,n)}}if(n)throw e.error("cannot use async here");return i}function Ct(e,t,r){const n=[],i=")"===t;if(!e.match(t,!0))for(;;){n.push(_t(e,i,r));const o=e.match(",",!0);if(e.match(t,!0))break;if(!o)throw e.error("expected ',' or ')'")}return n}function Mt(e,t){if(!e.match("[",!0))return;return Re(Ct(e,"]",t))}function Pt(e,t){if(!e.match("{",!0))return;const r=[];if(!e.match("}",!0))for(;;){const{pos:n}=e,i=Dt(e,t);let o,a;if(i.type===de&&e.match(":",!0))St(t,i),o=i.name,a=zt(e,t);else{const t=ht(Ut(i)?i.lhs:i);if(!t)throw e.error("cannot use argument as a shorthand",n);o=t,a=i}if(-1!==o.indexOf("$"))throw new TypeError("Property name cannot contain `$`");if(r.push([o,a]),e.match("}",!0))break;if(!e.match(",",!0))throw e.error("expected ',' or '}'")}return{type:me,value:r}}function zt(e,t){return Mt(e,t)??Pt(e,t)??Dt(e,t)}function Bt(e,t){return Mt(e,t)??Rt(e,t)}function Ft(e,t){return Mt(e,t)??Pt(e,t)??Rt(e,t)}const Vt=["void","undefined","null"];function Jt(e){const t=[];for(const[r,n]of e){const e=n[Symbol.iterator](),i=e.next();if(i.done)throw new Error(U`No options for global ${r}`);if(!i.value.option){if(!Array.from(e).every((e=>!e.option)))throw new Error(U`Every reference to ${r} must be declared an option`);continue}for(const t of e){if(!t.option)throw new Error(`${mt} to ${JSON.stringify(r)} must be declared an option`);if(t.typename!==i.value.typename)throw new Error(`${mt} to ${JSON.stringify(r)} must be declared with the same type`);if(!Be(t.defaultValue,i.value.defaultValue))throw new Error(`${mt} to ${JSON.stringify(r)} must have identical default value`)}if(i.value.defaultValue&&i.value.defaultValue.type!==ve)throw new Error("@option can only be declared with literal values.");const o=!!i.value.typename,a=!!i.value.defaultValue;t.push({name:r,hasExplicitTypename:o,typename:o?i.value.typename:a?typeof i.value.defaultValue.value:"",hasDefaultValue:a,defaultValue:i.value.defaultValue?.value})}return t}const Wt="expr",Gt="embedded",Ht="binding",Kt="template",Xt="template-tail";function Zt(e,t=Wt){"boolean"==typeof t&&console.warn("_parse invoked with boolean - upgrade to a const"),!0===t?t=Wt:!1===t&&(t=Ht);const r={api:1,async:!0,globals:void 0,imports:void 0,locals:Fe(null,[])},n=t===Ht,i=t===Kt||t===Xt;i||e.trimStart();const o=n?e.match(He,!1)||(console.warn("warning: IDL omitted function name"),"default"):"";if("with"===o&&e.trimStart(),n&&!e.match("(",!0))throw new TypeError("Expected '('");const a="with"===o,s=!n||a,l=n?a?function(e){const t=[];for(;;){if(e.match(")",!0))return t;if(t.push(Et(e).name),e.match(")",!0))return t;if(!e.match(",",!0))throw e.error("exepcted ','")}}(e):[o]:[],p=new Map(Array.from(l,(e=>[e,new Set])));r.globals=new Map,r.imports=p;let c=i?er(e,r,{raw:!1,terminated:t!==Kt}):s?Bt(e,r):function(e,t){return ze(Me(e,t,{import:!0}))}(o,Ct(e,")",r));if(!s){const e=p.get(o);if(0!==e.size)throw new Error(`import \`${o}\` should not be referenced - except in the principle call`);e.add(function(e){if(e.type===be&&e.op===Te&&(e=e.lhs),e.type!==we||e.op!==Ae)throw new Error("expected root to be an await()");const{object:t}=e;if(void 0===t||t.type!==ge)throw new Error("expected await to wrap a call");if(!0!==t.import)throw new Error("expected call to be an import");return t}(c))}let u=function(e,t="to"){if(!e.match(t,!0))return;const r=jt(e);let n=Pt(e);if(!n&&(n=e.match(Ke,!0),!n))throw new TypeError("Expected identifier");const i=function(e){if(!e.match("[",!0))return!1;if(e.match("]",!0))return!0;throw e.error("expected ']' following '['")}(e);if(r!==pe&&i)throw new TypeError("Cannot be both iterator and array");return new Ge(n,i?se:r)}(e,"as"),d=!1;if(!s&&e.match("->",!0)){const t=xt(e);if(At(r,t)!==Ne)throw e.error("'->' can only be used on globals");const n=qe(t,{scope:Ne,write:!0});Ot(r,n,t,Ne),c=function(e,t,r){return{type:"->",sourceValue:e,destIdentifier:t,typeAssertion:r}}(c,n,u),u=void 0,d=!0}if(u&&(c=De(Te,c,function(e,t){let r;return r=e.charAt(0).toUpperCase()===e.charAt(0)?`${e}.is${e}(%) ?? % instanceof ${e}`:e.toLowerCase()===e?`typeof % === ${JSON.stringify(e)}`:"0",Ft(new te(r),t)}(u.basetype,r)),c.exprType=u),s){const e=l.filter((e=>0===p.get(e).size));if(e.length)throw new Error(`Unused imports ${e.join(" ")}`)}if(!e.atEof()&&t!==Gt&&t!==Xt)throw e.error("Expected eof.");const f=Jt(r.globals);return{importReferences:p,globalReferences:r.globals,imports:l,typeAssertion:u,args:c,inlineOptions:f,isVoid:d,nonWith:n&&!a}}const Yt={"\\":"\\","'":"'",'"':'"',b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"};function Qt(e){let t;return(t=e.match(ut))?Yt[t]:e.match(/./y)}function er(e,t,{raw:r,terminated:n}){const i=function*(e,t=!0){let r,n="";for(;;){if(n+=e.match(pt,!1),e.atEof()){if(t)throw e.error("expected `");return n}if(e.match("`",!1)){if(t)return n;n+="`"}else if(e.match("$",!1))if(e.match("{",!0))yield n,n="";else{if(e.match("(",!1))throw e.error("Embedded CLI calls not yet supported",e.pos-2,e.pos-2);n+="$"}else if(e.match("\\",!1))if(e.match(/0(?!\d)/y,!1))n+="\0";else if(r=e.match(ct))n+="";else if(r=e.match(dt,!1))n+=String.fromCharCode(parseInt(r.slice(1),16));else if(r=e.match(ft,!1)){const e=parseInt(r.slice(2,-1),16);if(!(e<=1114111))throw new SyntaxError("Invalid template");n+=String.fromCodePoint(e)}else{if(!(r=Qt(e)))throw e.error("not implemented");n+=r}else{if(!(r=e.match(ct,!1)))throw e.error("not implemented");n+=r}}}(e,n),o=[];for(;;){const{value:r,done:n}=i.next();if(r.length&&o.push(Le(r)),n)break;if(o.push(Bt(e,t)),e.trimStart(),!e.match("}"))throw e.error("expected '}'")}if(0===o.length)return Le("");if(1===o.length){const e=o[0];return $e(e)&&"string"==typeof e.value?e:Pe("toString",e)}return Pe("join",Re(o),[Le("")])}function tr(e){return!("object"!=typeof e||!e)&&("function"==typeof e.next&&("function"==typeof e[Symbol.iterator]&&e[Symbol.iterator]()===e))}function rr(e){return"object"==typeof e&&e&&"Generator"===e[Symbol.toStringTag]}class nr{#o;#a;constructor(e,t){this.#o=t,this.#a=e}get name(){return this.#o}fromString(e){if(this.#a!==e)throw new TypeError(`Expected literal ${JSON.stringify(this.#a)} for ${this.#o}`);return e}get literal(){return!0}get enum(){return!1}}class ir{fullPath;constructor(t){this.fullPath=e.resolve(t)}async getFile(t){const r=e.resolve(this.fullPath,"..",t),n=f.readFileSync(r);return new or([n],r,{fileSystemEntry:new ir(r)})}getFileFromRelativeURL(e){return getFile(u(new URL(e,d(this.fullPath)+"/.")))}relativePathFromUrl(t,r=this){const n=d(this.fullPath),i=u(new URL(t,n));return e.relative(e.resolve(r.fullPath,".."),i)}async getParent(){return new ir(e.join(this.fullPath,".."))}toURL(){return d(this.fullPath)}}class or extends O{name;lastModified;webkitRelativePath;fileSystemEntry;constructor(t,r,{type:n="",lastModified:i=Date.now(),fileSystemEntry:o=new ir(r)}={}){super(t,{type:n}),Object.assign(this,{name:e.basename(r),lastModified:i,webkitRelativePath:r,fileSystemEntry:o})}}var ar={".123":"application/vnd.lotus-1-2-3",".1km":"application/vnd.1000minds.decision-model+xml",".3dml":"text/vnd.in3d.3dml",".3ds":"image/x-3ds",".3g2":"video/3gpp2",".3gp":"video/3gpp",".3mf":"model/3mf",".7z":"application/x-7z-compressed",".aab":"application/x-authorware-bin",".aac":"audio/x-aac",".aam":"application/x-authorware-map",".aas":"application/x-authorware-seg",".abw":"application/x-abiword",".acc":"application/vnd.americandynamics.acc",".ace":"application/x-ace-compressed",".acu":"application/vnd.acucobol",".acutc":"application/vnd.acucorp",".adp":"audio/adpcm",".aep":"application/vnd.audiograph",".afm":"application/x-font-type1",".afp":"application/vnd.ibm.modcap",".age":"application/vnd.age",".ahead":"application/vnd.ahead.space",".ai":"application/postscript",".aif":"audio/x-aiff",".aifc":"audio/x-aiff",".aiff":"audio/x-aiff",".air":"application/vnd.adobe.air-application-installer-package+zip",".ait":"application/vnd.dvb.ait",".ami":"application/vnd.amiga.ami",".amr":"audio/amr",".apk":"application/vnd.android.package-archive",".apng":"image/apng",".appcache":"text/cache-manifest",".application":"application/x-ms-application",".apr":"application/vnd.lotus-approach",".arc":"application/x-freearc",".arj":"application/x-arj",".asf":"video/x-ms-asf",".asm":"text/x-asm",".aso":"application/vnd.accpac.simply.aso",".asx":"video/x-ms-asf",".atc":"application/vnd.acucorp",".atom":"application/atom+xml",".atomcat":"application/atomcat+xml",".atomdeleted":"application/atomdeleted+xml",".atomsvc":"application/atomsvc+xml",".atx":"application/vnd.antix.game-component",".au":"audio/basic",".avci":"image/avci",".avcs":"image/avcs",".avi":"video/x-msvideo",".avif":"image/avif",".aw":"application/applixware",".azf":"application/vnd.airzip.filesecure.azf",".azs":"application/vnd.airzip.filesecure.azs",".azv":"image/vnd.airzip.accelerator.azv",".azw":"application/vnd.amazon.ebook",".b16":"image/vnd.pco.b16",".bat":"application/x-msdownload",".bcpio":"application/x-bcpio",".bdf":"application/x-font-bdf",".bdm":"application/vnd.syncml.dm+wbxml",".bed":"application/vnd.realvnc.bed",".bh2":"application/vnd.fujitsu.oasysprs",".bin":"application/octet-stream",".blb":"application/x-blorb",".blorb":"application/x-blorb",".bmi":"application/vnd.bmi",".bmml":"application/vnd.balsamiq.bmml+xml",".book":"application/vnd.framemaker",".box":"application/vnd.previewsystems.box",".boz":"application/x-bzip2",".bpk":"application/octet-stream",".bsp":"model/vnd.valve.source.compiled-map",".btif":"image/prs.btif",".buffer":"application/octet-stream",".bz":"application/x-bzip",".bz2":"application/x-bzip2",".c":"text/x-c",".c11amc":"application/vnd.cluetrust.cartomobile-config",".c11amz":"application/vnd.cluetrust.cartomobile-config-pkg",".c4d":"application/vnd.clonk.c4group",".c4f":"application/vnd.clonk.c4group",".c4g":"application/vnd.clonk.c4group",".c4p":"application/vnd.clonk.c4group",".c4u":"application/vnd.clonk.c4group",".cab":"application/vnd.ms-cab-compressed",".caf":"audio/x-caf",".cap":"application/vnd.tcpdump.pcap",".car":"application/vnd.curl.car",".cat":"application/vnd.ms-pki.seccat",".cb7":"application/x-cbr",".cba":"application/x-cbr",".cbr":"application/x-cbr",".cbt":"application/x-cbr",".cbz":"application/x-cbr",".cc":"text/x-c",".cco":"application/x-cocoa",".cct":"application/x-director",".ccxml":"application/ccxml+xml",".cdbcmsg":"application/vnd.contact.cmsg",".cdf":"application/x-netcdf",".cdfx":"application/cdfx+xml",".cdkey":"application/vnd.mediastation.cdkey",".cdmia":"application/cdmi-capability",".cdmic":"application/cdmi-container",".cdmid":"application/cdmi-domain",".cdmio":"application/cdmi-object",".cdmiq":"application/cdmi-queue",".cdx":"chemical/x-cdx",".cdxml":"application/vnd.chemdraw+xml",".cdy":"application/vnd.cinderella",".cer":"application/pkix-cert",".cfs":"application/x-cfs-compressed",".cgm":"image/cgm",".chat":"application/x-chat",".chm":"application/vnd.ms-htmlhelp",".chrt":"application/vnd.kde.kchart",".cif":"chemical/x-cif",".cii":"application/vnd.anser-web-certificate-issue-initiation",".cil":"application/vnd.ms-artgalry",".cjs":"application/node",".cla":"application/vnd.claymore",".class":"application/java-vm",".clkk":"application/vnd.crick.clicker.keyboard",".clkp":"application/vnd.crick.clicker.palette",".clkt":"application/vnd.crick.clicker.template",".clkw":"application/vnd.crick.clicker.wordbank",".clkx":"application/vnd.crick.clicker",".clp":"application/x-msclip",".cmc":"application/vnd.cosmocaller",".cmdf":"chemical/x-cmdf",".cml":"chemical/x-cml",".cmp":"application/vnd.yellowriver-custom-menu",".cmx":"image/x-cmx",".cod":"application/vnd.rim.cod",".coffee":"text/coffeescript",".com":"application/x-msdownload",".conf":"text/plain",".cpio":"application/x-cpio",".cpl":"application/cpl+xml",".cpp":"text/x-c",".cpt":"application/mac-compactpro",".crd":"application/x-mscardfile",".crl":"application/pkix-crl",".crt":"application/x-x509-ca-cert",".crx":"application/x-chrome-extension",".cryptonote":"application/vnd.rig.cryptonote",".csh":"application/x-csh",".csl":"application/vnd.citationstyles.style+xml",".csml":"chemical/x-csml",".csp":"application/vnd.commonspace",".css":"text/css",".cst":"application/x-director",".csv":"text/csv",".cu":"application/cu-seeme",".curl":"text/vnd.curl",".cww":"application/prs.cww",".cxt":"application/x-director",".cxx":"text/x-c",".dae":"model/vnd.collada+xml",".daf":"application/vnd.mobius.daf",".dart":"application/vnd.dart",".dataless":"application/vnd.fdsn.seed",".davmount":"application/davmount+xml",".dbf":"application/vnd.dbf",".dbk":"application/docbook+xml",".dcr":"application/x-director",".dcurl":"text/vnd.curl.dcurl",".dd2":"application/vnd.oma.dd2+xml",".ddd":"application/vnd.fujixerox.ddd",".ddf":"application/vnd.syncml.dmddf+xml",".dds":"image/vnd.ms-dds",".def":"text/plain",".deploy":"application/octet-stream",".der":"application/x-x509-ca-cert",".dfac":"application/vnd.dreamfactory",".dgc":"application/x-dgc-compressed",".dic":"text/x-c",".dir":"application/x-director",".dis":"application/vnd.mobius.dis",".disposition-notification":"message/disposition-notification",".dist":"application/octet-stream",".distz":"application/octet-stream",".djv":"image/vnd.djvu",".djvu":"image/vnd.djvu",".dll":"application/octet-stream",".dmg":"application/x-apple-diskimage",".dmp":"application/vnd.tcpdump.pcap",".dms":"application/octet-stream",".dna":"application/vnd.dna",".doc":"application/msword",".docm":"application/vnd.ms-word.document.macroenabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":"application/msword",".dotm":"application/vnd.ms-word.template.macroenabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dp":"application/vnd.osgi.dp",".dpg":"application/vnd.dpgraph",".dra":"audio/vnd.dra",".drle":"image/dicom-rle",".dsc":"text/prs.lines.tag",".dssc":"application/dssc+der",".dtb":"application/x-dtbook+xml",".dtd":"application/xml-dtd",".dts":"audio/vnd.dts",".dtshd":"audio/vnd.dts.hd",".dump":"application/octet-stream",".dvb":"video/vnd.dvb.file",".dvi":"application/x-dvi",".dwd":"application/atsc-dwd+xml",".dwf":"model/vnd.dwf",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dxf",".dxp":"application/vnd.spotfire.dxp",".dxr":"application/x-director",".ear":"application/java-archive",".ecelp4800":"audio/vnd.nuera.ecelp4800",".ecelp7470":"audio/vnd.nuera.ecelp7470",".ecelp9600":"audio/vnd.nuera.ecelp9600",".ecma":"application/ecmascript",".edm":"application/vnd.novadigm.edm",".edx":"application/vnd.novadigm.edx",".efif":"application/vnd.picsel",".ei6":"application/vnd.pg.osasli",".elc":"application/octet-stream",".eml":"message/rfc822",".emma":"application/emma+xml",".emotionml":"application/emotionml+xml",".emz":"application/x-msmetafile",".eol":"audio/vnd.digital-winds",".eot":"application/vnd.ms-fontobject",".eps":"application/postscript",".epub":"application/epub+zip",".es":"application/ecmascript",".es3":"application/vnd.eszigno3+xml",".esa":"application/vnd.osgi.subsystem",".esf":"application/vnd.epson.esf",".et3":"application/vnd.eszigno3+xml",".etx":"text/x-setext",".eva":"application/x-eva",".evy":"application/x-envoy",".exe":"application/octet-stream",".exi":"application/exi",".exp":"application/express",".exr":"image/aces",".ext":"application/vnd.novadigm.ext",".ez":"application/andrew-inset",".ez2":"application/vnd.ezpix-album",".ez3":"application/vnd.ezpix-package",".f":"text/x-fortran",".f4v":"video/x-f4v",".f77":"text/x-fortran",".f90":"text/x-fortran",".fbs":"image/vnd.fastbidsheet",".fcdt":"application/vnd.adobe.formscentral.fcdt",".fcs":"application/vnd.isac.fcs",".fdf":"application/vnd.fdf",".fdt":"application/fdt+xml",".fe_launch":"application/vnd.denovo.fcselayout-link",".fg5":"application/vnd.fujitsu.oasysgp",".fgd":"application/x-director",".fh":"image/x-freehand",".fh4":"image/x-freehand",".fh5":"image/x-freehand",".fh7":"image/x-freehand",".fhc":"image/x-freehand",".fig":"application/x-xfig",".fits":"image/fits",".flac":"audio/x-flac",".fli":"video/x-fli",".flo":"application/vnd.micrografx.flo",".flv":"video/x-flv",".flw":"application/vnd.kde.kivio",".flx":"text/vnd.fmi.flexstor",".fly":"text/vnd.fly",".fm":"application/vnd.framemaker",".fnc":"application/vnd.frogans.fnc",".fo":"application/vnd.software602.filler.form+xml",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".frame":"application/vnd.framemaker",".fsc":"application/vnd.fsc.weblaunch",".fst":"image/vnd.fst",".ftc":"application/vnd.fluxtime.clip",".fti":"application/vnd.anser-web-funds-transfer-initiation",".fvt":"video/vnd.fvt",".fxp":"application/vnd.adobe.fxp",".fxpl":"application/vnd.adobe.fxp",".fzs":"application/vnd.fuzzysheet",".g2w":"application/vnd.geoplan",".g3":"image/g3fax",".g3w":"application/vnd.geospace",".gac":"application/vnd.groove-account",".gam":"application/x-tads",".gbr":"application/rpki-ghostbusters",".gca":"application/x-gca-compressed",".gdl":"model/vnd.gdl",".gdoc":"application/vnd.google-apps.document",".ged":"text/vnd.familysearch.gedcom",".geo":"application/vnd.dynageo",".geojson":"application/geo+json",".gex":"application/vnd.geometry-explorer",".ggb":"application/vnd.geogebra.file",".ggt":"application/vnd.geogebra.tool",".ghf":"application/vnd.groove-help",".gif":"image/gif",".gim":"application/vnd.groove-identity-message",".glb":"model/gltf-binary",".gltf":"model/gltf+json",".gml":"application/gml+xml",".gmx":"application/vnd.gmx",".gnumeric":"application/x-gnumeric",".gph":"application/vnd.flographit",".gpx":"application/gpx+xml",".gqf":"application/vnd.grafeq",".gqs":"application/vnd.grafeq",".gram":"application/srgs",".gramps":"application/x-gramps-xml",".gre":"application/vnd.geometry-explorer",".grv":"application/vnd.groove-injector",".grxml":"application/srgs+xml",".gsf":"application/x-font-ghostscript",".gsheet":"application/vnd.google-apps.spreadsheet",".gslides":"application/vnd.google-apps.presentation",".gtar":"application/x-gtar",".gtm":"application/vnd.groove-tool-message",".gtw":"model/vnd.gtw",".gv":"text/vnd.graphviz",".gxf":"application/gxf",".gxt":"application/vnd.geonext",".gz":"application/gzip",".h":"text/x-c",".h261":"video/h261",".h263":"video/h263",".h264":"video/h264",".hal":"application/vnd.hal+xml",".hbci":"application/vnd.hbci",".hbs":"text/x-handlebars-template",".hdd":"application/x-virtualbox-hdd",".hdf":"application/x-hdf",".heic":"image/heic",".heics":"image/heic-sequence",".heif":"image/heif",".heifs":"image/heif-sequence",".hej2":"image/hej2k",".held":"application/atsc-held+xml",".hh":"text/x-c",".hjson":"application/hjson",".hlp":"application/winhlp",".hpgl":"application/vnd.hp-hpgl",".hpid":"application/vnd.hp-hpid",".hps":"application/vnd.hp-hps",".hqx":"application/mac-binhex40",".hsj2":"image/hsj2",".htc":"text/x-component",".htke":"application/vnd.kenameaapp",".htm":"text/html",".html":"text/html",".hvd":"application/vnd.yamaha.hv-dic",".hvp":"application/vnd.yamaha.hv-voice",".hvs":"application/vnd.yamaha.hv-script",".i2g":"application/vnd.intergeo",".icc":"application/vnd.iccprofile",".ice":"x-conference/x-cooltalk",".icm":"application/vnd.iccprofile",".ics":"text/calendar",".ief":"image/ief",".ifb":"text/calendar",".ifm":"application/vnd.shana.informed.formdata",".iges":"model/iges",".igl":"application/vnd.igloader",".igm":"application/vnd.insors.igm",".igs":"model/iges",".igx":"application/vnd.micrografx.igx",".iif":"application/vnd.shana.informed.interchange",".img":"application/octet-stream",".imp":"application/vnd.accpac.simply.imp",".ims":"application/vnd.ms-ims",".in":"text/plain",".ini":"text/plain",".ink":"application/inkml+xml",".inkml":"application/inkml+xml",".install":"application/x-install-instructions",".iota":"application/vnd.astraea-software.iota",".ipfix":"application/ipfix",".ipk":"application/vnd.shana.informed.package",".irm":"application/vnd.ibm.rights-management",".irp":"application/vnd.irepository.package+xml",".itp":"application/vnd.shana.informed.formtemplate",".its":"application/its+xml",".ivp":"application/vnd.immervision-ivp",".ivu":"application/vnd.immervision-ivu",".jad":"text/vnd.sun.j2me.app-descriptor",".jade":"text/jade",".jam":"application/vnd.jam",".jar":"application/java-archive",".jardiff":"application/x-java-archive-diff",".java":"text/x-java-source",".jhc":"image/jphc",".jisp":"application/vnd.jisp",".jls":"image/jls",".jlt":"application/vnd.hp-jlyt",".jng":"image/x-jng",".jnlp":"application/x-java-jnlp-file",".joda":"application/vnd.joost.joda-archive",".jp2":"image/jp2",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpf":"image/jpx",".jpg":"image/jpeg",".jpg2":"image/jp2",".jpgm":"video/jpm",".jpgv":"video/jpeg",".jph":"image/jph",".jpx":"image/jpx",".js":"application/javascript",".json":"application/json",".json5":"application/json5",".jsonld":"application/ld+json",".jsonml":"application/jsonml+json",".jsx":"text/jsx",".jxr":"image/jxr",".jxra":"image/jxra",".jxrs":"image/jxrs",".jxs":"image/jxs",".jxsc":"image/jxsc",".jxsi":"image/jxsi",".jxss":"image/jxss",".kar":"audio/midi",".karbon":"application/vnd.kde.karbon",".kdbx":"application/x-keepass2",".kfo":"application/vnd.kde.kformula",".kia":"application/vnd.kidspiration",".kml":"application/vnd.google-earth.kml+xml",".kmz":"application/vnd.google-earth.kmz",".kne":"application/vnd.kinar",".knp":"application/vnd.kinar",".kon":"application/vnd.kde.kontour",".kpr":"application/vnd.kde.kpresenter",".kpt":"application/vnd.kde.kpresenter",".kpxx":"application/vnd.ds-keypoint",".ksp":"application/vnd.kde.kspread",".ktr":"application/vnd.kahootz",".ktx":"image/ktx",".ktx2":"image/ktx2",".ktz":"application/vnd.kahootz",".kwd":"application/vnd.kde.kword",".kwt":"application/vnd.kde.kword",".lasxml":"application/vnd.las.las+xml",".latex":"application/x-latex",".lbd":"application/vnd.llamagraphics.life-balance.desktop",".lbe":"application/vnd.llamagraphics.life-balance.exchange+xml",".les":"application/vnd.hhe.lesson-player",".less":"text/less",".lgr":"application/lgr+xml",".lha":"application/x-lzh-compressed",".link66":"application/vnd.route66.link66+xml",".list":"text/plain",".list3820":"application/vnd.ibm.modcap",".listafp":"application/vnd.ibm.modcap",".litcoffee":"text/coffeescript",".lnk":"application/x-ms-shortcut",".log":"text/plain",".lostxml":"application/lost+xml",".lrf":"application/octet-stream",".lrm":"application/vnd.ms-lrm",".ltf":"application/vnd.frogans.ltf",".lua":"text/x-lua",".luac":"application/x-lua-bytecode",".lvp":"audio/vnd.lucent.voice",".lwp":"application/vnd.lotus-wordpro",".lzh":"application/x-lzh-compressed",".m13":"application/x-msmediaview",".m14":"application/x-msmediaview",".m1v":"video/mpeg",".m21":"application/mp21",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",".m3u":"audio/x-mpegurl",".m3u8":"application/vnd.apple.mpegurl",".m4p":"application/mp4",".m4s":"video/iso.segment",".m4u":"video/vnd.mpegurl",".m4v":"video/x-m4v",".ma":"application/mathematica",".mads":"application/mads+xml",".maei":"application/mmt-aei+xml",".mag":"application/vnd.ecowin.chart",".maker":"application/vnd.framemaker",".man":"text/troff",".manifest":"text/cache-manifest",".map":"application/json",".mar":"application/octet-stream",".markdown":"text/markdown",".mathml":"application/mathml+xml",".mb":"application/mathematica",".mbk":"application/vnd.mobius.mbk",".mbox":"application/mbox",".mc1":"application/vnd.medcalcdata",".mcd":"application/vnd.mcd",".mcurl":"text/vnd.curl.mcurl",".md":"text/markdown",".mdb":"application/x-msaccess",".mdi":"image/vnd.ms-modi",".mdx":"text/mdx",".me":"text/troff",".mesh":"model/mesh",".meta4":"application/metalink4+xml",".metalink":"application/metalink+xml",".mets":"application/mets+xml",".mfm":"application/vnd.mfmp",".mft":"application/rpki-manifest",".mgp":"application/vnd.osgeo.mapguide.package",".mgz":"application/vnd.proteus.magazine",".mid":"audio/midi",".midi":"audio/midi",".mie":"application/x-mie",".mif":"application/vnd.mif",".mime":"message/rfc822",".mj2":"video/mj2",".mjp2":"video/mj2",".mjs":"application/module+javascript",".mk3d":"video/x-matroska",".mka":"audio/x-matroska",".mkd":"text/x-markdown",".mks":"video/x-matroska",".mkv":"video/x-matroska",".mlp":"application/vnd.dolby.mlp",".mmd":"application/vnd.chipnuts.karaoke-mmd",".mmf":"application/vnd.smaf",".mml":"text/mathml",".mmr":"image/vnd.fujixerox.edmics-mmr",".mng":"video/x-mng",".mny":"application/x-msmoney",".mobi":"application/x-mobipocket-ebook",".mods":"application/mods+xml",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp21":"application/mp21",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4s":"application/mp4",".mp4v":"video/mp4",".mpc":"application/vnd.mophun.certificate",".mpd":"application/dash+xml",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpf":"application/media-policy-dataset+xml",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".mpkg":"application/vnd.apple.installer+xml",".mpm":"application/vnd.blueice.multipass",".mpn":"application/vnd.mophun.application",".mpt":"application/vnd.ms-project",".mpy":"application/vnd.ibm.minipay",".mqy":"application/vnd.mobius.mqy",".mrc":"application/marc",".mrcx":"application/marcxml+xml",".ms":"text/troff",".mscml":"application/mediaservercontrol+xml",".mseed":"application/vnd.fdsn.mseed",".mseq":"application/vnd.mseq",".msf":"application/vnd.epson.msf",".msg":"application/vnd.ms-outlook",".msh":"model/mesh",".msi":"application/octet-stream",".msl":"application/vnd.mobius.msl",".msm":"application/octet-stream",".msp":"application/octet-stream",".msty":"application/vnd.muvee.style",".mtl":"model/mtl",".mts":"model/vnd.mts",".mus":"application/vnd.musician",".musd":"application/mmt-usd+xml",".musicxml":"application/vnd.recordare.musicxml+xml",".mvb":"application/x-msmediaview",".mvt":"application/vnd.mapbox-vector-tile",".mwf":"application/vnd.mfer",".mxf":"application/mxf",".mxl":"application/vnd.recordare.musicxml",".mxmf":"audio/mobile-xmf",".mxml":"application/xv+xml",".mxs":"application/vnd.triscape.mxs",".mxu":"video/vnd.mpegurl",".n-gage":"application/vnd.nokia.n-gage.symbian.install",".n3":"text/n3",".nb":"application/mathematica",".nbp":"application/vnd.wolfram.player",".nc":"application/x-netcdf",".ncx":"application/x-dtbncx+xml",".nfo":"text/x-nfo",".ngdat":"application/vnd.nokia.n-gage.data",".nitf":"application/vnd.nitf",".nlu":"application/vnd.neurolanguage.nlu",".nml":"application/vnd.enliven",".nnd":"application/vnd.noblenet-directory",".nns":"application/vnd.noblenet-sealer",".nnw":"application/vnd.noblenet-web",".npx":"image/vnd.net-fpx",".nq":"application/n-quads",".nsc":"application/x-conference",".nsf":"application/vnd.lotus-notes",".nt":"application/n-triples",".ntf":"application/vnd.nitf",".nzb":"application/x-nzb",".oa2":"application/vnd.fujitsu.oasys2",".oa3":"application/vnd.fujitsu.oasys3",".oas":"application/vnd.fujitsu.oasys",".obd":"application/x-msbinder",".obgx":"application/vnd.openblox.game+xml",".oda":"application/oda",".odb":"application/vnd.oasis.opendocument.database",".odc":"application/vnd.oasis.opendocument.chart",".odf":"application/vnd.oasis.opendocument.formula",".odft":"application/vnd.oasis.opendocument.formula-template",".odg":"application/vnd.oasis.opendocument.graphics",".odi":"application/vnd.oasis.opendocument.image",".odm":"application/vnd.oasis.opendocument.text-master",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogex":"model/vnd.opengex",".ogg":"audio/ogg",".ogv":"video/ogg",".ogx":"application/ogg",".omdoc":"application/omdoc+xml",".onepkg":"application/onenote",".onetmp":"application/onenote",".onetoc":"application/onenote",".onetoc2":"application/onenote",".opf":"application/oebps-package+xml",".opml":"text/x-opml",".oprc":"application/vnd.palm",".opus":"audio/ogg",".osf":"application/vnd.yamaha.openscoreformat",".osfpvg":"application/vnd.yamaha.openscoreformat.osfpvg+xml",".osm":"application/vnd.openstreetmap.data+xml",".otc":"application/vnd.oasis.opendocument.chart-template",".otf":"font/otf",".otg":"application/vnd.oasis.opendocument.graphics-template",".oth":"application/vnd.oasis.opendocument.text-web",".oti":"application/vnd.oasis.opendocument.image-template",".otp":"application/vnd.oasis.opendocument.presentation-template",".ots":"application/vnd.oasis.opendocument.spreadsheet-template",".ott":"application/vnd.oasis.opendocument.text-template",".ova":"application/x-virtualbox-ova",".ovf":"application/x-virtualbox-ovf",".owl":"application/rdf+xml",".oxps":"application/oxps",".oxt":"application/vnd.openofficeorg.extension",".p":"text/x-pascal",".p10":"application/pkcs10",".p12":"application/x-pkcs12",".p7b":"application/x-pkcs7-certificates",".p7c":"application/pkcs7-mime",".p7m":"application/pkcs7-mime",".p7r":"application/x-pkcs7-certreqresp",".p7s":"application/pkcs7-signature",".p8":"application/pkcs8",".pac":"application/x-ns-proxy-autoconfig",".pas":"text/x-pascal",".paw":"application/vnd.pawaafile",".pbd":"application/vnd.powerbuilder6",".pbm":"image/x-portable-bitmap",".pcap":"application/vnd.tcpdump.pcap",".pcf":"application/x-font-pcf",".pcl":"application/vnd.hp-pcl",".pclxl":"application/vnd.hp-pclxl",".pct":"image/x-pict",".pcurl":"application/vnd.curl.pcurl",".pde":"text/x-processing",".pdf":"application/pdf",".pem":"application/x-x509-ca-cert",".pfa":"application/x-font-type1",".pfb":"application/x-font-type1",".pfm":"application/x-font-type1",".pfr":"application/font-tdpfr",".pfx":"application/x-pkcs12",".pgm":"image/x-portable-graymap",".pgn":"application/x-chess-pgn",".pgp":"application/pgp-encrypted",".php":"application/x-httpd-php",".pic":"image/x-pict",".pkg":"application/octet-stream",".pki":"application/pkixcmp",".pkipath":"application/pkix-pkipath",".pkpass":"application/vnd.apple.pkpass",".pl":"application/x-perl",".plb":"application/vnd.3gpp.pic-bw-large",".plc":"application/vnd.mobius.plc",".plf":"application/vnd.pocketlearn",".pls":"application/pls+xml",".pm":"application/x-perl",".pml":"application/vnd.ctc-posml",".png":"image/png",".pnm":"image/x-portable-anymap",".portpkg":"application/vnd.macports.portpkg",".pot":"application/vnd.ms-powerpoint",".potm":"application/vnd.ms-powerpoint.template.macroenabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppam":"application/vnd.ms-powerpoint.addin.macroenabled.12",".ppd":"application/vnd.cups-ppd",".ppm":"image/x-portable-pixmap",".pps":"application/vnd.ms-powerpoint",".ppsm":"application/vnd.ms-powerpoint.slideshow.macroenabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":"application/vnd.ms-powerpoint",".pptm":"application/vnd.ms-powerpoint.presentation.macroenabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".pqa":"application/vnd.palm",".pre":"application/vnd.lotus-freelance",".prf":"application/pics-rules",".provx":"application/provenance+xml",".ps":"application/postscript",".psb":"application/vnd.3gpp.pic-bw-small",".psd":"image/vnd.adobe.photoshop",".psf":"application/x-font-linux-psf",".pskcxml":"application/pskc+xml",".pti":"image/prs.pti",".ptid":"application/vnd.pvi.ptid1",".pub":"application/x-mspublisher",".pvb":"application/vnd.3gpp.pic-bw-var",".pwn":"application/vnd.3m.post-it-notes",".pya":"audio/vnd.ms-playready.media.pya",".pyv":"video/vnd.ms-playready.media.pyv",".qam":"application/vnd.epson.quickanime",".qbo":"application/vnd.intu.qbo",".qfx":"application/vnd.intu.qfx",".qps":"application/vnd.publishare-delta-tree",".qt":"video/quicktime",".qwd":"application/vnd.quark.quarkxpress",".qwt":"application/vnd.quark.quarkxpress",".qxb":"application/vnd.quark.quarkxpress",".qxd":"application/vnd.quark.quarkxpress",".qxl":"application/vnd.quark.quarkxpress",".qxt":"application/vnd.quark.quarkxpress",".ram":"audio/x-pn-realaudio",".raml":"application/raml+yaml",".rapd":"application/route-apd+xml",".ras":"image/x-cmu-raster",".rcprofile":"application/vnd.ipunplugged.rcprofile",".rdf":"application/rdf+xml",".rdz":"application/vnd.data-vision.rdz",".relo":"application/p2p-overlay+xml",".rep":"application/vnd.businessobjects",".res":"application/x-dtbresource+xml",".rgb":"image/x-rgb",".rif":"application/reginfo+xml",".rip":"audio/vnd.rip",".ris":"application/x-research-info-systems",".rl":"application/resource-lists+xml",".rlc":"image/vnd.fujixerox.edmics-rlc",".rld":"application/resource-lists-diff+xml",".rm":"application/vnd.rn-realmedia",".rmi":"audio/midi",".rmp":"audio/x-pn-realaudio-plugin",".rms":"application/vnd.jcp.javame.midlet-rms",".rmvb":"application/vnd.rn-realmedia-vbr",".rnc":"application/relax-ng-compact-syntax",".rng":"application/xml",".roa":"application/rpki-roa",".roff":"text/troff",".rp9":"application/vnd.cloanto.rp9",".rpm":"application/x-redhat-package-manager",".rpss":"application/vnd.nokia.radio-presets",".rpst":"application/vnd.nokia.radio-preset",".rq":"application/sparql-query",".rs":"application/rls-services+xml",".rsat":"application/atsc-rsat+xml",".rsd":"application/rsd+xml",".rsheet":"application/urc-ressheet+xml",".rss":"application/rss+xml",".rtx":"text/richtext",".run":"application/x-makeself",".rusd":"application/route-usd+xml",".s":"text/x-asm",".s3m":"audio/s3m",".saf":"application/vnd.yamaha.smaf-audio",".sass":"text/x-sass",".sbml":"application/sbml+xml",".sc":"application/vnd.ibm.secure-container",".scd":"application/x-msschedule",".scm":"application/vnd.lotus-screencam",".scq":"application/scvp-cv-request",".scs":"application/scvp-cv-response",".scss":"text/x-scss",".scurl":"text/vnd.curl.scurl",".sda":"application/vnd.stardivision.draw",".sdc":"application/vnd.stardivision.calc",".sdd":"application/vnd.stardivision.impress",".sdkd":"application/vnd.solent.sdkm+xml",".sdkm":"application/vnd.solent.sdkm+xml",".sdp":"application/sdp",".sdw":"application/vnd.stardivision.writer",".sea":"application/x-sea",".see":"application/vnd.seemail",".seed":"application/vnd.fdsn.seed",".sema":"application/vnd.sema",".semd":"application/vnd.semd",".semf":"application/vnd.semf",".senmlx":"application/senml+xml",".sensmlx":"application/sensml+xml",".ser":"application/java-serialized-object",".setpay":"application/set-payment-initiation",".setreg":"application/set-registration-initiation",".sfd-hdstx":"application/vnd.hydrostatix.sof-data",".sfs":"application/vnd.spotfire.sfs",".sfv":"text/x-sfv",".sgi":"image/sgi",".sgl":"application/vnd.stardivision.writer-global",".sgm":"text/sgml",".sgml":"text/sgml",".sh":"application/x-sh",".shar":"application/x-shar",".shex":"text/shex",".shf":"application/shf+xml",".shtml":"text/html",".sid":"image/x-mrsid-image",".sieve":"application/sieve",".sig":"application/pgp-signature",".sil":"audio/silk",".silo":"model/mesh",".sis":"application/vnd.symbian.install",".sisx":"application/vnd.symbian.install",".sit":"application/x-stuffit",".sitx":"application/x-stuffitx",".siv":"application/sieve",".skd":"application/vnd.koan",".skm":"application/vnd.koan",".skp":"application/vnd.koan",".skt":"application/vnd.koan",".sldm":"application/vnd.ms-powerpoint.slide.macroenabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".slim":"text/slim",".slm":"text/slim",".sls":"application/route-s-tsid+xml",".slt":"application/vnd.epson.salt",".sm":"application/vnd.stepmania.stepchart",".smf":"application/vnd.stardivision.math",".smi":"application/smil+xml",".smil":"application/smil+xml",".smv":"video/x-smv",".smzip":"application/vnd.stepmania.package",".snd":"audio/basic",".snf":"application/x-font-snf",".so":"application/octet-stream",".spc":"application/x-pkcs7-certificates",".spdx":"text/spdx",".spf":"application/vnd.yamaha.smaf-phrase",".spl":"application/x-futuresplash",".spot":"text/vnd.in3d.spot",".spp":"application/scvp-vp-response",".spq":"application/scvp-vp-request",".spx":"audio/ogg",".sq3":"application/vnd.sqlite3",".sql":"application/x-sql",".sqlite3":"application/vnd.sqlite3",".src":"application/x-wais-source",".srt":"application/x-subrip",".sru":"application/sru+xml",".srx":"application/sparql-results+xml",".ssdl":"application/ssdl+xml",".sse":"application/vnd.kodak-descriptor",".ssf":"application/vnd.epson.ssf",".ssml":"application/ssml+xml",".st":"application/vnd.sailingtracker.track",".stc":"application/vnd.sun.xml.calc.template",".std":"application/vnd.sun.xml.draw.template",".stf":"application/vnd.wt.stf",".sti":"application/vnd.sun.xml.impress.template",".stk":"application/hyperstudio",".stpx":"model/step+xml",".stpxz":"model/step-xml+zip",".stpz":"model/step+zip",".str":"application/vnd.pg.format",".stw":"application/vnd.sun.xml.writer.template",".styl":"text/stylus",".stylus":"text/stylus",".sus":"application/vnd.sus-calendar",".susp":"application/vnd.sus-calendar",".sv4cpio":"application/x-sv4cpio",".sv4crc":"application/x-sv4crc",".svc":"application/vnd.dvb.service",".svd":"application/vnd.svd",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swa":"application/x-director",".swf":"application/x-shockwave-flash",".swi":"application/vnd.aristanetworks.swi",".swidtag":"application/swid+xml",".sxc":"application/vnd.sun.xml.calc",".sxd":"application/vnd.sun.xml.draw",".sxg":"application/vnd.sun.xml.writer.global",".sxi":"application/vnd.sun.xml.impress",".sxm":"application/vnd.sun.xml.math",".sxw":"application/vnd.sun.xml.writer",".t":"text/troff",".t3":"application/x-t3vm-image",".t38":"image/t38",".taglet":"application/vnd.mynfc",".tao":"application/vnd.tao.intent-module-archive",".tap":"image/vnd.tencent.tap",".tar":"application/x-tar",".tcap":"application/vnd.3gpp2.tcap",".tcl":"application/x-tcl",".td":"application/urc-targetdesc+xml",".teacher":"application/vnd.smart.teacher",".tei":"application/tei+xml",".teicorpus":"application/tei+xml",".tex":"application/x-tex",".texi":"application/x-texinfo",".texinfo":"application/x-texinfo",".text":"text/plain",".tfi":"application/thraud+xml",".tfm":"application/x-tex-tfm",".tfx":"image/tiff-fx",".tga":"image/x-tga",".thmx":"application/vnd.ms-officetheme",".tif":"image/tiff",".tiff":"image/tiff",".tk":"application/x-tcl",".tmo":"application/vnd.tmobile-livetv",".toml":"application/toml",".torrent":"application/x-bittorrent",".tpl":"application/vnd.groove-tool-template",".tpt":"application/vnd.trid.tpt",".tr":"text/troff",".tra":"application/vnd.trueapp",".trig":"application/trig",".trm":"application/x-msterminal",".ts":"video/mp2t",".tsd":"application/timestamped-data",".tsv":"text/tab-separated-values",".ttc":"font/collection",".ttf":"font/ttf",".ttl":"text/turtle",".ttml":"application/ttml+xml",".twd":"application/vnd.simtech-mindmapper",".twds":"application/vnd.simtech-mindmapper",".txd":"application/vnd.genomatix.tuxedo",".txf":"application/vnd.mobius.txf",".txt":"text/plain",".u32":"application/x-authorware-bin",".u8dsn":"message/global-delivery-status",".u8hdr":"message/global-headers",".u8mdn":"message/global-disposition-notification",".u8msg":"message/global",".ubj":"application/ubjson",".udeb":"application/x-debian-package",".ufd":"application/vnd.ufdl",".ufdl":"application/vnd.ufdl",".ulx":"application/x-glulx",".umj":"application/vnd.umajin",".unityweb":"application/vnd.unity",".uoml":"application/vnd.uoml+xml",".uri":"text/uri-list",".uris":"text/uri-list",".urls":"text/uri-list",".usdz":"model/vnd.usdz+zip",".ustar":"application/x-ustar",".utz":"application/vnd.uiq.theme",".uu":"text/x-uuencode",".uva":"audio/vnd.dece.audio",".uvd":"application/vnd.dece.data",".uvf":"application/vnd.dece.data",".uvg":"image/vnd.dece.graphic",".uvh":"video/vnd.dece.hd",".uvi":"image/vnd.dece.graphic",".uvm":"video/vnd.dece.mobile",".uvp":"video/vnd.dece.pd",".uvs":"video/vnd.dece.sd",".uvt":"application/vnd.dece.ttml+xml",".uvu":"video/vnd.uvvu.mp4",".uvv":"video/vnd.dece.video",".uvva":"audio/vnd.dece.audio",".uvvd":"application/vnd.dece.data",".uvvf":"application/vnd.dece.data",".uvvg":"image/vnd.dece.graphic",".uvvh":"video/vnd.dece.hd",".uvvi":"image/vnd.dece.graphic",".uvvm":"video/vnd.dece.mobile",".uvvp":"video/vnd.dece.pd",".uvvs":"video/vnd.dece.sd",".uvvt":"application/vnd.dece.ttml+xml",".uvvu":"video/vnd.uvvu.mp4",".uvvv":"video/vnd.dece.video",".uvvx":"application/vnd.dece.unspecified",".uvvz":"application/vnd.dece.zip",".uvx":"application/vnd.dece.unspecified",".uvz":"application/vnd.dece.zip",".vbox":"application/x-virtualbox-vbox",".vbox-extpack":"application/x-virtualbox-vbox-extpack",".vcard":"text/vcard",".vcd":"application/x-cdlink",".vcf":"text/x-vcard",".vcg":"application/vnd.groove-vcard",".vcs":"text/x-vcalendar",".vcx":"application/vnd.vcx",".vdi":"application/x-virtualbox-vdi",".vds":"model/vnd.sap.vds",".vhd":"application/x-virtualbox-vhd",".vis":"application/vnd.visionary",".viv":"video/vnd.vivo",".vmdk":"application/x-virtualbox-vmdk",".vob":"video/x-ms-vob",".vor":"application/vnd.stardivision.writer",".vox":"application/x-authorware-bin",".vrml":"model/vrml",".vsd":"application/vnd.visio",".vsf":"application/vnd.vsf",".vss":"application/vnd.visio",".vst":"application/vnd.visio",".vsw":"application/vnd.visio",".vtf":"image/vnd.valve.source.texture",".vtt":"text/vtt",".vtu":"model/vnd.vtu",".vxml":"application/voicexml+xml",".w3d":"application/x-director",".wad":"application/x-doom",".wadl":"application/vnd.sun.wadl+xml",".war":"application/java-archive",".wasm":"application/wasm",".wax":"audio/x-ms-wax",".wbmp":"image/vnd.wap.wbmp",".wbs":"application/vnd.criticaltools.wbs+xml",".wbxml":"application/vnd.wap.wbxml",".wcm":"application/vnd.ms-works",".wdb":"application/vnd.ms-works",".wdp":"image/vnd.ms-photo",".weba":"audio/webm",".webapp":"application/x-web-app-manifest+json",".webm":"video/webm",".webmanifest":"application/manifest+json",".webp":"image/webp",".wg":"application/vnd.pmi.widget",".wgt":"application/widget",".wif":"application/watcherinfo+xml",".wks":"application/vnd.ms-works",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmd":"application/x-ms-wmd",".wml":"text/vnd.wap.wml",".wmlc":"application/vnd.wap.wmlc",".wmls":"text/vnd.wap.wmlscript",".wmlsc":"application/vnd.wap.wmlscriptc",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".woff":"font/woff",".woff2":"font/woff2",".wpd":"application/vnd.wordperfect",".wpl":"application/vnd.ms-wpl",".wps":"application/vnd.ms-works",".wqd":"application/vnd.wqd",".wri":"application/x-mswrite",".wrl":"model/vrml",".wsc":"message/vnd.wfa.wsc",".wsdl":"application/wsdl+xml",".wspolicy":"application/wspolicy+xml",".wtb":"application/vnd.webturbo",".wvx":"video/x-ms-wvx",".x_b":"model/vnd.parasolid.transmit.binary",".x_t":"model/vnd.parasolid.transmit.text",".x32":"application/x-authorware-bin",".x3d":"model/x3d+xml",".x3dbz":"model/x3d+binary",".x3dvz":"model/x3d+vrml",".x3dz":"model/x3d+xml",".xaml":"application/xaml+xml",".xap":"application/x-silverlight-app",".xar":"application/vnd.xara",".xav":"application/xcap-att+xml",".xbap":"application/x-ms-xbap",".xbd":"application/vnd.fujixerox.docuworks.binder",".xbm":"image/x-xbitmap",".xca":"application/xcap-caps+xml",".xcs":"application/calendar+xml",".xdf":"application/xcap-diff+xml",".xdm":"application/vnd.syncml.dm+xml",".xdp":"application/vnd.adobe.xdp+xml",".xdssc":"application/dssc+xml",".xdw":"application/vnd.fujixerox.docuworks",".xel":"application/xcap-el+xml",".xenc":"application/xenc+xml",".xer":"application/patch-ops-error+xml",".xfdf":"application/vnd.adobe.xfdf",".xfdl":"application/vnd.xfdl",".xht":"application/xhtml+xml",".xhtml":"application/xhtml+xml",".xhvml":"application/xv+xml",".xif":"image/vnd.xiff",".xla":"application/vnd.ms-excel",".xlam":"application/vnd.ms-excel.addin.macroenabled.12",".xlc":"application/vnd.ms-excel",".xlm":"application/vnd.ms-excel",".xls":"application/vnd.ms-excel",".xlsb":"application/vnd.ms-excel.sheet.binary.macroenabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroenabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":"application/vnd.ms-excel",".xltm":"application/vnd.ms-excel.template.macroenabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlw":"application/vnd.ms-excel",".xm":"audio/xm",".xml":"text/xml",".xns":"application/xcap-ns+xml",".xo":"application/vnd.olpc-sugar",".xop":"application/xop+xml",".xpi":"application/x-xpinstall",".xpl":"application/xproc+xml",".xpm":"image/x-xpixmap",".xpr":"application/vnd.is-xpr",".xps":"application/vnd.ms-xpsdocument",".xpw":"application/vnd.intercon.formnet",".xpx":"application/vnd.intercon.formnet",".xsd":"application/xml",".xslt":"application/xslt+xml",".xsm":"application/vnd.syncml+xml",".xspf":"application/xspf+xml",".xul":"application/vnd.mozilla.xul+xml",".xvm":"application/xv+xml",".xvml":"application/xv+xml",".xwd":"image/x-xwindowdump",".xyz":"chemical/x-xyz",".xz":"application/x-xz",".yaml":"text/yaml",".yang":"application/yang",".yin":"application/yin+xml",".yml":"text/yaml",".ymp":"text/x-suse-ymp",".z1":"application/x-zmachine",".z2":"application/x-zmachine",".z3":"application/x-zmachine",".z4":"application/x-zmachine",".z5":"application/x-zmachine",".z6":"application/x-zmachine",".z7":"application/x-zmachine",".z8":"application/x-zmachine",".zaz":"application/vnd.zzazz.deck+xml",".zip":"application/zip",".zir":"application/vnd.zul",".zirz":"application/vnd.zul",".zmm":"application/vnd.handheld-entertainment+xml"};class sr{#o;#s;data;constructor(e,t,r){let n;const i=e instanceof sr?e.name:`${e}`;if(void 0===t)n=e instanceof sr?Array.from(e.data,r):[];else if(Array.isArray(t))n=void 0===r?t:t.map(r);else if("number"==typeof t)n=0===t?[]:void 0!==r&&"function"!=typeof r?Array.from({length:t},(()=>r)):Array.from({length:t},r);else{if("function"!=typeof t?.[Symbol.iterator])throw new TypeError("Unknown rowCountOrData arg");n=Array.from(t,r)}this.#o=i,this.data=n}get name(){return this.#o}get isIntegerName(){return this.#s}setAt(e,t,r){!function(e,t,r){for(let n=e.length;n<t;++n)e[n]=r}(this.data,e-1,r),this.data[e]=t}push(e){this.data.push(e)}}function lr(e,t){const r=new Map;for(let n=0;n<e.length;++n)for(const[i,o]of Object.entries(e[n]))r.has(i)||r.set(i,new sr(i)),r.get(i).setAt(n,o,t);return Array.from(r.values())}const pr=/\s*(?:"([^"]*?)"\s*|([^,]*))/g;function cr(e,t=e=>e){const r=[];for(pr.lastIndex=0;;){const n=pr.exec(e);if(!n)throw new Error("parse failure");const i=void 0!==n[1]?t(n[1],!0):t(n[2].trim(),!1);if(r.push(i),pr.lastIndex===e.length)return r;if(","!=e[pr.lastIndex])throw new Error("parse failure");pr.lastIndex++}}const ur=e=>!e.length;const dr=new N;function fr(){return dr.getStore()}function mr(e,t){return dr.run(e,t)}let hr=null;function gr(e){return`'${e.replaceAll("'","''")}'`}function yr(e,t,r){const n=new e(":memory:"),i=gr(r),o=t.map((e=>gr(e.name)));n.exec("BEGIN TRANSACTION"),n.exec(`CREATE TABLE ${i} ( ${o.map((e=>`${e} TEXT`)).join(",")} )`);const a=n.prepare(`INSERT INTO ${i} VALUES ( ${t.map((e=>"?")).join(",")} ) `),s=Math.min(...t.map((e=>e.data.length)));for(let e=0;e<s;++e){const r=t.map((t=>t.data[e]));a.run(...r)}return n.exec("COMMIT TRANSACTION"),n}async function vr(e,t){if(!hr)try{hr=(await import("node:sqlite")).DatabaseSync}catch(e){throw console.debug("import `node:sqlite` failed: ",e),new Error("database utilities need a version of node with the `node:sqlite` module (>=23.4)")}if("application/vnd.sqlite3"===e.type){const t=e.fullPath,r=new hr(t);return fr().registerCleanup((()=>{try{r.close()}catch(e){"ERR_INVALID_STATE"===e.code?(console.assert("database is not open"===e.message,"unexpected error %s",JSON.stringify(e.message)),console.warn("WARNING: database closed before cleanup: %s",t)):console.warn("WARNING: closing database %s threw",t,e.message)}})),r}if("application/json"===e.type){const r=e.toJSON();if(!Array.isArray(r))throw new TypeError("JSON database must be an array");const n=lr(r);return yr(hr,n,t)}if("text/csv"===e.type)return yr(hr,function(e){const t=e.split(/\s*$\s*/m).filter((e=>!ur(e)));t.at(-1)===String.fromCharCode(0)&&t.pop();const r=cr(t[0]).map((e=>new sr(e)));for(let e=1;e<t.length;++e){const n=cr(t[e],void 0),i=n.length;if(i<r.length)throw new TypeError(`too few columns in row ${e}`);for(let t=0;t<r.length;++t)r[t].data[e-1]=n[t];for(let t=r.length;t<i;++t)if(!ur(n[t]))throw new TypeError(`too many columns in row ${e}`)}for(let e=r.length-1;e>=0&&""===r[e].name&&r[e].data.every(ur);e--)r.pop();return r}(e.toText()),t);throw new TypeError(`Cannot turn file (${e.type}) into database`)}class wr{#l;#p;#c;#u;#d;#o;#f;#m;#e;#h;#g;#y="";[re]="Buffer";constructor(e,t=".",i,o,a){"string"!=typeof t&&(t=t.fullPath),this.#m=r(t,e),this.#f=e;const{ext:s,name:l,base:p,dir:c,root:u}=n(this.#m);this.#d=s,this.#o=l,this.#c=c,this.#p=u,this.#u=p,void 0!==i&&(this.#g=i),this.#y=o??function(e){return e=e.toLowerCase(),Object.hasOwn(ar,e)?ar[e]:""}(this.#d),this.#l=a}static fromString(e,{cwd:t,stat:r,mimetype:n}){return new wr(e,t,r,n)}static#v(e){void 0===e.#g&&(e.#g=m(e.#m,{throwIfNoEntry:!1})??null)}getContentAsBuffer(){if(this.#h)return this.#h;if(this.#l)return this.#h=this.#l();const e=void 0===this.#g?m(this.#m,{throwIfNoEntry:!1}):this.#g;this.#h=h(this.#m);const t=m(this.#m,{throwIfNoEntry:!1});if(e.size!==t?.size||e.mtimeMS!==t?.mtimeNS)throw new Error(`File changed while we were reading it, for ${JSON.stringify(this.#f)}`);return void 0===this.#g&&(this.#g=e),this.#h}get type(){return this.#y}get size(){return this.#h?this.#h.byteLength:(wr.#v(this),this.#g?.size??NaN)}get name(){return this.#u}get webkitRelativePath(){return this.#f}get lastModified(){return wr.#v(this),this.#g?.mtimeMs??NaN}get ext(){return this.#d}get extlessName(){return this.#o}get dir(){return this.#c}get fullPath(){return this.#m}static#w(e){return wr.#v(e),z(e.#g)}get isFile(){return wr.#w(this)===M}get isDir(){return wr.#w(this)===C}get isDirectory(){return wr.#w(this)===C}get filesystem(){throw new TypeError("Not implemented")}toFilename(){return this.#f}toURL(){return d(this.#m)}toBuffer(){return this.getContentAsBuffer()}async buffer(){return this.getContentAsBuffer()}toArrayBuffer(){const e=this.getContentAsBuffer();return 0!==e.byteOffset||e.length!==e.buffer.byteLength?e.buffer.slice(e.byteOffset,e.byteOffset+e.length):e.buffer}async arrayBuffer(){return this.toArrayBuffer()}toText(){return void 0!==this.#e?this.#e:this.#e=this.getContentAsBuffer().toString("utf8")}async text(){return this.toText()}async blob(){return new O([this.getContentAsBuffer()],{type:this.type})}file(){return new or([this.getContentAsBuffer()],this.name,{type:this.type})}toJSON(){return JSON.parse(this.toText())}async json(){return JSON.parse(await this.text())}formData(){throw new TypeError("Method formData not impelemented")}async database(e="data"){return vr(this,e)}*toLines(){let e=0;const t=this.toText();for(;;){const r=t.indexOf("\n",e);if(-1===r)break;const n=r&&13===t.charCodeAt(r-1)?r-1:r;yield t.slice(e,n),e=r+1}e<t.length&&(yield t.slice(e,t.length))}async*lines(){yield*this.toLines()}setValueAsBufferVector(e){this.#h=void 0,this.#e=void 0,this.#g=void 0,function(e,t){const r=y(e,"w");let n=!0,i=!1;try{v(r,t)}catch(e){console.error(e),n=!1}try{w(r)}catch(e){n&&(n=!1,console.error(e))}if(!n){try{b(e),i=!0}catch(e){console.error(e)}throw new Error(i?"failed to write file":"failed to write file - it's probably corrupt")}}(this.#m,e)}setValueAsBuffer(e){this.#h=void 0,this.#e=void 0,this.#g=void 0,g(this.#m,e)}async fetchContentAsResponse(){const{type:e,lastModified:t}=this;return new Response(this.getContentAsBuffer(),{status:200,statusText:"OK",headers:new Headers([["Last-Modified",new Date(t).toGMTString()],...e?[["Content-Type",e]]:[]])})}slice(){throw new TypeError("Method slice not implemented")}stream(){throw new TypeError("Method stream not implemented")}}class br{#b;#f;#m;#g;[re];constructor(e,t=".",n=null){t instanceof br&&(t=t.fullPath),this.#m=r(t,e),this.#f=e,this.#b=i(e),this.#g=n||_(this.#m);const o=z(n);if(o!==C&&o!==P)throw new TypeError(`${JSON.stringify(e)} is not a directory`)}static fromString(e,{cwd:t}){return new br(e,t)}static fromFullPath(e){return new br(e)}get size(){return NaN}get type(){return""}get name(){return this.#b}get webkitRelativePath(){return this.#f}get fullPath(){return this.#m}get lastModified(){return this._stat(),this.#g?.mtimeMs??NaN}get isFile(){return z(this._stat())===M}get isDir(){return z(this._stat())===C}get isDirectory(){return z(this._stat())===C}get filesystem(){throw new TypeError("Not implemented")}get exists(){return z(this._stat())!==P}getFile(e){return new wr(e,this)}getDir(e){return new br(e,this)}glob(e="*",t={}){return _r(e,{dirs:!0,files:!0,...t,cwd:this.#m})}_stat(){return void 0!==this.#g?this.#g:this.#g=m(this.#f,{throwIfNoEntry:!1})??null}toFilename(){return this.#f}toDirname(){return this.#f}toURL(){return d(this.#f)}toString(){return this.#f}}function xr(e){return-1!==e.indexOf("*")}function Er(e,t,i,o){if(""===e)throw new TypeError('Invalid filespec`""');if(xr(e)){const{dir:o,base:a}=n(e);let s;if(xr(o)){const e=n(o);if(xr(e.dir)||"**"!==e.base)throw new TypeError("Unsupported glob");if(!1===i)throw new TypeError("Cannot use a recursive glob with --no-recurse");i=!0,s=r(t,e.dir)||t}else i=!!i,s=r(t,o)||t;if(z(s)!==C)throw new TypeError(`${JSON.stringify(s)} is not a directory`);return{globDir:s,globs:[a],recurse:i,filespec:""}}{let n=z(e=r(t,e));return n===P?null:void 0!==i&&!i||n!==C?{globDir:"",globs:null,recurse:!1,filespec:e}:{globDir:e,globs:Array.isArray(o)?o:[o],recurse:!0,filespec:""}}}function Tr(e){return e.replaceAll(/[.+?|^$\[\](){}\\]/g,(e=>"\\"+e)).replaceAll("*",".*?")}function kr(e){if(-1!==e.indexOf("**"))throw new TypeError("Cannot convert a recursive glob to a RegExp");const t=function(e,t,r="",n="",i=""){return Array.isArray(e)?n+e.map(t).join(r)+i:t(e,0)}(e,Tr,"|","(?:",")");return new RegExp(`^${t}$`)}const Sr=Symbol.for("js-hell.private"),Ar="",Or="iterator",Nr="array";class jr{#x;#E;#T=0;constructor(e){this.#x=e,this.#E=Ar}next(){let e=this.#E;if(e===Ar){const t=Lr(this.#x);if(t===Ar)e=Or,qr(this.#x);else{if(t!==Nr)throw t===Or?new TypeError("Multiple iterators over content"):new TypeError("Unknown #state");e=Nr}this.#E=e}if(e===Nr){const e=Dr(this.#x);return index<e.length?{value:e[index++],done:!1}:{value:void 0,done:!0}}if(e===Or)return Rr(this.#x).next();throw new TypeError("Unknown state")}[Symbol.iterator](){return this}}class Ir{#E=Ar;#k;#S;#A=0;get[re](){return"Array"}constructor(e){this.#k=e}toArray(){if(this.#E===Ar)$r(this);else if(this.#E!==Nr)throw new TypeError("Cannot convert to an array");return this.#S}[Symbol.iterator](){return new jr(this)}get length(){return this.toArray().length}at(e){return this.toArray().at(e)}slice(e,t){return this.toArray().slice(e,t)}values(){return this[Symbol.iterator]()}map(e){return new Ir(function*(e,t){for(const r of e)yield t(r)}(this[Symbol.iterator](),e))}static toSequenceState(e){return e.#E}static toUnderlyingArray(e){if(e.#E!==Nr)throw new TypeError("Not an array");return e.#S}static toUnderlyingIterator(e){if(e.#E!==Or)throw new TypeError("Not an iterator");return e.#k}static collapseToIterator(e){if(e.#E!==Ar)throw new TypeError("Not in a superposition");e.#E=Or}static collapseToArray(e){if(e.#E!==Ar)throw new TypeError("Not in a superposition");e.#S=Array.from(e.#k),e.#k=null,e.#E=Nr}}const{toSequenceState:Lr,collapseToArray:$r,collapseToIterator:qr,toUnderlyingIterator:Rr,toUnderlyingArray:Dr}=Ir;function*Ur(t=[],{extensions:n,exclude:i,cwd:l,recurse:p,dirs:c=!1,files:u=!0}={}){const d="string"==typeof l?l:l.fullPath,f=[];for(const e of t)if(e instanceof wr||e instanceof br)yield e;else{if("string"!=typeof e)throw new TypeError("Filespec must be a string or a File");f.push(e)}const m=function(e,t){return Array.isArray(e)?e.map(t):t(e,0)}(n,(e=>`*${e}`));for(const t of function*(e,{recurse:t,cwd:n=".",glob:i="*",exclude:l="",return:{dirs:p=!1}={}}={}){n=`${n}`;const c=Array.isArray(e)?e:[e];let u=[];const d=new Map;for(const e of c){const a=Er(e,n,t,i);if(!a)continue;if(!a.globs){u.push(o(n,r(n,a.filespec)));continue}const s=a.globDir;if(d.has(s)){const e=d.get(s);if(e.recurse!==a.recurse)throw new TypeError("Confused recurse params");e.globs.push(...a.globs)}else d.set(s,{globs:a.globs,recurse:a.recurse})}u.length&&(yield*u);for(const[e,{recurse:t,globs:r}]of d.entries()){const i=kr(r),c=l?kr(l):i.source.startsWith("^\\.")?null:kr(".*"),u=[{dir:e,recurse:t}];for(let e=0;e<u.length;++e){const{dir:t,recurse:r}=u[e];r&&p&&e&&(yield o(n,t)+a);for(const e of x(t,{withFileTypes:!0})){if(c&&c.test(e.name))continue;const l=s(t,e.name);e.isDirectory()?!0===r?u.push({dir:l,recurse:r}):p&&(yield o(n,l)+a):i.test(e.name)&&(yield o(n,l))}}}}(f,{recurse:p,glob:m,exclude:i,cwd:d,return:{dirs:c,files:u}}))yield t.endsWith(e.sep)?new br(t.slice(0,-1),l):new wr(t,l)}function _r(e,t){return new Ir(Ur(e,t))}delete Ir.toSequenceState,delete Ir.collapseToIterator,delete Ir.collapseToArray,delete Ir.toUnderlyingIterator,delete Ir.toUnderlyingArray;class Cr{#O;#a;constructor(e){const t=Number(e),r=Number.isSafeInteger(t);this.#a=r?t:BigInt(e),this.#O=r}static fromString(e){return new Cr(e)}toSafeInteger(){if(!this.#O)throw new TypeError("Integer is too big to be safely encoded as a number");return this.#a}toNumber(){return Number(this.#a)}toBigInt(){return BigInt(this.#a)}toString(){return this.#a.toString()}get[re](){return"SafeInteger"}get[ie](){return this.#O?"number":"bigint"}[ne](){return this.#a}}const Mr=Symbol.for("js-hell.realiseTo");class Pr{#e;constructor(e){this.#e=`${e}`}static fromString(e){return new Pr(e)}toString(){return this.#e}toRegExp(){return kr(this.#e)}static[Mr]="String"}class zr{#N;[re]="URL";constructor(e){this.#N=e}toURL(){return this.#N}async toBuffer(){return Buffer.from(await(await fetch(this.#N)).arrayBuffer())}}class Br{acceptsFileTopic;constructor({name:e,aliases:t,super:r,subname:n,fromString:i,is:o,writeable:a=!1,literal:s=!1,enum:l=!1,variant:p=!1,acceptsFileTopic:c=!1,realiseStdioAs:u,realiseFileAs:d,createListFromStringsAndInstances:f,updateSubtype:m,updateVariant:h,casts:g={},...y}){if(Object.assign(this,{name:e,aliases:t,super:r,subname:n,fromString:i,is:o,literal:s,enum:l,writeable:a,realiseStdioAs:u,realiseFileAs:d,variant:p,acceptsFileTopic:c,createListFromStringsAndInstances:f,updateSubtype:m,updateVariant:h,casts:g}),0!==Object.entries(y).length)throw new TypeError("Illegal keys in type registration")}}const Fr=[new Br({name:"Str",aliases:["String","Text","Name"],fromString:e=>e,is:()=>!0}),new Br({name:"Int",aliases:"Integer",fromString:e=>Cr.fromString(e),is:e=>/^[-+]?\d+$/.test(e)}),new Br({name:"Count",aliases:void 0,fromString:e=>Cr.fromString(e),is:e=>/^\d+$/.test(e)}),new Br({name:"Date",aliases:void 0,fromString(e){const t=Date.parse(e);if(!Number.isFinite(t))throw new TypeError("Invalid date");return new Date(t)},casts:{Date_fromNumber:e=>new Date(e),Date_toMillisecondsSinceEpoch:e=>+e,Date_toNumber:e=>+e}}),new Br({name:"File",fromString:(e,{cwd:t="."}={})=>new wr(e,t),is:e=>!0,realiseStdioAs:"Stream",writeable:!0,acceptsFileTopic:!0,createListFromStringsAndInstances(e,t){return _r(e,{extensions:this.extensions??"",...t})},updateSubtype(e,t){e.extensions=`.${t.toLowerCase()}`},updateVariant(e,t){e.extensions=t.map((e=>e.extensions)).filter((e=>""!==e))}}),new Br({name:"(Dir|File)",aliases:void 0,acceptsFileTopic:!0,fromString(e,{cwd:t="."}={}){const r=z(e);if(r===M)return new wr(e,{cwd:t});if(r===C)return new br(e);if(r===P)throw new TypeError(`${JSON.stringify(e)} must exist`);throw new TypeError(`${JSON.stringify(e)} is a special file`)},createListFromStringsAndInstances:(e,t)=>_r(e,{...t,extensions:"",dirs:!0,files:!0}),variant:!0}),new Br({name:"Dir",fromString:(e,{cwd:t="."})=>new br(e,t)}),new Br({name:"DirName",aliases:"Dirname",fromString(e,{cwd:t="."}){const r=new br(e,t);return r[re]="Filename",r.toFilename()}}),new Br({name:"FileName",aliases:"Filename",fromString(e,{cwd:t="."}={}){const r=new wr(e,t);return r[re]="Filename",r}}),new Br({name:"Url",fromString(e,{cwd:t}){let r;void 0!==t&&(r=d(`${t}`)+"/url_algorithm_deletes_this");return new URL(e,r)},casts:{ULR_toBuffer:async e=>Buffer.from(await(await fetch(e)).arrayBuffer()),URL_toResponse:async e=>fetch(e),URL_toArrayBuffer:async e=>(await fetch(e)).arrayBuffer(),URL_toText:async e=>(await fetch(e)).text(),URL_toJson:async e=>(await fetch(e)).json()}}),new Br({name:"(File|Url)",acceptsFileTopic:!0,fromString(e,{cwd:t="."}={}){const r=/(?<=^[a-zA-Z]{2,}):/.test(e)?new zr(e):wr.fromString(e,{cwd:t});return r[re]="Buffer",r},createListFromStringsAndInstances(e,t){throw new Type("Lists of url|file not implemented.")},variant:!0}),new Br({name:"Json",fromString(e){try{return JSON.parse(e)}catch(t){throw console.log(e),t}},is(e){const t=e.trim();return!!/^[\[{"'0-9-]/.test(t)||("true"===t||"false"===t||"null"===t)},acceptsFileTopic:!0,realiseFileAs:"JSON"}),new Br({name:"(File|Json)",fromString(e,{cwd:t="."}){if(!e.startsWith("{")&&!e.startsWith("[")){const r=new wr(e,t);return r[re]="JSON",r}try{return JSON.parse(e)}catch(t){throw console.log(e),t}},is:e=>!0,acceptsFileTopic:!0,realiseFileAs:"JSON"}),new Br({name:"Scriptlet",fromString:(e,{cwd:t="."}={})=>Cl(e,{cwd:t.toString()}),is:e=>!0,writeable:!1}),...Object.entries({Glob:Pr}).map((([e,t])=>new Br({name:e,fromString:t.fromString,writeable:"function"==typeof t.prototype.setValueAsBuffer})))],Vr=new Map(Fr.map((e=>[e.name,e]))),Jr=function(){const e={};for(const t of Vr.values())if(void 0!==t.casts)for(const[r,n]of Object.entries(t.casts))e[r]=n;return e}();!function(){const e=[];for(const t of Vr.values()){t.aliases?Array.isArray(t.aliases)||(t.aliases=[t.aliases]):t.aliases=[];for(const r of t.aliases)e.push([r,t])}for(const[t,r]of e)Vr.set(t,r)}();var Wr=Object.freeze({__proto__:null,TypeRegistration:Br,casts:Jr,default:Vr,list:function(){const e=[];for(const{name:t,aliases:r=[]}of Fr)e.push([t,...r].join(" "));return e}});const Gr=Vr;function Hr(e){const t=e.charCodeAt(0);return t>=65&&t<=91}function Kr(e){const t=e;if(Vr.has(t))return Vr.get(t);const r=t.slice(1).search(/[A-Z]/)+1;if(r){const e=t.slice(r),n=function(e,t,r){if(!Vr.has(r))throw new TypeError(`No such supertype ${JSON.stringify(r)} for type ${JSON.stringify(e)}`);const n=Vr.get(r),i=Object.create(n);return i.super=n,i.subname=t,i.name=e,"function"==typeof n.updateSubtype&&n.updateSubtype(i,t),i}(t,t.slice(0,r),e);return Vr.set(t,n),n}throw new TypeError(`Unknown type ${t}`)}function Xr(e,t=""){if("true"===e||"false"===e)return e;if(Array.isArray(e))return new Br({name:(r=t,""===r||Hr(r)?r:r.slice(0,1).toUpperCase()+r.slice(1)),is:t=>e.includes(t),fromString:e=>e,enum:!0});var r;if("string"!=typeof e)throw new TypeError(`Not a type name ${JSON.stringify(e)}`);if(!Hr(e))throw new TypeError(`Invalid type name ${JSON.stringify(e)}`);return Kr(e)}function Zr(e,t="literal"){return new nr(e,t)}function Yr(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;++n){const r=e.charCodeAt(0)-t.charCodeAt(0);if(r)return r}return e.length-t.length}function Qr(e){if(!(e.length>1))throw new TypeError("Not a typename list");if(!e.every((e=>"string"==typeof e)))throw new TypeError(`Not type names ${JSON.stringify(t)}`);if(!e.every((e=>Hr(e))))throw new TypeError(`Invalid type names ${JSON.stringify(t)}`);e.sort(Yr);const r=`(${e.join("|")})`;if(Gr.has(r))return Gr.get(r);const n=e.map((e=>Kr(e))),i="object"==typeof n[0].super&&n[0].super?n[0].super:n[0];for(let e=1;e<n.length;++e){if(i!==("object"==typeof n[e].super&&n[e].super?n[e].super:n[e]))throw new Error("Invalid discriminated union (all types must have the same supertype")}const o=Object.create(i);return o.variant=!0,"function"==typeof i.updateVariant&&i.updateVariant(o,n),o}function en(e,t,r,n,i=!0){const o=e(t);if("start"===o)return i?t.padEnd(r,n):t;if("end"===o)return t.padStart(r,n);if("none"===o)return t;throw new TypeError("Callback returned unknown alignment")}const tn=/^[-+]?(?:\d+(?:\.\d+)?|\.\d+)%?$/;function rn(e){return tn.test(e)?"end":"start"}function nn(e,{collapseWhitespace:t,escapeSeparator:r,separator:n,quotedSeparator:i}){let o=`${e}`;return t&&(o=o.trim().replaceAll(/\s+/g," ")),r&&(o=o.replaceAll(n,i)),o}function on(e,{escapeSeparator:t=!0,separator:r="|",leading:n=!0,trailing:i=!1,padding:o=" ",collapseWhitespace:a=!0,eol:s="\n",ubhead:l=!1,columnHeadings:p=!0}={}){const c=`\\${r}`,u=[];let d=0;for(let n=0;n<e.length;++n){const{name:s,data:p,align:f="auto",padding:m=o,maxWidth:h=0}=e[n],g=nn(s,{collapseWhitespace:a,escapeSeparator:t,separator:r,quotedSeparator:c});let y=g.length;const v=l?[g]:[g,""];for(const e of p){let n=nn(e,{collapseWhitespace:a,escapeSeparator:t,separator:r,quotedSeparator:c});n.length>y&&(y=n.length),v.push(n)}l||(v[1]="-".repeat(i||n<e.length-1?y:v[0].length)),h>0&&y>h&&(y=h);const w=n<e.length-1||i?r:"",b=n<e.length-1||i;console.log("column",n,b);const x="function"==typeof f?(e,t,r)=>en(f,e,t,r):"auto"===f?(e,t,r)=>en(rn,e,t,r,b):"end"!==f?b?(e,t,r)=>e.padEnd(t,"."):e=>e:(e,t,r)=>e.padStart(t,r);for(let e=0;e<v.length;++e)v[e]=x(v[e],y,m)+w;if(l){const t=v[0];let r=`<u>${t.slice(0,t.length-w.length)}</u>`;0===n?r="<b>"+r:n===e.length-1&&(r+="</b>"),v[0]=r+w}const E=v.length;u.push(v),E>d&&(d=E)}let f="";const m=n?r:"";for(let e=p?0:2;e<d;++e){f+=m;for(let t=0;t<u.length;++t)f+=u[t][e]??" ".repeat(u[t][0].length);f+=s}return f}function an(e,{eol:t}={}){const r=[];for(const t of e)r.push(JSON.stringify(t.name));let n=r.join(",")+t;for(let i=0;i<e[0].data.length;++i){r.length=0;for(const{data:t}of e)r.push(JSON.stringify(t[i]));n+=r.join(",")+t}return n}const sn="Str",ln="Utf8",pn=Symbol("toString"),cn="JSON",un="Object",dn="Lines",fn="Bytes",mn="Enum",hn="Table",gn="Columns",yn="nb-psv",vn="csv",{toString:wn}=Object.getPrototypeOf({});function bn(e){if("string"==typeof e)return sn;if(Buffer.isBuffer(e))return"Buffer";if("object"==typeof e){if(e instanceof ArrayBuffer)return"ArrayBuffer";if(e instanceof Uint8Array)return fn;if(e.buffer instanceof ArrayBuffer)return"ArrayBuferView"}if(Array.isArray(e)){if(e.every((e=>"string"==typeof e)))return dn;if(e.every((e=>Number.isInteger(e)&&e>=0&&e<=255)))return fn}return"object"==typeof e&&e?"function"==typeof e.toJSON?cn:"string"==typeof e[Symbol.toStringTag]?e[Symbol.toStringTag]:Array.isArray(e)||e.toString===wn?un:pn:cn}function xn(e,t){return e===hn&&t===un||(e===un&&(t===cn||t===fn||t===dn)||(e===cn&&(t===un||t===fn||t===dn)||(t===fn&&"Uint8Array"===e||(t!==ln&&t!==pn||(t=sn),e===t))))}const En=new Map([["json",4],["json(4)",4],["json<4>",4],["JSON",4],["json0",0],["JSON0",0],["JSON<0>",0],["JSON(0)",0]]);function Tn({format:e}){return!En.has(e)}const kn="";function Sn(e,t,r,n,i="uf8"){const o=function(e,t,r){switch(t){case pn:case ln:case sn:return`${e}`;case dn:return Array.isArray(e)?e.join(r):e;case un:return I(e);case mn:return`{${e.join(", ")}}`;case hn:if(!Array.isArray(e))throw new TypeError("Must be a table, probably");return on(lr(e),{leading:!1,separator:kn,trailing:!1,padding:kn,eol:r,collapseWhitespace:!1,escapeSeparator:!1});case gn:if(!Array.isArray(e))throw new TypeError("Must be a table, probably");return JSON.stringify(Object.fromEntries(lr(e).map((e=>[e.name,e.data]))));case"table-ub":if(!Array.isArray(e))throw new TypeError("Must be a table, probably");return on(lr(e),{leading:!1,separator:kn,trailing:!1,padding:kn,eol:r,collapseWhitespace:!1,escapeSeparator:!1,ubhead:!0});case"psv":if(!Array.isArray(e))throw new TypeError("Must be a table, probably");return on(lr(e));case yn:if(!Array.isArray(e))throw new TypeError("Must be a table, probably");return on(lr(e),{padding:""});case vn:return an(lr(e),{eol:r})}}(e,t,n);if("string"==typeof o)return Buffer.from(o+r,i);switch(t){case"Buffer":return e;case fn:return Buffer.from(e);case"ArrayBuffer":return Buffer.from(ArrayBuffer);case"Uint8Array":case"ArrayBufferView":return Buffer.from(e.buffer,e.byteOffset,e.byteLength)}if(En.has(t))return Buffer.from(JSON.stringify(e,void 0,En.get(t))+r,i);throw new TypeError(`Unknown format ${JSON.stringify(t)}`)}const An=new Set(["hex","base64","base64url"]);function On(e,t,{format:r,EOL:n,textEncoding:i="utf8"},o=!1){if(void 0===e)throw new TypeError("module didn't provide expected output");const a=o?"":n;if(An.has(r)){const o=Sn(e,t,a,n,i);return Buffer.from(o.toString(r),"ascii")}return Sn(e,r||t,a,n,i)}function Nn(e,t=80,r=""){const n=e.map((e=>"string"==typeof e?e:`${e}`)),i=Math.max(...n.map((e=>e.length)))+1,o=r.length,a=[],s=(Math.max(Math.trunc((t-o)/i),1)-1)*i+o;let l=r;for(const e of n)l+=e,l.length<=s?l+=" ".repeat(i-e.length):(a.push(l),l=" ".repeat(o));return 0!==l.length&&a.push(l),a}const jn="application/json",In="text/plain";function Ln({basetype:e="unknown",enum:t="unknown"}={},{format:r,mimetype:n},i){if("unknown"===t&&"function"!=typeof i&&(t=Array.isArray(i)?se:pe),(t===pe||t===se)&&En.has(r))return jn;if(void 0!==r){if(r===vn)return"text/csv";throw new TypeError("Unsupported format for pipe")}if(t===pe)switch(e){case"JSON":return jn;default:if("string"!=typeof i)break;case"string":case"String":case"Text":return"string"!=typeof n?In:n}}var $n=Object.freeze({__proto__:null,Buffer_fromScalarType:On,FORMAT_BYTES:fn,FORMAT_COLUMNS:gn,FORMAT_CSV:vn,FORMAT_CUSTOM_TO_STRING:pn,FORMAT_ENUMLIST:mn,FORMAT_JSON:cn,FORMAT_LINES:dn,FORMAT_NB_PSV:yn,FORMAT_OBJECT:un,FORMAT_PSV:"psv",FORMAT_TABLE:hn,MIME_JSON:jn,MIME_TEXT:In,formatRowsInColumns:Nn,fromObjectArray:lr,inferFormat:bn,isFormatCompatible:xn,mimetype:Ln,outputComponentsAndCat:Tn,toCSV:an,toMarkdown:on});const qn="vector",Rn="stream",Dn="buffer";function Un(e,t){return"Buffer"===e&&t===se?qn:t===le?Rn:Dn}function _n(e={}){let{basetype:t,enum:r}=e;const n=!!e;return n&&(t=function(e){if(!Vr.has(e))return e;const t=Vr.get(e);return t.super?t.super.name:t.name}(t),"DirName"!==t&&"FileName"!==t||(t="Str")),{typeAsserted:n,basetype:t,enumAs:r,method:Un(t,r)}}function Cn(e,t="",r=""){const n=bn(e);if("Lines"===n&&r!==pe)return t;if(!t)return n;if(n===pn)return pn;if(!xn(t,n))throw new TypeError(`Provided value appears to be ${JSON.stringify(n)} and not ${JSON.stringify(t)} as expected`);return t}function Mn(e,t,r,n,i){return"function"==typeof e.toBuffer_fromScalarType?e.toBuffer_fromScalarType(t,r,n,i):On(t,r,n,i)}class Pn{typeAsserted;basetype;enumAs;formatParams;method;constructor(e,t){const{typeAsserted:r,basetype:n,enumAs:i,method:o}=_n(e);Object.assign(this,{typeAsserted:r,basetype:n,enumAs:i,formatParams:t}),this.method=o}setReceiverValue(e,t){const{typeAsserted:r,basetype:n,enumAs:i,formatParams:o,method:a}=this;let s,l;if(a===qn){if("function"==typeof e.setValueAsBufferVector)return void e.setValueAsBufferVector(t)}else if(a===Rn){if("function"==typeof e.setValueAsBufferStream)return void e.setValueAsBufferStream(function*(e,t,r,n){for(const i of t){const t=Cn(i,r);yield Mn(e,i,t,n)}}(e,t,n,o));if(!rr(t))throw new TypeError("Not a generator");t=Array.from(t),s=Cn(t,n,se)}else{if(a!==Dn)throw new TypeError("Unknown method");if(void 0===t&&void 0===n)return;s=Cn(t,n,i),rr(t)&&(t=Array.from(t))}l=Array.isArray(t)&&(i===le||i===se)&&Tn(o)?Buffer.concat(t.map(((r,n)=>Mn(e,r,s,o,n==t.length-1)))):Mn(e,t,s,o,!0),e.setValueAsBuffer(l)}}class zn{receiver;#j;constructor(e,t,r){this.receiver=e,this.#j=new Pn(t,r)}getMethod(){return this.#j.method}setValue(e){this.#j.setReceiverValue(this.receiver,e)}}const Bn="range",Fn="property",Vn="method",Jn="global";class Wn{[re]="Error";#y;#I;#L;#$;constructor(e,t="",r="",n=function(e){return e===Vn}(e)){this.#y=e,this.#I=t,this.#L=r,this.#$=n}getType(){return this.#y}get isException(){return this.#$}convertToException(){this.#$=!0}getMessage(){return this.#y===Jn?`Missing parameter ${JSON.stringify(this.#I)}`:this.#y===Fn?this.#L?`No property ${JSON.stringify(this.#I)} in ${JSON.stringify(this.#L)}`:`No property ${JSON.stringify(this.#I)}`:this.#y===Vn?`No method ${this.#I}() on instance of ${this.#L}`:this.#y===Bn?"Index out of range":"unindex"===this.#y?"Not an indexable property":"cast"===this.#y?`Cannot cast from ${JSON.stringify(this.#L)} to ${JSON.stringify(this.#I)}`:"Not an object (JSON.stringify(this.#type)}"}toError(){return this.#y===Jn?ReferenceError(this.getMessage()):TypeError(this.getMessage())}toBoolean(){return!1}static fromMissingGlobal(e){return new Wn(Jn,e,"",!1)}static fromMissingProperty(e,t){return new Wn(Fn,e,t,!1)}static fromMissingMethod(e,t){return new Wn(Vn,e,t,!0)}static fromIndexOutOfRange(){return new Wn(Bn,"","",!1)}static fromUnindex(){return new Wn("unindex")}static fromMissingCast(e,t){return new Wn("cast",t,e)}}class Gn{#q;constructor(e){this.#q=e}get(){return this.#q}}function Hn(e){return e instanceof Gn?e.get():e}function Kn(e){return e instanceof Promise?new Gn(e):e}function Xn(e){return e.map((e=>Hn(e)))}function Zn(e,t){return e instanceof Promise?e.then(t):t(e)}const Yn="Boolean";function Qn(e,t){if(!function(e,t){return"object"==typeof e?null!==e&&t in e:void 0!==e&&t in Object(e)}(e,t))return!1;const r=e[Sr];return"object"!=typeof r||!r||!r.has(t)}function ei(e){const t={};for(let r=0;r+1<e.length;r+=2)t[e[r]]=e[r+1];return t}function ti(e,t){return Fe(e,["locals",Fe(e.locals,t)])}function ri(e){return"Error"===e?.[re]&&"function"==typeof e.toError}function ni(e){if("function"==typeof e)throw new TypeError("cannot realise a function");if("object"!=typeof e||!e)return!0;if(e instanceof Error)throw e;return!1}function ii(e,t){if("function"==typeof e&&e[re]===e)return e;if(ni(e))return e;const r=e.constructor,n=e[re]||r?.[re];if("string"==typeof n){if("Error"===n){if("function"==typeof e.toError)throw e.toError();throw new TypeError("Cannot realise as error")}const t=function(e,t){if(void 0===e)return t!==Yn&&Wn.fromMissingCast("cast","Undefined",cast);if(null===e||ri(e))return t!==Yn&&e;const r=e[`to${t}`];return"function"!=typeof r?Wn.fromMissingCast(e.constructor.name,t):Reflect.apply(r,e,[])}(e,n);if("String"===n&&"string"!=typeof t)throw new TypeError("Cast failed!");if(ni(t))return t;if(ri(t))return t;if(void 0===(t[re]||t.constructor[re]))return t;throw new TypeError("Realised result needs to be realised itself")}if("Integer"===r?.name)return e.toSafeInteger();if(tr(e))return function*(e){for(const t of e)yield ii(t)}(e);if(Array.isArray(e)){const t=e;for(let e=0;e<t.length;++e){const r=ii(t[e]);r!==t[e]&&(t[e]=r)}return t}{const t=e;for(const e in t){if(!Object.hasOwn(t,e))continue;const r=ii(t[e]);r!==t[e]&&(t[e]=r)}return t}}function oi(e,t){return ri(e)?e:ii(e)}function ai(e,t,r=""){if(void 0===t)throw new TypeError("Shouldn't be slicing with undefined");if(ri(e))return e.convertToException(),e;if(void 0===e||"object"==typeof e&&null===e)return Wn.fromUnindex();if(tr(e)){if(t===Symbol.iterator)return e;throw new TypeError("Probably not supported")}if("string"==typeof t){const n=t;return Qn(e,n)?Kn(e[n]):Wn.fromMissingProperty(n,r)}if("function"==typeof t)throw new TypeError("Cannot index with function");if("number"==typeof t)return function(e){return!!Array.isArray(e)||!("object"!=typeof e||!e||"number"!=typeof e.length||"function"!=typeof e.at)}(e)?t>=e.length||t<-e.length?Wn.fromIndexOutOfRange():Kn(e.at(t)):Wn.fromMissingProperty(t,r);if("object"==typeof t){if(!function(e){return!!Array.isArray(e)||!("object"!=typeof e||!e||"number"!=typeof e.length||"function"!=typeof e.slice)}(e))throw new TypeError("Not a sliceable type");if(void 0!==t.start){if(t.start<0||t.start>=e.length||t.end<0||t.end>=e.length||t.end<t.start)throw new TypeError("Subscript out of range")}else if(void 0!==t.end)throw new TypeError("Cannot have definite subscript with indefinite end");return e.slice(t.start,t.end)}throw"symbol"==typeof t?new TypeError("Symbol properties not supported"):new TypeError("Unsupported subscripts")}function si(e,t){const{globals:r,imports:n,locals:i}=t;console.assert(e.type===de||e.type===ge,"value invocation on node type %s",e.type);const{name:o}=e,a=e.type===de?e.scope:e.import?je:Ne;if(a!==Ne&&void 0!==e.defaultValue)throw new Error(U`Failed invariant: non-global binding ${e.name} has a default value`);if(a===Ie){if(Qn(i,o))return i[o];throw new Error(U`Binding ${e.name} flagged as LOCAL is not in the locals`)}if(a===je){if(n.has(o))return n.get(o);throw new Error(U`Binding ${e.name} flagged as an IMPORT is not in the imports`)}if(a!==Ne)throw new Error(U`Binding ${e.name} has unknown scope ${a}`);return r.has(o)?r.get(o):void 0!==e.defaultValue?gi(e.defaultValue,t):Wn.fromMissingGlobal(o)}const li={};function pi(e,t,r,n,i){const o=vi(n,i,!0);return Zn(e,(e=>Zn(r,(r=>Zn(o,(n=>function(e,t,r,n){try{return ri(n)?n:ri(r)?r:ri(e)?e:Kn(r===li?Reflect.construct(e,n):Reflect.apply(e,r,n))}catch(e){const r=new Error(`${t}() threw an exception`,{cause:e});throw r.name="ScriptletError",r}}(e,t,r,n)))))))}function ci(e,t){if("function"==typeof e){const r=e.name;return""!==r?`%${r}%.${t}(...)`:""}const r=function(e){if(tr(e))return"Iterator";const t=e?.constructor?.name;return"string"==typeof t?t:""}(e);return""!==r?`%${r}.prototype%.${t}(...)`:""}function ui(e,t,r){if(ri(e))return e.convertToException(),e;const n=function(e,t,r){if("string"==typeof t){if("object"==typeof r){const n=ci(e,t);if(""!==n&&r.has(n))return r.get(n)}}else if("symbol"!=typeof t)throw new TypeError("`methodName` must be a symbol or a string");return Qn(e,t)?e[t]:Wn.fromMissingMethod(t,e.constructor.name)}(e,t,r);if("function"!=typeof n)return Wn.fromMissingMethod(t,e.constructor.name);if(("function"==typeof e||e instanceof Function)&&n===Qn(Function.prototype,t))throw new TypeError("Cannot invoke function methods");return n}function di(e,t,r,n){const i=bi(t,ti(e,["%",r]));if(!0!==i){if(!1===i)throw new TypeError(`failed type assertion: expr is not type ${We(n)}`);return console.warn("warning: unchecked type assertion %s",We(n)),!1}return!0}function fi(e,t,r,n){return Zn(t,(t=>ri(t)?t:Zn(bi(r,e),(e=>ri(e)?e:n(t,e)))))}function mi(e,t){if("boolean"==typeof e)return!0;if(ri(e))return!1;throw new TypeError(`Condition to \`${t}\` must be a boolean.`)}function hi(e){return"object"==typeof e&&e?"function"!=typeof e[ne]?e:e[ne]():e}function gi(e,t){if(e.type===ve)return e.value;if(e.type===de)return si(e,t);if(e.type===we){const r=gi(e.object,t);if(e.op===Se){const t=function(e){if(e.type===we&&e.op===Se)return void 0!==e.property?e.property:e;throw new TypeError("Cannot get subscript")}(e);return Zn(r,(e=>ai(e,t,"")))}if(e.op===Ae)return Zn(r,(e=>Hn(e)));if(e.op===Oe)return Zn(r,(e=>{if(ri(e))return!1===e.isException?"undefined":e;if(null===e)return"null";const t=typeof e;return"object"!==t?t:"string"==typeof e[ie]?e[ie]:t}));if("!"===e.op)return Zn(r,(e=>mi(e,"!")?!e:e));throw new TypeError("Unknown unary operation")}if(e.type===ge){const r=si(e,t);if(ri(r))return r;if("function"!=typeof r)throw new TypeError("JSON.stringify( f ) is not callable");return pi(r,e.name,e.new?li:void 0,e.args,t)}if(e.type===ye){const r=e.name,n=bi(e.object,t);return pi(Zn(n,(e=>ui(e,r,t.globals))),r,e.new?li:n,e.args,t)}if(e.type===be){const r=gi(e.lhs,t);if(e.op===Ee)return Zn(r,(r=>ri(r)?gi(e.rhs,t):r));if("."===e.op){const n=r;if(ri(n))return n;const i=n,o=gi(e.rhs,t);return ri(o)?o:Zn(i,(e=>e[o]))}if(e.op===Te)return Zn(r,(r=>{if(ri(r))return r;if(e.exprType.enum===pe)return di(t,e.rhs,r,e.exprType),r;if(e.exprType.enum===se)return r.every((r=>di(t,e.rhs,r,e.exprType))),r;if(e.exprType.enum===le)return function*(e,t,r,n){for(const i of r){const o=di(e,t,i,n);if(yield i,!o){yield*r;break}}}(t,e.rhs,r,e.exprType);if(e.exprType.enum===ce)return async function*(e,t,r,n){for await(const i of r){const r=di(e,t,i,n);if(yield i,!r){yield*iterator;break}}}(t,e.rhs,r,e.exprType);throw new Error(U`Internal error (unknown enum type ${e.exprType.enum})`)}));if("|>"===e.op)return ri(r)?r:Zn(r,(r=>bi(e.rhs,ti(t,["%",r,"%"+e.pipeIndex,r]))));if(e.op===ke)return fi(t,r,e.rhs,((e,t)=>e instanceof t));if("==="===e.op)return fi(t,r,e.rhs,((e,t)=>hi(e)===hi(t)));if("!=="===e.op)return fi(t,r,e.rhs,((e,t)=>hi(e)!==hi(t)));if(","===e.op)return fi(t,r,e.rhs,((e,t)=>t));throw new TypeError("Unknown binary operation")}if(e.type===xe)return Zn(gi(e.condition,t),(r=>mi(r,"?:")?gi(r?e.true:e.false,t):r));if("->"===e.type)return Zn(gi(e.sourceValue,t),(r=>{const n=si(e.destIdentifier,t);return Zn(new zn(n,e.typeAssertion,{}).setValue(r),(e=>{}))}));throw new TypeError(`Unknown node type ${JSON.stringify(e.type)}`)}let yi=!1;function vi(e,t,r=!1){const n=[];let i=!1;yi||(yi=!0);for(const o of e){let e;if(o.type===fe)e=vi(o.value,t);else if(o.type===me)e=wi(o.value,t);else if(o.type===we&&"..."===o.op){const r=ii(gi(o.object,t),t.globals);if(!ri(r)){if(tr(r))n.push(...r);else{if("function"!=typeof r[Symbol.iterator])throw new TypeError("expected iterable for rest arg");{const e=r[Symbol.iterator]();n.push(...e)}}continue}e=r}else{if(o.type===he){if(!r)throw new Error("Callbacks are only allowed in argument lists");const{expr:e,freeVariableNames:i,async:a}=o,s=(...r)=>{const n=[ue,a];for(let e=0;e<i.length;++e)n.push(i[e],e<r.length?r[e]:void 0);const o=ti(t,n),s=bi(e,o);if(s instanceof Promise)return s.then((e=>ii(e,t.globals)));{const e=ii(s,t.globals);return a?Promise.resolve(e):e}};n.push(s);continue}{const r=gi(o,t);e=ri(r)?r:ii(r,t.globals)}}if(ri(e))return e;!i&&e instanceof Promise&&(i=!0),n.push(e)}return i?Promise.all(n).then((e=>Xn(e))):Xn(n)}function wi(e,t){const r=[];let n=!1;for(const[i,o]of e){let e;if(r.push(i),o.type===fe)e=vi(o.value,t);else if(o.type===me)e=wi(o.value,t);else{e=Zn(gi(o,t),(e=>oi(e,t.globals)))}if(ri(e))return e;!n&&e instanceof Promise&&(n=!0),r.push(e)}return n?Promise.all(r).then((e=>ei(Xn(e)))):ei(Xn(r))}function bi(e,t){return e.type===fe?vi(e.value,t):e.type===me?wi(e.value,t):gi(e,t)}function xi(e,t,r=void 0,n=!0,i){if(Array.isArray(e.args))throw new TypeError("Non-expression invocation no longer supported");if("object"!=typeof r&&void 0!==r)throw console.log(r),new TypeError("Expected object for formatterParams");const o=Fe(null,[ue,!0]),a={globals:t,imports:void 0===i?t:new Map(Object.entries(i)),locals:o},s=Zn(bi(e.args,a),(e=>oi(e)));return n?Zn(s,(e=>{if(!ri(e))return e;throw e.toError()})):s}function Ei(e,t){for(const r of e)if(!t(r))return!1;return!0}class Ti{#R;#D;#U;#_;#C;#M;globals;inlineOptions;get name(){return this.#D}get args(){return this.#R}get cast(){return this.#_}get void(){return this.#U||void 0!==(e=this.#_)&&Vt.includes(e.basetype);var e}get isWith(){return this.#M}get astNode(){return this.#R}get imports(){return this.#D}constructor({importReferences:e,globalReferences:t,imports:r,args:n,typeAssertion:i,inlineOptions:o,isVoid:a,nonWith:s=!1}){this.#R=n,this.#D=r,this.#_=i,this.#C=t,this.#U=a,this.#M=!s,this.globals=new Set(t.keys()),this.inlineOptions=o}static from(e,{expr:t=!1}={}){const r="string"==typeof e?new te(e):e;return new Ti(Zt(r,t?Wt:Ht))}static fromEmbeddedExpr(e){const t="string"==typeof e?new te(e):e;return new Ti(Zt(t,Gt))}static fromTemplateContents(e){const t="string"==typeof e?new te(e):e;return new Ti(Zt(t,Kt))}static fromTemplateTail(e){const t="string"==typeof e?new te(e):e;return new Ti(Zt(t,Xt))}exec(e,t,{throwError:r=!0,legacyBrk:n=!1}={}){return xi(this,e,void 0,r,t)}static#P(e,t){if(!e.#C.has(t))return null;const r=e.#C.get(t);if(1!==r.size)return null;const n=r.values().next().value;return void 0===n.defaultValue||n.defaultValue.type!==ve?null:n.defaultValue}hasDefault(e){return null!==Ti.#P(this,e)}getDefault(e){return Ti.#P(this,e)?.value}*globalsWithLiteralDefaults(){for(const[e,t]of this.#C.entries()){if(console.assert(0!==t.size,"expected non-zero references to global %s",e),!Ei(t.values(),(e=>void 0!==e.defaultValue&&e.defaultValue.type===ve)))continue;const r=t.values(),n=r.next().value.defaultValue.value;Ei(r,(e=>e.defaultValue.value===n))&&(yield[e,n])}}options(){}hasGlobal(e){return this.#C.has(e)}getGlobal(e){if(!this.#C.has(e))return null;const t=new ki;for(const r of this.#C.get(e))r.parent&&r.parent.type===ye?t.methods.add(r.parent.name):t.othersCount++;return t}remapGlobals(e,t){(function(e,t,r){if(!e.has(t)||t===r)return!1;const n=e.get(t);for(const e of n){if(e.type!==de)throw new TypeError("Illegal reference");if(e.name!==t)throw new TypeError("Mimsatched names");e.name=r}if(e.has(r)){const t=e.get(r);for(const e of n)t.add(e)}else e.set(r,n);return e.delete(t),!0})(this.#C,e,t)&&(this.globals=new Set(this.#C.keys()),this.inlineOptions=Jt(this.#C))}isLiteral(){return $e(this.#R)}toLiteralValue(){if(!$e(this.#R))throw new Error("Not a literal");return this.#R.value}}class ki{methods=new Set;othersCount=0}const Si="$n",Ai="=",Oi="--$",Ni=";",ji="${}",Ii="=${}",Li=new RegExp(`-${B.source}`,"y"),$i=/&&?|\|\|?|>>?|<<?|;|(?<=^|\s)\d>{1,2}/y,qi=/\$\{/y,Ri="",Di="=",Ui=!1,_i=!0,Ci="expr",Mi=Symbol("-");function Pi(e,t=false,r=!0){return e===Mi.description&&r?Mi:e}function zi(e,t,r,n,i=!1){return r===Ci?{type:e?Ii:ji,value:t,info:Ri}:{type:e?Ai:Si,value:Pi(t,r,n),info:r===_i?'"':Ri}}function Bi(e){if(e.startsWith('"')||e.startsWith("'"))return e.indexOf(e.charAt(0),1)===e.length-1}function Fi(e,t,r,n){if(r!==Ui)throw new Error("fromArgv options must always be unquoted");if(Bi(t))t=t.slice(1,-1),r=_i;else if(t.startsWith("${")&&t.endsWith("}"))n&&(t=t.slice(2,-1),r=Ci);else if(t.startsWith("`")&&t.endsWith("`")){const e=new te(t.slice(1)),n=Ti.fromTemplateTail(e);if(!e.atEof())throw e.error("expected argument end");n.isLiteral()?(t=n.toLiteralValue(),r=_i):r=Ci}return zi(e,t,r,n)}function*Vi(e){let t=!0;const r=new te(e,{autoTrim:!1,trimStart:!1});for(let e=!0;;){const n=r.trimStart();if(r.atEof())break;const i=r.match($i);if(i){yield{type:Ni,value:i,info:Ri},t=!0,e=!0;continue}if(!n&&!e)throw r.error("expected whitespace");e=!1;let o,a,s=Ui;if(t&&(a=r.match(Li))){if("--"===a){t=!1;continue}if(a===Mi.description){yield{type:o===Ai?Ai:Si,value:Mi,info:Ri};continue}{const e=r.match("=");if(yield{type:Oi,value:a,info:e?Di:Ri},!e)continue;o=Ai}}else o=Si;if(r.match(qi)){r.trimStart();const e=r.pos;if(Ti.fromEmbeddedExpr(r),a=r.slice(e).trimEnd(),!r.match("}"))throw r.error("expected '}'");s=Ci}else if(r.match("`")){const e=r.pos-1,t=Ti.fromTemplateTail(r);t.isLiteral()?(a=t.toLiteralValue(),s=_i):(a=r.slice(e),s=Ci)}else if(({value:a,quoted:s}=X(r)),s)Bi(a)&&(a=a.slice(1,-1));else if(""===a){if(!r.startsWith(/\s/y))throw r.error("Illegal character - must be quoted");if(o===Si)throw r.error("Expected argument to option")}yield zi(o===Ai,a,s,t)}}function Ji(e){const t=e.indexOf("=");return-1===t?[e]:[e.slice(0,t),e.slice(t+1)]}function*Wi(e){let t=!0;for(const i of e)if(t&&i.startsWith("-"))if("--"===i)t=!1;else if(i===Mi.description)yield{type:Si,value:Mi,info:Ri};else if(i.startsWith("--")){const[e,r]=Ji(i);void 0===r?yield{type:Oi,value:e,info:Ri}:(yield{type:Oi,value:e,info:Di},yield Fi(!0,r,!1,t))}else yield{type:Oi,value:i,info:Ri};else n=i,(r=$i).lastIndex=0,r.test(n)&&r.lastIndex===n.length?yield{type:Ni,value:i,info:Ri}:yield Fi(!1,i,!1,t);var r,n}function Gi(e,t=0){if("string"==typeof e)return Vi(e);if(!Array.isArray(e))throw new TypeError("Invalid argument (argument must be an array or a string)");let r=e[Symbol.iterator]();if(t)if("function"==typeof r.drop)r=r.drop(t);else for(;t;)r.next();return Wi(r)}var Hi=Object.freeze({__proto__:null,ARG_NAME:Oi,ARG_NAMED_EXPR:Ii,ARG_NAMED_VALUE:Ai,ARG_OPERATOR:Ni,ARG_POSITIONAL_EXPR:ji,ARG_POSITIONAL_VALUE:Si,FILE_TOPIC:Mi,INFO_HASVALUE:Di,INFO_NONE:Ri,INFO_QUOTED:'"',RE_EXPR_BODY:/.*?(?=\s|\})/y,RE_EXPR_START:qi,RE_OPERATOR:$i,RE_OPTION:Li,default:Gi,parseArray:Wi,parseText:Vi,shfy:function(e){if("string"!=typeof e)throw new TypeError("Source must be a string");return function(e){const t=[];let r,n=!1;for(const{type:i,value:o}of e){if(void 0!==r){if(i===Ai){t.push(`${r}=${o}`),r=void 0;continue}t.push(r),r=void 0}if(i===Si)o===Mi?t.push(Mi.description):(!n&&o.startsWith("-")&&(t.push("--"),n=!0),t.push(o));else if(i===Oi){if(n)throw new Error("Probably can't represent args as an array");r=o}else{if(i!==Ni)throw new TypeError("Unexpected arg type");n=!1,void 0!==r&&t.push(r),r=void 0,t.push(o)}}return void 0!==r&&t.push(r),t}(Vi(e))}});const Ki="none";class Xi{key;arg;impliedValue;constructor({key:e,arg:t,impliedValue:r}){Object.assign(this,{key:e,arg:t,impliedValue:r})}static fromOption({key:e,typename:t}){return new Xi({key:e,arg:"true"===t||"false"===t?Ki:"required",impliedValue:"true"===t||"false"!==t&&void 0})}}const Zi="option",Yi=Symbol("lookup"),Qi="cli";function*eo(e,t,r=0){let n="",i=Zi,o=0,a=!0;const s=t[Symbol.iterator]();try{for(const{type:t,value:p,info:c}of function*(e){const t=e[Symbol.iterator]();for(;;){const{done:e,value:r}=t.next();if(e)return r;yield r}}(s))if(i===Zi)if(t===Oi||t===Ni)e:for(let{optionName:t,optionNameTail:r}=(l=p,"-"===l[0]&&"-"!==l[1]?{optionName:l.slice(0,2),optionNameTail:l.slice(2)}:{optionName:l,optionNameTail:""});;){if(!e.has(t))throw new TypeError(`Unknown option ${JSON.stringify(t)}`);const{key:o,arg:a,impliedValue:s}=e.get(t);if(a===Ki){if(yield{key:o,value:s,isInstantiated:!0,optionName:t,source:Qi},r){t="-"+r[0],r=r.slice(1);continue e}}else r?yield{key:o,value:r!==Mi.description?r:Mi,isInstantiated:!1,optionName:t,source:Qi}:i="value";n=t;break e}else{if(t===Ai||t===Ii)throw new TypeError(`Cannot set a value for ${n}`);if(t===Si)yield{key:"",value:p,isInstantiated:!1,optionName:"",source:Qi};else{if(t!==ji)throw new TypeError("Unsupported argType");yield{key:"",value:p,isInstantiated:Yi,optionName:"",source:Qi}}if(++o,o===r)return yield{key:"",value:s,isInstantiated:!0,optionName:"...",source:Qi},void(a=!1)}else{const r=n,{key:o,arg:a}=e.get(r);if(a==Ki)throw new Error("Internal error - should be unreachable (in STATE_EXPECTING_NAMED_VALUE state for ARGVALUE_NONE arg )");if(t!==Ai&&t!==Si&&t!==Ii&&t!==ji)throw new TypeError(`Need value for ${r}`);yield{key:o,value:p,isInstantiated:(t===Ii||t===ji)&&Yi,optionName:r,source:Qi},i=Zi}if(i!==Zi)throw new TypeError(`Need value for ${n}`)}finally{a&&t.return?.()}var l}function to(e,t,r,{cwd:n}){if("function"==typeof e.is&&!e.is(t))throw"number"==typeof r&&(r="$"+r),e.enum||e.literal?new TypeError(`Invalid value ${JSON.stringify(t)} for ${r}`):new TypeError(`Cannot convert ${JSON.stringify(t)} to ${e.name} for ${r}`);return e.fromString(t,{cwd:n})}function ro(e,t,r,n,{recurse:i,cwd:o,exclude:a}){if("function"==typeof e.createListFromStringsAndInstances)return e.createListFromStringsAndInstances(t,{recurse:i,cwd:o,exclude:a});const s=[];for(let n=0;n<t.length;++n)"string"==typeof t[n]?s.push(to(e,t[n],`${r}[i]`,{cwd:o})):s.push(t[n]);return s}class no{#z;constructor(e={}){this.#z=e}get(e){return Object.hasOwn(this.#z,e)?this.#z[e]:void 0}has(e){return Object.hasOwn(this.#z,e)}}class io{present=new Set;rawDictionary;#B;#F;#V;#J;#W=[];#G=!1;setFileTopic(e){if(void 0!==this.#F)throw new TypeError("Cannot overwrite file topic.");this.#F=e}constructor(e,t={}){this.#V=e,this.rawDictionary={$:void 0,$LEXICAL_ENVIRONMENT$:void 0,cwd:void 0,...t}}has(e){return this.present.has(e)}#H(e,{value:t,get:r}){if(this.present.add(e),"function"==typeof r){if(void 0!==t)throw new Error("Cannot specifier accessor and value");Object.defineProperty(this.rawDictionary,e,{get:r,configurable:!0,enumerable:!0})}else{if(void 0!==r)throw new Error("Getter must be undefined or a function");Object.defineProperty(this.rawDictionary,e,{value:t,configurable:!0,writable:!0,enumerable:!0})}}_useFileTopic(e,t){if(void 0!==this.#B)throw new Error(U`the file topic (\`-\`) can only be used ONCE in the command line (already set via ${this.#B}) while setting ${e}`);if(void 0===this.#F)throw new Error(U`the file topic (\`-\`) not available`);return this.#B=e,void 0!==t&&(this.#F[re]=t),this.#F}appendKeyValue2(e,t,r,n,i){if("$"===e){if(void 0!==this.#J)throw new Error("Invariant: '$' can only be set onced");if(!0!==n||void 0!==r||"$"!==i)throw new Error("Internal error (incorrect params for '$')");return void(this.#J=t)}const{typename:o,type:a,recurs:s}=this.#V.getNamedOptionFromKey(e);if(console.assert(s===n,"list argument should be a recurring one."),t===Mi)a.acceptsFileTopic?(t=this._useFileTopic(e,a.realiseFileAs),r=!0):(t="-",r=!1);else if(s){const r=t.indexOf(Mi);-1!==r&&(a.acceptsFileTopic?t[r]=this._useFileTopic(e,a.realiseFileAs):t[r]="-")}if(console.assert(this.#V.hasKey(e),U`Invariant: key ${e} should exist`),console.assert(!this.present.has(e),U`Invariant: key ${e} passed multple times`),console.assert(!!n==!!s,U`Invariant: key ${e}: isList (${!!n}) should match recurs (${!!s})`),n){if(r===Yi)throw new Error("Expressions are not currently available in lists");if(t.length)if("boolean"===o){if(!r)throw new Error("Internal error (boolean options should always be instantiated )");this.#H(e,{value:t.length})}else{if(r){if(!t.some((e=>e===Yi)))throw new Error("Expressions are not currently available in lists");if(!t.every((e=>"string"!=typeof e)))throw new Error("Instantiated values cannot be strings")}this.#H(e,{value:t})}}else if(r===Yi){const r=(l=t,Ti.from(l,{expr:!0}));this.#W.push({key:e,type:a,optionName:i,optionValue:t,expr:r,index:void 0}),this.#H(e,{get:()=>{throw new Error("Not implemented!")}})}else{if("boolean"===o&&!r)throw new Error("Internal error (boolean options should always be instantiated )");const n=r?t:to(a,t,i,this.rawDictionary);this.#H(e,{value:n})}var l}appendParsedOption({key:e,value:t,isInstantiated:r,optionName:n=e,list:i=!1}){this.appendKeyValue2(e,t,r,i,n)}appendParsedOptions(e){for(const t of e)this.appendParsedOption(t)}instantiateListOption(e,t=!1){const{optionName:r,typename:n,type:i,recurs:o,defaultValue:a}=this.#V.getNamedOptionFromKey(e);if(!o)throw new TypeError("Not a list type");if("boolean"===n&&!1===a)throw new Error("Internal error (recurring booleans cannot be false)");if(this.present.has(e))"boolean"!==n&&(this.rawDictionary[e]=ro(i,this.rawDictionary[e],r,0,this.rawDictionary));else{0;Object.hasOwn(this.rawDictionary,e)||t||(this.rawDictionary[e]="boolean"===n?0:ro(i,[],r,0,this.rawDictionary))}}_createLexicalEnvironment(){const{rawDictionary:e}=this;if(void 0!==e.$LEXICAL_ENVIRONMENT$)throw new TypeError("About to overwrite $LEXICAL_ENVIRONMENT$");e.$LEXICAL_ENVIRONMENT$=new no(e)}_instantiateAndDefaultLists(){for(const{key:e,recurs:t}of this.#V.enumAllOptions())t&&this.instantiateListOption(e,!1);for(const{key:e,recurs:t}of this.#V.enumAllPositionals())t&&this.instantiateListOption(e,!0)}_instantiateExpressions(){const{rawDictionary:e}=this;for(const{key:t,type:r,optionName:n,optionValue:i,expr:o,index:a}of this.#W){const i=o.exec(new no(e),{}),s="string"==typeof i?to(r,i,n,e):i;if(void 0===a)Object.defineProperty(e,t,{value:s});else{if(!Number.isSafeInteger(a))throw new TypeError("Invalid index");const r=e[t];if(!Array.isArray(r))throw new Error("Attempt to instantiate element of a non list");if(a<0||a>=r.length)throw new RangeError("Index out of range");r[a]=i}}}finalise(){if(this.#G)throw new Error("Can only finalise() once!");const{rawDictionary:e}=this;this._createLexicalEnvironment(),this._instantiateAndDefaultLists(),this._instantiateExpressions();const t=[];for(const r of this.#J??[])t.push(e[r]);e.$=t;for(const[t,r]of this.#V.getAliases())Object.hasOwn(e,r)&&(e[t]=e[r]);return Object.defineProperty(this.rawDictionary,ae,{enumerable:!1,value:new Set(this.present)}),this.#G=!0,this.rawDictionary}usesFileTopic(){return void 0!==this.#B}}function oo(e){return e.replaceAll(/-[a-z]/g,(e=>e.charAt(1).toUpperCase()))}function ao(e){return e.replaceAll(/(?:(?<=[a-z])[A-Z]|(?<=[A-Z])[A-Z](?=[a-z]))/g,(e=>"_"+e)).toUpperCase()}const so="--",lo="$n",po="$n#",co="($n)",uo="'",fo="...",mo="(')",ho="(...)",go="true",yo="false";function vo(e,t,r,n){return{type:so,option:t,key:e,value:r,shortAlias:n}}function wo(e,t){return{type:lo,value:e,identifier:t}}function bo(e,t,r){return{type:po,value:e,suffix:t,identifier:r}}const xo="only one optional block is allowed at any level as otherwise the sequence would be ambiguous",Eo="Must be separated by whitespace",To="suffixed type not allowed here",ko=/^[a-z][0-9a-z]*(?:[_-][0-9a-z]+)*$/,So=/^[A-Z]+(?:_[A-Z]+)?(?:\d+)?$/,Ao=/^--[a-z]+(?:-[a-z]+)*$/,Oo=/^-[a-zA-Z0-9]$/,No=/[-_A-Za-z0-9]+/y,jo=/\d+$/g;function Io(e,t){throw e.error(`\`...\` not allowed (${t})`,e.lastIndex)}function Lo(e,t){throw e.error(`unexpected \`[\` (${t})`,e.lastIndex)}function $o(e,t){throw e.error(t,e.lastIndex)}function qo(e){return e.charAt(0)+e.slice(1).toLowerCase().replace(/_[a-z]/,(e=>e.charAt(1).toUpperCase()))}const Ro="literal",Do="type",Uo="type#",_o="type...",Co="option",Mo="punctuator",Po="(--)";function zo(e,t=!1){t&&e.trimStart();const r=e.fence(),n=e.match(No,!1);if(n){const t=function(e,t){if(/^[A-Z]/.test(e)){if(!So.test(e))throw t.error("Invalid type (typenames must be entirely uppercase with at most one underscore)");return Do}if(e.startsWith("-"))return"--"===e?Po:Co;if(!ko.test(e))throw t.error("Invalid literal (literals must be entirely lowercase broken by single underscores or hyphens )");return Ro}(n,e);if(t===Po)throw e.error("annotation not allowed here");if(t!==Do)return{type:t,value:n,index:r,suffix:void 0,identifier:n};{const{typename:t,suffix:i}=function(e){const t=e.match(jo);if(!t)return{typename:qo(e),suffix:""};const r=t[0];return{typename:qo(e.slice(0,e.length-r.length)),suffix:r}}(n),o=e.match("...");if(i&&o)throw e.error(To);return{type:o?_o:i?Uo:Do,value:t,index:r,suffix:i,identifier:n}}}const i=e.match(/[|\[\]()=]|\.+/y,!1);if(i)return{type:Mo,value:i,index:r,suffix:void 0};const o=e.match(/\s+/y,!1);if(o)return{type:"ws",value:o};if(e.atEof()||e.startsWith(G,!1))return{type:"eof",value:void 0,index:r};throw e.error("unexpected character")}function Bo(e,t=zo(e)){if(")"===t.value)throw e.error("empty `()`");if(t.type===Mo)throw e.error(`unexpected token ${JSON.stringify(t.value)}`);const r=t.type,n=[t.value],i=r===Co?2:268435455;for(;;){const t=zo(e,!0);if(")"===t.value)return{type:r,values:n};if("|"!==t.value)throw e.error(`unexpected token ${JSON.stringify(t.value)}`);if(n.length===i)throw e.error("can only have a short option and a long option");const{type:o,value:a}=zo(e,!0);if(o!==r)throw e.error("all members of an equivalent class must have the same type");n.push(a)}}function Fo(e,t,r=void 0){if(!Ao.test(e))throw t.error("options names must be groups of lowercase letters, separated by single dashes");const n=e.startsWith("--no-"),i=oo(n?e.slice(5):e.slice(2));if(!t.match("="))return vo(i,e,n?yo:go,r);if(n)throw new t.error("Options beginning '--no-' may not take a value type");const o=function(e,t){const{type:r,value:n}=zo(e);if(r==Mo&&"("===n){const t=e.lastIndex,{type:r,values:n}=Bo(e);if(r!==Ro)throw e.error("only a group of literals",t);return n}if(r===Do)return n;if(r===Ro)return[n];throw r===Uo?e.error(To):r===_o?e.error(`a list is not allowed here (do you want \`[${t}=${n.toUpperCase()}]...\`?)`):new e.error("unexpected token")}(t,e);return vo(i,e,o,r)}function Vo(e,t){console.assert(2===e.length),e[0].startsWith("--")||([e[0],e[1]]=[e[1],e[0]]);const r=e[0],n=e[1];if(!Oo.test(n))throw t.error("an option can only be aliased as dash following by a letter or number");return Fo(r,t,n[1])}function Jo(e,t=!1){const r=[];e.trimStart();let n=!1,i=!0;for(;;){const{type:o,value:a,index:s,suffix:l,identifier:p}=zo(e);if("]"===a)break;if("["===a)!i&&Lo(e,Eo),n&&Lo(e,xo),r.push(Jo(e)),n=!0;else if("("===a){!i&&$o(e,Eo);const t=s,{type:n,values:o}=Bo(e);if(n!==Ro&&n!==Do)throw n===Uo||n===_o?e.error("can only construct a variant with pure types (no suffixes, no lists)",t):n===Co?e.error("unexpected '-' (named options can only appear in a top-level block immediately after the command name)"):e.error("unknown type for token",t);if(o.length>1){const t={type:n===Ro?mo:co,value:o};e.match("...")?r.push({type:fo,value:t,min:1}):r.push(t)}else{if(1!==o.length)throw new Error("Empty equivalece classes should be prohibitted");r.push(n===Ro?{type:uo,value:o[0]}:wo(o[0],p))}}else{if(o===Co)throw e.error("unexpected '-' (named options can only appear in a top-level block immediately after the command name)");if(o===Ro)r.push({type:uo,value:a});else if(o===Do)r.push(wo(a,p));else if(o===Uo)r.push(bo(a,l,p));else{if(o!==_o){if("eof"===o){if(t)break;throw e.error("expected `]` (unterminated optional block)")}throw e.error(`unexpected token ${JSON.stringify(a)}`,s)}n&&Io(e,xo),n=!0,console.assert(void 0===l||""===l,"no suffix on list"),r.push({type:fo,value:wo(a,p),min:1})}}i=e.atEof()||e.startsWith(G,!1)||e.trimStart()}if(0===r.length&&!t)throw e.error("empty `[]` are not allowed!",e.lastIndex);if(e.match("...")){console.assert(!t),r.length>1&&Io(e,"can only repeat sections containing a single term");const n=r[0];return n.type===lo||n.type===so||Io(e,"unknown type"),{type:fo,value:n,min:0}}if(!t&&1===r.length&&r[0].type===fo){const e=r[0];return console.assert(1===e.min,"list reduction from 1"),e.min=0,e}return r}function Wo(e,t){return"]"===zo(t,!0).value||function(e,t,r){throw e.error(`expected \`${t}\` (${r})`,e.fence())}(t,"]","only one named option per optional block"),t.match("...",!1)?{type:fo,value:e,min:void 0}:e}function Go(e,t){return e.type!==so&&e.type!==fo?e:K(e,t)}function Ho(e,t=""){const r=[];if("string"!=typeof t)throw new TypeError("$0 should be a string");if(t){const e=t===H?wo("String",H):{type:uo,value:t};r.push(e)}e.trimStart();const{mandatoryOptions:n,optionalOptions:i}=function(e){const t=[],r=[];for(;;){const n=zo(e,!0);if("["===n.value){e.trimStart();const{type:t,value:i}=zo(e);if(t===Co){if(!i.startsWith("--"))throw e.error("expected '--' (only long options supported)");const t=Go(Wo(Fo(i,e),e),e);r.push(t)}else{if("("!=i){e.rollback(n.index);break}{const t=zo(e);if(t.type!==Co){e.rollback(n.index);break}{const{values:n}=Bo(e,t),i=Go(Wo(Vo(n,e),e),e);r.push(i)}}}}else if("("===n.value){const r=zo(e);if(r.type!==Co){e.rollback(n.index);break}{const{values:n}=Bo(e,r),i=Vo(n,e);t.push(i)}}else{if(n.type!==Co){e.rollback(n.index);break}if(!n.value.startsWith("--"))throw e.error("expected '--'");t.push(Go(Fo(n.value,e),e))}const i=e.trimStart();if(e.atEof()||e.startsWith("::"))break;if(!i)throw e.error("unexpected character")}return{mandatoryOptions:t,optionalOptions:r}}(e);return r.push(...Jo(e,!0)),e.match("::",!0),[n,i,r]}const Ko=Symbol("literal");function Xo({type:e,value:t,suffix:r},n){if(e===fo){if(t.type===fo)throw new TypeError("list-in-list");return Xo(t,n)}if(e===lo||e===po||e===mo)return{typename:t,type:Xr(t,n)};if(e===co)return{typename:t,type:Qr(t)};if(e===uo)return{typename:Ko,type:Zr(t,n)};throw new TypeError(`Unknown nodetype ${JSON.stringify(e)}`)}class Zo{key;aliases=new Set;typename;type;mandatory=!0;recurs;orgTypeName;orgTypeIdentifier;index;constructor({typename:e="",type:t=null,recurs:r=!1,orgTypeName:n="",orgTypeIdentifier:i="",index:o}){this.key=`$${o}`,Object.assign(this,{typename:e,type:t,recurs:r,orgTypeName:n,orgTypeIdentifier:i,index:o})}static fromAstNode(e,t,r=`$${t}`){const{typename:n,type:i}=Xo(e,r),o=function({type:e,value:t,suffix:r}){return e===fo?t.value:e===lo?t:e===po?t+r:""}(e),a=e.type===fo;return new Zo({typename:n,type:i,recurs:a,orgTypeName:o,orgTypeIdentifier:a?e.value.identifier:e.identifier,index:t})}}function Yo(e,t){return`$${r=e,64&r.charCodeAt(r)?r=r.charAt(0).toLowerCase()+r.slice(1):r}${t?"s":""}`;var r}function Qo(e){const t=function(e){const t=new Map;for(let r=0;r<e.length;++r){const{key:n,type:{literal:i,variant:o},recurs:a,orgTypeName:s}=e[r];if(!i&&!o)if(t.has(s)){const e=t.get(s);e.singular?(e.singular=!1,e.index=[e.index,r],e.key=[e.key,n],e.recurs=[e.recurs,a]):(e.index.push(r),e.key.push(n),e.recurs.push(a))}else t.set(s,{key:n,singular:!0,index:r,recurs:a})}return t}(e);for(const[r,{key:n,singular:i,index:o,recurs:a}]of t.entries())i&&e[o].aliases.add(Yo(r,a))}const ea=268435455;class ta{#K;#X;#Z;#Y;#Q=!1;#ee;#te;get longest(){return this.#te}shortest;size;constructor(e){const t=[],r=[];let n=0,i=0;const o=new Set,a=function(e,t){let r=0;const n=[],i=[{source:e,dest:n,branch:0,branches:0}];for(;i.length;){const{source:e,dest:n,branch:o,branches:a}=i.pop();for(let s=n.length;s<e.length;++s){if(Array.isArray(e[s])){const t=[];i.push({source:e,dest:n,branch:o,branches:a+1}),i.push({source:e[s],dest:t,branch:a,branches:0}),n.push(t);break}const l=i.length;n.push(t(e[s],r++,l,s,o))}}return n}(e,((e,a,s,l,p)=>{const c=Zo.fromAstNode(e,a);if(e.suffix){if(o.has(c.orgTypeName))throw new TypeError(`duplicate ${e.value} suffix '${e.suffix}' at $${a}`);o.add(c.orgTypeName)}if(c.recurs&&t.push({positional:c,depth:s,flatIndex:a,localIndex:l,min:e.min}),0===s?i++:s>n&&(n=s),0!==p)throw new Error("Can only have one optional segment");return console.assert(r.length===a,"invariant: flat index"),r.push(c),c}));let s=r.length,l=s,p=null,c=!1;if(t.length){if(1!==t.length)throw new TypeError("Only one positional may be a list.");if(t[0].depth!==n)throw new TypeError("List must be maximully eldied");p=t[0].positional,l=t[0].flatIndex,c=0===t[0].min,s=ea,c&&i--}if(Qo(r),function(e){for(const[t,r]of Object.entries(Object.groupBy(e,(({orgTypeIdentifier:e})=>e))))if(""!==t&&"string"==typeof t)if(1!==r.length)for(const e of r);else r[0].aliases.add(t)}(r),this.#K=a,this.#X=r,this.shortest=i,this.#te=s,this.#Z=l,this.#Y=p,this.#ee=c,this.size=n+1,!(null!==this.#Y?this.longest===ea:this.longest!==ea))throw console.log("this",this.#Y,this,null!==this.#Y,this.longest!==ea),new Error("List invariant failed")}hasList(){return console.assert(null!==this.#Y?this.longest===ea:this.longest!==ea,"PositionalTree: invariant: both measures of list must match"),null!==this.#Y}getLongestBranch(){return this.#X}enumOptions(){return this.#X.values()}getNearestTo(e){const t=function(e,t){for(;;){const r=e.filter((e=>!Array.isArray(e)));if(t<=r.length||r.length===e.length)return r;e=e.flat(1)}}(this.#K,e);if(this.#ee&&t.length>e){const e=t.findIndex((e=>e===this.#Y));if(-1===e)throw new TypeError("List missing");t.splice(e,1)}return t}getList(){return this.#Y}getListSlice(e){if(!this.hasList())return;const t=this.#X.length-1,r=t<e?e-t:0;return 0===r&&this.#ee?void 0:{start:this.#Z,end:this.#Z+r}}isEmpty(){return 0===this.#te}arrange(e){return function(e,t){const r=t.length-1?"only "+(t.length-1):"none";if(t.length<e.shortest)throw new TypeError(`Required ${e.size>1?"at least ":""}${e.shortest-1} arguments - but ${r} given.`);const n=e.getNearestTo(t.length);if(t.length<n.length)throw new TypeError(`Required ${n.length} arguments - but only ${r} given`);if(t.length>e.longest)throw new TypeError(`No more than ${e.longest} positional arguments`);const i=e.getListSlice(t.length);let o;var a,s,l;return i?(o=t.slice(0),a=o,s=i.start,l=i.end,a[s]=a.splice(s,l-s,null)):o=t,{positionals:o,positionalOptions:n}}(this,e)}*aliases(){for(const{key:e,aliases:t}of this.#X)for(const r of t)yield[e,r]}get(e){return this.#X.find((({key:t})=>t===e))}has(e){return this.#X.some((({key:t})=>t===e))}addTail(){if(this.#Q||this.hasList())throw new Error("already has a tail");if(this.shortest!==this.longest)throw new TypeError("can only set tail when there are no optionals");this.shortest++,this.#te++,this.#Q=!0;const e=new Zo({index:this.shortest-1});this.#X.push(e),this.#K.push(e)}getTailStartIndex(){return this.#Q?this.shortest-1:0}}const ra="inline";const na="instantiated",ia="none";function oa({defaultText:e,defaultValue:t}){return void 0!==t?{type:na,value:t}:void 0!==e&&e?{type:"raw",value:e}:{type:ia,value:void 0}}class aa{key;optionName;shortAlias;optionNames;typename;type;mandatory;platform;recurs;defaultText;defaultValue;annotation="";constructor({key:e,optionName:t,shortAlias:r,typename:n,mandatory:i,platform:o,recurs:a,defaultText:s,defaultValue:l,annotation:p=""}){if(!function(e){return"string"==typeof e||"symbol"==typeof e||!!Array.isArray(e)&&e.every((e=>"string"==typeof e))}(n))throw new TypeError("Invalid typename");if("string"!=typeof t||!t.startsWith("--"))throw new TypeError("Invalid option name");let c;if(""===n){if(o!==ra)throw new TypeError("Invalid typename");c=null}else c=Xr(n,e);const u=[t];if("string"==typeof r&&r){if(1!==r.length)throw new Error("Invalid short alias");u.push(`-${r}`)}Object.assign(this,{key:e,optionName:t,shortAlias:r,optionNames:u,typename:n,type:c,mandatory:i,platform:o,recurs:a,defaultText:s,defaultValue:l,annotation:p})}static fromMandatoryAstNode(e){const t=e.type===fo,{platform:r=""}=e,{type:n,key:i,value:o,option:a,shortAlias:s}=t?e.value:e;return console.assert(n===so,"node must be a named parameter"),new aa({key:i,optionName:a,shortAlias:s,typename:o,mandatory:!0,platform:r,recurs:!!t,defaultText:void 0,defaultValue:void 0,annotation:e.annotation})}static fromNonMandatoryAstNode(e,t,r){const n=e.type===fo,{platform:i=""}=e,{type:o,key:a,value:s,option:l,shortAlias:p}=n?e.value:e;return console.assert(o===so,"node must be a named parameter"),new aa({key:a,optionName:l,shortAlias:p,typename:s,mandatory:!1,platform:i,recurs:!!n,defaultText:t,defaultValue:r,annotation:e.annotation})}static fromInlineOption({name:e,typename:t,hasDefaultValue:r,defaultValue:n}){if("string"===t)t="String";else if("boolean"===t&&r){if("boolean"!=typeof n)throw new Error("Assert: typeof defaultValue === 'boolean'");t=n?yo:go}const i=(t===yo?"--no-":"--")+e.replaceAll(/(?:(?<=[a-z])[A-Z]|(?<=[A-Z])[A-Z](?=[a-z]))/g,(e=>"-"+e)).toLowerCase();return new aa({key:e,optionName:i,shortAlias:void 0,typename:t,platform:ra,recurs:!1,defaultText:void 0,defaultValue:n})}isInsaneBoolean(){const{typename:e}=this;return e===go||e===yo}static sanitiseBoolean(e){if(1!==e.length&&2!==e.length)throw new TypeError("1-2 booleans required for sanitisation");if(!e[0].isInsaneBoolean())throw new TypeError("No sanitisation necessary");if(e.length>1&&!e[1].isInsaneBoolean())throw new TypeError("No sanitisation necessary");const t=new aa(e[0]);t.typename="boolean";const r=typeof t.defaultValue;if("boolean"!==r&&"undefined"!==r)throw new TypeError("`typeof defaultValue` should be `undefined` or `boolean`");return 2===e.length?(console.assert(!t.mandatory,"not mandatory"),t.defaultText=void 0,t.defaultValue=void 0):(console.assert("boolean"==typeof t.defaultValue||void 0===t.defaultValue,"single boolean arg must have a default value"),console.assert(t.defaultText===oe||void 0===t.defaultText,"expected default text to be DEFAULT_MISSING_BOOL",t.defaultText)),t}isInline(){return this.platform===ra}toBaseOptionName(){const{optionNames:e}=this;return e.length>1?`(${e.join("|")})`:e[0]}toBareUsage(e){let t,r=this.toBaseOptionName();if(t=this.optionNames.length>1?e.get(this.optionNames[0]).arg!==Ki:e.get(r).arg!==Ki,t){const{typename:e}=this;Array.isArray(e)?r+=`=(${e.join("|")})`:r+="="+ao(e)}return this.recurs&&(r+="..."),r}}function*sa(e){do{yield e}while(e=e.next)}function*la(e,t){e.has(t)&&(yield*sa(e.get(t)))}class pa{#re=new Set;#T=new Map;get size(){return this.#re.size}has(e){return this.#T.has(e)}get(e){if(this.#T.has(e))return this.#T.get(e).value}enumAll(e){return la(this.#T,e).map((({value:e})=>e))}getAll(e){return function(e,t){return Array.from(la(e,t),(({value:e})=>e))}(this.#T,e)}set(e,t){for(const t of la(this.#T,e))this.#re.delete(t);const r={key:e,value:t,next:null};this.#re.add(r),this.#T.set(e,r)}append(e,t){const r={key:e,value:t,next:null};this.#re.add(r),this.#T.has(e)?(function(e,t){for(const r of la(e,t))if(!r.next)return r}(this.#T,e)).next=r:this.#T.set(e,r)}delete(e){for(const t of la(this.#T,e))this.#re.delete(t);this.#T.delete(e)}*entries(){for(const{key:e,value:t}of this.#re)yield[e,t]}keys(){return this.#T.keys()}*multipleValues(){for(const e of this.#T.values())e.next&&(yield Array.from(sa(e),(({value:e})=>e)))}}function ca(e,t,r,n=""){let i=`${n}${t(e[0])}`;for(let n=1;n<e.length;++n)i=`${i}${r}${t(e[n])}`;return i}function ua(e){if(Array.isArray(e))return`[${ca(e,ua," ")}]`;if(e.type===uo)return e.value;if(e.type===fo)return ua(e.value)+"...";if(e.type===lo)return ao(e.value);if(e.type===co)return`(${ca(e.value,ao,"|")})`;if(e.type===so)return ca(function(e,{annotation:t=!0,defaultJson:r}={}){const n=function(e){return e.type===fo?e.value:e.type===so?e:(console.log(e),null)}(e);if(!n)throw console.log(e),new TypeError("Not an option node");const i=[],{option:o,shortAlias:a,value:s}=n,{annotation:l}=e;a?i.push({type:"literal",value:"("},{type:"short",value:`-${a}`},{type:"literal",value:"|"},{type:"long",value:o},{type:"literal",value:")"}):i.push({type:"long",value:o});"true"!==s&&"false"!==s&&(i.push({type:"literal",value:"="}),Array.isArray(s)?i.push({type:"type",value:"("+ca(s,(e=>e),"|")+")"}):i.push({type:"type",value:ao(s)}));e.type===fo&&i.push({type:"literal",value:"..."});t&&l&&i.push({type:"literal",value:": "},{type:"annotation",value:l});void 0!==r&&i.push({type:"literal",value:" "},{type:"literal",value:"["},{type:"literal",value:"DEFAULT:"},{type:"literal",value:" "},{type:"value",value:JSON.stringify(r)},{type:"literal",value:"]"});return i}(e,{annotation:!1}),(e=>e.value),"");if(e.type===mo)return`(${e.value.join("|")})`;if(e.type===ho)return"...";throw console.log(e),console.log(lo,e.type===lo),new TypeError(U`Unsupported node type (${e.type})`)}const da="default";function fa(e){const{instantiated:t=[],raw:r=[]}=Object.groupBy(e,(({isInstantiated:e})=>e?"instantiated":"raw"));if(0===t.length)return{values:r.map((({value:e})=>e)),isInstantiated:!1};if(0===r.length)return{values:t.map((({value:e})=>e)),isInstantiated:!0};throw new Error("Cannot mix instanatiated and unintatiated values")}class ma{#ne;#ie;#oe;#ae;get positionalOptions(){return this.#ie}get cliMap(){return this.#ae}get saneOptionsFromKey(){return this.#oe}get positionalAstNodes(){return this.#ne}constructor({positionalAstNodes:e,positionalTree:t,saneOptionsFromKey:r,cliMap:n}){this.#ne=e,this.#ie=t,this.#oe=r,this.#ae=n}static fromOptionsOnly(e,t="",r={},n=[]){return function(e,t="",r,n){const i=va(Ho(new te(e),""),r,n);if(i.hasPositionalOptions())throw console.log(i.positionalOptions),new TypeError("Cannot add positional options");if(""!==t)for(const e of i.saneOptionsFromKey.values())console.assert(""===e.platform,"platforms shouldn't be defined (was %s)",e.platform),e.platform=t;return i}(e,t,r,n)}hasPositionalOptions(){return!this.#ie.isEmpty()}hasRecurringPositional(){return null!==this.#ie.getList()}getRecurringPositionalType(){return this.#ie.getList()?.type??null}enumPositionalTypes(){return new Set(this.#ie.getLongestBranch().map((({type:e})=>e))).values()}getPostionalString(){const e=this.#ne.values();e.next();let t="";for(const r of e)t&&(t+=" "),t+=ua(r);return t}enumAllOptions(){return this.#oe.values()}enumAllPositionals(){return this.#ie.enumOptions()}getCliMap(){return this.#ae}keys(){return this.#oe.keys()}getNamedOptionFromKey(e){return e.startsWith("$")?this.#ie.get(e):this.#oe.get(e)}hasKey(e){return e.startsWith("$")?this.#ie.has(e):this.#oe.has(e)}addOptions(e){const t=new Map(this.#oe.entries()),r=new Map(this.#ae.entries());for(const[t,n]of e.cliMap){if(r.has(t))throw new TypeError(U`key ${t} already defined`);r.set(t,n)}for(const[r,n]of e.saneOptionsFromKey){if(t.has(r))throw new TypeError(U`key ${r} already defined`);t.set(r,n)}return new ma({positionalAstNodes:this.#ne,positionalTree:this.#ie,saneOptionsFromKey:t,cliMap:r})}getConflictingOptions(e){return new Set(this.#ae.keys()).intersection(new Set(e.cliMap.keys()))}rawParse(e){return eo(this.#ae,e)}*parseOptions(e){const t=this.#oe,r=this.#ae,n=new Set(t.values()),i=new Map(Array.from(function*(e){for(const t of e.values())if(t.recurs){if(t.mandatory)throw new Error("Invariant: a recurring key cannot be mandatory");if(oa(t).type!==ia)throw new Error("Invariant: recurring items cannot have a default");yield t}}(t),(e=>[e,[]]))),o=[];for(const a of eo(r,e,this.#ie.getTailStartIndex())){if(""===a.key){o.push(a);continue}const e=t.get(a.key);if(i.has(e)){i.get(e).push(a)}else{if(!n.has(e))throw new TypeError(U`Cannot repeat option ${e.toBaseOptionName(r)}`);yield a}n.delete(e)}for(const[e,t]of i){const{optionName:r}=e,{values:i,isInstantiated:o}=fa(t);yield{key:e.key,value:i,isInstantiated:o,optionName:r,source:i.length?Qi:da,list:!0},n.delete(e)}for(const e of n){if("help"===e.key)continue;if(e.mandatory)throw new TypeError(U`Missing option ${e.toBareUsage(r)}`);const{type:t,value:n}=oa(e);if(t!==ia){const{optionName:r}=e;yield{key:e.key,value:n,isInstantiated:t===na,optionName:r,source:da,list:!1}}}const{positionals:a,positionalOptions:s}=this.#ie.arrange(o);console.assert(a.length===s.length,"PositioanlOptions and rawPositionals must marry up");for(let e=0;e<a.length;++e){const t=s[e];if(t.recurs){const{values:r,isInstantiated:n}=fa(a[e]);yield{key:t.key,value:r,isInstantiated:n,optionName:t.key,source:Qi,list:!0}}else{const{value:r,isInstantiated:n,source:i}=a[e];yield{key:t.key,value:r,isInstantiated:n,optionName:t.key,source:Qi,list:!1}}}yield{key:"$",value:s.map((e=>e.key)),isInstantiated:void 0,optionName:"$",source:"computed",list:!0}}*getAliases(){for(const{aliases:e,key:t}of this.#ie.enumOptions())for(const r of e)yield[r,t]}addOperators(e){const t=this.#ae;for(const[r,n]of Object.entries(e))t.has(n)&&t.set(r,this.#ae.get(n));return this}addTail(){this.#ie.addTail(),this.#ne.push({type:ho})}}function ha(e,t){if(!e.hasDefaultValue&&!e.hasExplicitType)return!0;throw new Error("Cannot declare an option in both usage and binding")}function ga(e,t,r,n){const{key:i}=e,o=n.get(i),a=n.has(i);return t&&a&&console.warn(U`warning: list option ${i} has a default value`),r.has(i)?(a&&console.warn(U`warning: default for option ${i} will be ignored`),{defaultText:r.get(i),defaultValue:o}):t||"true"!==e.value&&"false"!==e.value?{defaultText:void 0,defaultValue:o}:a?("true"===e.value?!1!==o&&console.trace(`warning: true option ${i} doesn't default to false`):!0!==o&&console.warn(`warning: false option ${i} doesn't default to true`),{defaultText:oe,defaultValue:o}):{defaultText:oe,defaultValue:"true"!==e.value}}function ya(e,t={},r=[],n){const i=function([e,t,r]){const n=new ta(r);if(!n)throw new TypeError("Postional arguments are ambiguous.");return{mandatoryOptions:e,optionalOptions:t,positionalTree:n}}(e),{mandatoryOptions:o,positionalTree:a,optionalOptions:s}=i;for(const e of s)e.platform="";const l=[];for(const e of o)l.push(aa.fromMandatoryAstNode(e));const p=new Map(Object.entries(t)),c=new Map(r);for(const e of s){const t=e.type===fo,r=t?e.value:e,{defaultText:n,defaultValue:i}=ga(r,t,p,c);l.push(aa.fromNonMandatoryAstNode(e,n,i))}for(const e of n)l.push(aa.fromInlineOption(e));return{allOptions:l,positionalTree:a}}function va(e,t={},r=[],n=[]){const{allOptions:i,positionalTree:o}=ya(e,t,r,n),a=new Map,s=new pa;for(const e of i){const{key:t,optionNames:r}=e;s.append(t,e);for(const e of r)if(a.has(e)){if(a.get(e)!==t)throw new Error(U`Duplicate option ${e}`)}else a.set(e,t)}const l=new Map;for(const e of s.keys()){const t=s.getAll(e);t.length,0;const{inline:r=[],usage:n=[]}=Object.groupBy(t,(e=>e.isInline()?"inline":"usage"));if(n.length>1){if(2!==n.length||n[0].optionName===n[1].optionName)throw new TypeError(`Duplicate options for key ${e}`);if(n.some((e=>e.defaultText!==oe)))throw new TypeError(`Duplicate options for key ${e}`);for(const e of n)e.defaultText=void 0;const t=aa.sanitiseBoolean(n);l.set(t.key,t)}else 1===n.length&&l.set(n[0].key,n[0].isInsaneBoolean()?aa.sanitiseBoolean(n):n[0]);if(r.length>=1){if(1!==r.length)throw new Error(`Internal error (inline options for key ${e} not deduplicated)`);if(0===n.length&&""===r[0].typename)throw new Error(U`Inline-option ${r[0].optionName} has no type. (Add a type or shadow the option in the usage )`);if(!ha(r[0],n[0]))throw new Error("Cannot declare an option in both usage and binding");0===n.length&&l.set(r[0].key,r[0].isInsaneBoolean()?aa.sanitiseBoolean(r):r[0])}}const p=new Map;for(const[e,t]of a){const r=s.getAll(t);if(1===r.length)p.set(e,Xi.fromOption(r[0]));else if(r[0].optionNames.includes(e))p.set(e,Xi.fromOption(r[0]));else{if(!r[1].optionNames.includes(e))throw console.log(r),new Error(U`Internal error (can't find option record for key ${t} with option name ${e})`);p.set(e,Xi.fromOption(r[1]))}}return new ma({positionalAstNodes:e[2],positionalTree:o,saneOptionsFromKey:l,cliMap:p})}const wa="Expected SCRIPTLET_NAME",ba="Invalid version string",xa="Illegal character",Ea=/\d+(?=\s)/y;function Ta(e,t){if(e.toUpperCase()!==e)throw t.error("Environment variables must be composed of UPPERCASE letters");if(e.includes("-")){if(e.includes("_"))throw t.error("Environment variables cannot mix SNAKE_CASE (underscores) with KEBAB-CASE (hyphens)");return t.warn("Environment variables should use SNAKE_CASE (underscores) not KEBAB-CASE (hyphens)"),oo(e.toLowerCase())}return e.toLowerCase().replaceAll(/_[a-z]/g,(e=>e.charAt(1).toUpperCase()))}function ka(e,t=!1){return e.atEof()||e.startsWith(G)||(t?e.trimStart():e.startsWith(/\s/y))}const Sa="A".charCodeAt(0),Aa="a".charCodeAt(0);function Oa(e){const t=e.match(/\d+/y,!1);if(""===t)throw e.error(ba);const r=parseInt(t,10);if(0===r)throw e.error(ba);const n=e.match(/[A-Za-z]?/y,!1);let i=0;if(n.length){const e=n.charCodeAt(0);i=e<"a".charCodeAt(0)?26+e-Sa:e-Aa,++i}if(!ka(e,!0))throw e.error(ba);return{major:r,minor:i,text:t+n}}const Na=/\s*?(?:\r?\n|$)/y,ja=/\s*?(?=\r\n?|\n|\S|$)/y,Ia=/\r\n?|\n/y,La=/\s/y;const $a=new Set(["idl","details","summary","defaults","api","name"]);function qa(e,{extractName:t=!1}={}){if(!1===t)throw new TypeError("No extract name");const r=new te(e),{major:n,minor:i}=function(e){if(e.trimStart(),!e.match("IDL=",!1)){if(!e.match("API=",!1))throw e.error("Expected `IDL=<version>` as first token.");console.warn("deprecated: use of `API=` instead of `IDL=`")}return Oa(e)}(r),o=function(e){const t=[];let r="";const n=()=>{r&&(t.push(r),r="")};for(;e.match(ja,!1),!e.atEof();)if(e.match("--",!1)){if(e.atEof())break;if(!e.startsWith(La))throw e.error("Expected whitespace");if(e.match(Na,!1))n();else{const t=e.match(W,!1);r+=t}}else{if(!e.match(Ia))break;n()}return n(),t}(r),a=function(e){const t={idl:void 0};for(;;){const r=e.pos;if(e.startsWith("-"))throw e.error(wa);const n=e.match(B,!1)||e.match(H);if(!n)throw e.error(wa);if(n===H||!e.match("=",!1)){if(!ka(e,!1))throw e.error(xa);const{annotation:r}=K({},e);return t.idl=e.getText().slice(e.pos),t.name=n,void 0!==r&&(t.summary=r),t}const i=Ta(n,e);if($a.has(i))throw e.error(`Environment variable uses reserved name (${i})`,r);if(Object.hasOwn(t,i))throw e.error(`Environment variable redeclared (${i})`,r);if(ka(e,!1))throw e.error("Expected value");let o;if(o=""!==e.match(Ea,!1)?parseInt(e.slice(e.lastIndex),10):Z(e),!ka(e,!0))throw e.error(xa);t[i]=o.valueOf()}}(r);return a.api=n+i/100,o.length&&(a.summary=o[0],a.details=o.slice(1)),a}class Ra{#se;#le;#pe;constructor(e,t){this.#se=e,this.#le=t}setValueAsBuffer(e){this.#le.write(e)}setValueAsBufferStream(e){for(const t of e)this.#le.write(t)}toStream(){return this}async fetchValueAsBuffer(){if(!this.#se)throw new TypeError("Stream not readable");return this.#pe=async function(e){const t=[];for await(const r of e)t.push(r);return Buffer.concat(t)}(this.#se)}toBuffer(){return this.fetchValueAsBuffer()}async fetchContentAsResponse(){const e=await this.fetchValueAsBuffer();return new Response(e,{status:200,statusText:"OK",headers:new Headers})}}const Da=(e,t)=>Math.imul(e,t);function Ua(e){return Da((t=Da(e,3432918353))<<15|t>>>17,461845907);var t}const _a="input",Ca={Map:Map,Set:Set,Buffer:Buffer,Boolean:Boolean,Error:Error,Promise:{all:e=>Promise.all(e)},String:String,Number:Number,JSON:{stringify:JSON.stringify,parse:JSON.parse,isJSON:()=>!0,[re]:()=>JSON}},Ma={"%Response.prototype%.buffer(...)":async function(){return Buffer.from(await this.arrayBuffer())},..."undefined"==typeof Iterator?{"%Iterator.prototype%.map(...)":function*(e){for(const t of this)yield e(t)},"%Iterator.prototype%.toArray(...)":function(){const e=[];for(const t of this)e.push(t);return e},"%Iterator.prototype%.forEach(...)":function(e){for(const t of this)e(t)}}:{},"%String.prototype%.hash(...)":function(e){return function(e,t=4294967295*Math.random()>>>0){let r=t,n=0;for(;n+3<e.length;n+=4)r^=Ua(e.readUint32LE(n)),r=(i=r)<<13|i>>>19,r=Da(r,5),r=3864292196+(r>>>0)>>>0;var i;return r^=Ua(function(e,t){let r=0;return t<e.length&&(r=e[t],t+1<e.length&&(r<<=8,r|=e[t+2],t+2<e.length&&(r<<=8,r|=e[t+2]))),r}(e,n)),r^=e.length,r^=r>>>16,r=Da(r,2246822507),r^=r>>>13,r=Da(r,3266489909),r^=r>>>16,r>>>0}(Buffer.from(this),e)},"%String%.isString(...)":e=>"string"==typeof e||e instanceof String,"%Boolean%.isBoolean(...)":e=>"boolean"==typeof e||e instanceof Boolean,"%Number%.isNumber(...)":e=>"number"==typeof e||e instanceof Number},Pa={recursive:void 0,expandGlobs:!0,output:"-",outputTextEncoding:"utf8"};function za(e){const{api:t,name:r,usageAndBinding:n,defaults:i,summary:o,details:a}=function(e){const{api:t,name:r,idl:n,summary:i,details:o,...a}=qa(e,{extractName:!0});return{api:t,name:r,usageAndBinding:n,idl:n,summary:i,details:o,defaults:a}}(e),s=new te(n),l=Ho(s,r),p=Ti.from(s);Object.defineProperty(p,"output",{get:()=>{throw new Error("Acccessed binding.output")}}),p.remapGlobals("$-",_a);const c=va(l,i,p.globalsWithLiteralDefaults(),p.inlineOptions);let u="[(--cwd|-C)=DIR] [(--help|-h)]";p.void||(u+=" [(--output|-o)=FILE]",u+=" [--output-format=STR] [--output-text-encoding=(utf8|ucs2)]\n[--output-mimetype=STR] -- Set the mimetype. Only neede for pipes. Will normally be defaulted by `--output-format` and shouldn't be override.\n"),function(e){if(!e.hasRecurringPositional())return!1;const t=e.getRecurringPositionalType();return"File"===t.name||"(Dir|File)"===t.name}(c)&&(u+=" [(--recurse|-R)] [--no-recurse] [(--exclude|-X)=GLOB_TEXT]...");const d=p.globals,{usesInput:f,inputVariable:m,inputOptions:h}=function(e,t){const r=e.has(_a),n=r?_a:"";let i="";return r&&(t.hasKey(_a)||(i="[--input=FILE]")),{usesInput:!!r,inputVariable:n,inputOptions:i}}(d,c);p.usesInput=f,h&&(u+=" "+h);const g=c.addOptions(ma.fromOptionsOnly(u,"platform",i,p.globalsWithLiteralDefaults()));!function(e){if(!e.hasKey(_a))return;const t=e.getNamedOptionFromKey(_a),{mandatory:r,optionName:n,defaultValue:i,defaultText:o}=t;console.assert(void 0===i,"--input should never have a value default",i),console.assert(void 0===o,"--input should never have a text default"),void 0===t.defaultText&&(t.defaultText=Mi)}(g),function(e,t){for(const{key:r,platform:n}of t)if(!e.has(r)&&!n)throw new TypeError(`arg ${JSON.stringify(r)} left unbound`)}(d,g.enumAllOptions());const y=function(e){for(const t of e.enumPositionalTypes())if(t.realiseStdioAs)return!0;return!1}(g);return{api:t,name:r,binding:p,inputVariable:m,summary:o??"",details:a,platformOptions:u,hasStdinReplaceables:y,hasStdoutReplaceables:!p.void,userSuppliedDefaults:i,usageObject:g}}function Ba(e,t={}){const r=Ti.from(new te(e)),n=Object.assign({},Pa,Jr,Ca,Ma,t),{name:i,args:o,result:a}=function(e,t,r,n=!0,i){return{name:void 0,args:xi(e,t,r,n,i),resultTypeAssertion:e.cast}}(r,new Map(Object.entries(n)));return{name:i,args:o}}function Fa(e){return"function"!=typeof e?e:"string"==typeof e.name&&""!==e.name?{default:e,[e.name]:e}:{default:e}}function Va(e,t,r=!1){if("string"==typeof e||"symbol"==typeof e){const r=t[e];return"function"==typeof r?{[e]:r}:null}if(Array.isArray(e)){const n={};for(const i of e){if(!Object.hasOwn(t,i)){if(!r)return null;throw new Error(`Module doesn't have an export called ${JSON.stringify(i)}`)}n[i]=t[i]}return n}throw new TypeError("Invalid imports in binding")}class Ja{#ce;get text(){return this.#ce}#ue;#V;#o;inputVariable;summary;details;get platformOptions(){throw new Error("Platform options not supported any more")}globalDefaults=null;hasStdinReplaceables;hasStdoutReplaceables;userSuppliedDefaults;__dirname;get name(){return this.#o}constructor(e,t={},r){if(e instanceof Ja)throw new TypeError("Copy!");if("string"!=typeof e)throw new TypeError("IDL should be string now");const n=function(e){try{return e?u(new URL(".",e)):void 0}catch{}}(r),{api:i,name:o,binding:a,inputVariable:s,summary:l,details:p,platformOptions:c,hasStdinReplaceables:d,hasStdoutReplaceables:f,userSuppliedDefaults:m,usageObject:h}=za(e);if(-1!==i&&1!==i)throw void 0===i?new TypeError("Module's js-hell declaration is invalid (it's missing an `api` key)"):"number"!=typeof i?new TypeError("Module's js-hell declaration is invalid (the `api` key must be a number)"):new TypeError(`Module uses an unsupported API version (version 1 is required, but script is version ${i})`);Object.assign(this,{summary:l,details:p,globalDefaults:t,hasStdinReplaceables:d,hasStdoutReplaceables:f,userSuppliedDefaults:m,inputVariable:s,__dirname:n}),this.#ce=e,this.#ue=a,this.#V=h,this.#o=o}validateModule(e){return!!Va(this.#ue.imports,Fa(e))}getDefaults({stdout:e=process.stdout,stdin:t=process.stdin,cwd:r=process.cwd(),globalDefaults:n={}}={}){const i=new Ra(t,e),{globalDefaults:o,userSuppliedDefaults:a,__dirname:s}=this;return{...Pa,...a,...Jr,...Ca,...Ma,...o,...n,cwd:br.fromFullPath(r),output:i,"$-":i,input:t,__dirname:"string"==typeof s&&s?br.fromFullPath(s):void 0}}createLexicalEnvironment(e){return new io(this.#V,this.getDefaults(e))}getUsage(e="",t={}){return""===e?this.#V:this.#V.addOptions(ma.fromOptionsOnly(e,"host")).addOperators(t)}getOptionConflicts(e){return this.#V.getConflictingOptions(ma.fromOptionsOnly(e,"host"))}parseOptions(e,t=""){return this.getUsage(t).parseOptions(e)}async _exec(e,t,r={}){const n=this.createLexicalEnvironment(r);n.appendParsedOptions(this.parseOptions(Gi(t)));const i=n.finalise();return{result:await this._exec1(e,i,r),_rawDictionary:i}}async _execParsed(e,t,r={}){const n=this.createLexicalEnvironment(r);n.appendParsedOptions(this.parseOptions(t));const i=n.finalise();return this._exec1(e,i,r)}async _exec1(e,t,{brk:r=!1,inspect:n=!1}={}){const i=this.#ue,o=Fa(e),a=Va(i.name,o,!0);if(!a)throw new TypeError("Module's entry point is missing or not a function");return(n||r)&&await import("node:inspector"),i.exec(new Map(Object.entries(t)),a,{legacyBrk:r})}toString(){return this.#ce}isInputUsed(){return""!==this.inputVariable}inputUsedWithMethodCall(){const e=this.#ue.getGlobal(this.inputVariable);return e&&0===e.othersCount?e.methods:null}canGuaranteeNoOuput(){return this.#ue.void}getResultType(){return this.#ue.cast}getCliMap(){return this.#V.getCliMap()}getPositionalList(){return this.#V.enumPositionalAstNodesExcluding$0()}addTail(){this.#V.addTail()}isValidGashUsage(){return!this.#ue.imports.includes("gash")||!this.#ue.isWith&&function(e,{await:t=!1}={}){if(e.type===we&&t){if(e.op!==Ae)return!1;e=e.object}return e.type===ge}(this.#ue.astNode,{await:!0})}}const Wa="gash",Ga="js_hell",Ha=Wa,Ka=Ga,Xa="js-hell",Za=Ha,Ya="Invalid IDL";function Qa(e){if("string"!=typeof e&&("object"!=typeof e||!e))return;const t=new URL(e);if("file:"!==t.protocol)return;const r=m(t,{throwIfNewEntry:!1});if(!r)return;return new Date(r.mtimeMs).toISOString()}function es(e){if(Object.hasOwn(e,Ha)){if("string"==typeof e[Ha])return e[Ha]}else if(Object.hasOwn(e,Ga)&&"string"==typeof e[Ga])return e[Ga]}class ts{#de;#fe;#ce;#me;#he;#ge;constructor(e,{module:t,moduleUrl:r,name:n,version:i=Qa(r)}){if(this.#de=r,this.#fe=t,Array.isArray(e)&&(e=ca(e,(e=>{if("string"!=typeof e)throw new TypeError(Ya);return e}),"\n")),"string"!=typeof e)throw new TypeError(Ya);if(this.#ce=e,void 0===n){const e=new URL(this.#de);if(e.hash)this.#he=e.hash.slice(1);else{const t=e.pathname;this.#he=S(t,A(t))}}else{if("string"!=typeof n)throw new TypeError("Invalid `name`");this.#he=n}this.#ge=i}get moduleUrl(){return this.#de}get api(){throw new TypeError("Not implemented")}get summary(){throw new TypeError("Not implemented")}get details(){throw new TypeError("Not implemented")}get defaults(){throw new TypeError("Not implemented")}get idlText(){const e=this.#ce;if(!function(e){return"*"===e}(e))return e;const t=this.#fe;if(void 0===t)throw new TypeError("module not loaded");if("object"!=typeof t||!this.#fe)throw new TypeError("invalid module (not an object)");const r=es(t);if("string"==typeof r)return r;throw new Error(`invalid module (missing \`export ${Ha}\`)`)}get idl(){if(void 0!==this.#me)return this.#me;const{idlText:e}=this;if(this.#me=new Ja(e,void 0,this.#de),this.#me.name!==this.#he&&this.#me.name!==H)throw new TypeError("Name mismatch"+U`: expected the module name (${this.#he}) to match the IDL name (${this.#me.name})`);return this.#me}get name(){return this.#he}get version(){return this.#ge}async importModule(){if(!this.#fe){const e=new URL(this.#de);"about:"===e.protocol&&"blankjs"===e.pathname?this.#fe=Object.create(null):(e.hash="",this.#fe=await import(e))}return this.#fe}static from(e,t,r=void 0,n){return new ts(e,{module:r,moduleUrl:t,name:n})}static async fromModuleUrl(e,t,r=void 0){const n=new URL(e,t).toString(),i=await import(n);return ts.from("*",n,i,r)}}function rs(t,r=".",{relative:n=!0}={}){const i=r;for(r=e.resolve(r);;){if(E(e.join(r,t)))return n?e.relative(i,r)||".":r;const o=e.parse(r);if(""===o.dir||o.dir===o.root)return"";r=e.join(r,"..")}}var ns=Object.freeze({__proto__:null,default:rs});const is=Symbol;class os{#o;#ye;#ve;get name(){return this.#o}get type(){return"catalogue"}isRunnable(){return!0}get source(){return this.#ve}get value(){return this.toScriptlet()}async exec(e,t){const r=this.#ye.find((([t])=>t===e));if(!r)throw new Error(U`No such sub command ${e}`);const n=r[1],i=await n.importModule(),o=[{type:"$n",value:n.idl.name,info:""},...t],a=fr().lexicalEnvironmentOptions;return n.idl._execParsed(i,o,a)}constructor(e,t,r,n){if(e!==is)throw new Error("Illegal invocation");this.#o=t,this.#ye=r,this.#ve=n}toScriptlet(){const e=this.#ye.map((([e])=>e)).join("|"),t=new ts(`IDL=1 $0 (${e}) :: default( $1, $2 )`,{name:this.#o,module:{default:(e,t)=>this.exec(e,t)}});return t.idl.addTail(),t}static fromPackageTree(e,{url:t,name:r}){const n=e.getOwnScriptletEntries(t);if(0===n.length)throw new Error("Package has no scriptlets");return new os(is,r,n,t)}static async fromScriptlets(e,{name:t,source:r}){if(0===e.length)throw new Error("Package has no scriptlets");return new os(is,t,e.map((e=>[e.name,e])),r)}}const as="IDL=1 $0 :: default( $1, {cwd} )";var ss=Object.freeze({__proto__:null,default:function(e,t={}){throw new Error("Shouldn't be reachable")},js_hell:as});const ls={Tab:"\t",NewLine:"\n",DownBreve:" ",tdot:" ",TripleDot:" ",DotDot:" ",excl:"!",quot:'"',QUOT:'"',num:"#",dollar:"$",percnt:"%",amp:"&",AMP:"&",apos:"'",lpar:"(",rpar:")",ast:"*",midast:"*",plus:"+",comma:",",period:".",sol:"/",colon:":",semi:";",lt:"<",LT:"<",nvlt:"<",equals:"=",bne:"=",gt:">",GT:">",nvgt:">",quest:"?",commat:"@",lsqb:"[",lbrack:"[",bsol:"\\",rsqb:"]",rbrack:"]",Hat:"^",lowbar:"_",UnderBar:"_",grave:"`",DiacriticalGrave:"`",fjlig:"fj",lcub:"{",lbrace:"{",verbar:"|",vert:"|",VerticalLine:"|",rcub:"}",rbrace:"}",nbsp:"",NonBreakingSpace:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",Dot:"",die:"",DoubleDot:"",copy:"",COPY:"",ordf:"",laquo:"",not:"",shy:"",reg:"",circledR:"",REG:"",macr:"",strns:"",deg:"",plusmn:"",pm:"",PlusMinus:"",sup2:"",sup3:"",acute:"",DiacriticalAcute:"",micro:"",para:"",middot:"",centerdot:"",CenterDot:"",cedil:"",Cedilla:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",half:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",angst:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",div:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",Amacr:"",amacr:"",Abreve:"",abreve:"",Aogon:"",aogon:"",Cacute:"",cacute:"",Ccirc:"",ccirc:"",Cdot:"",cdot:"",Ccaron:"",ccaron:"",Dcaron:"",dcaron:"",Dstrok:"",dstrok:"",Emacr:"",emacr:"",Edot:"",edot:"",Eogon:"",eogon:"",Ecaron:"",ecaron:"",Gcirc:"",gcirc:"",Gbreve:"",gbreve:"",Gdot:"",gdot:"",Gcedil:"",Hcirc:"",hcirc:"",Hstrok:"",hstrok:"",Itilde:"",itilde:"",Imacr:"",imacr:"",Iogon:"",iogon:"",Idot:"",inodot:"",imath:"",IJlig:"",ijlig:"",Jcirc:"",jcirc:"",Kcedil:"",kcedil:"",kgreen:"",Lacute:"",lacute:"",Lcedil:"",lcedil:"",Lcaron:"",lcaron:"",Lmidot:"",lmidot:"",Lstrok:"",lstrok:"",Nacute:"",nacute:"",Ncedil:"",ncedil:"",Ncaron:"",ncaron:"",napos:"",ENG:"",eng:"",Omacr:"",omacr:"",Odblac:"",odblac:"",OElig:"",oelig:"",Racute:"",racute:"",Rcedil:"",rcedil:"",Rcaron:"",rcaron:"",Sacute:"",sacute:"",Scirc:"",scirc:"",Scedil:"",scedil:"",Scaron:"",scaron:"",Tcedil:"",tcedil:"",Tcaron:"",tcaron:"",Tstrok:"",tstrok:"",Utilde:"",utilde:"",Umacr:"",umacr:"",Ubreve:"",ubreve:"",Uring:"",uring:"",Udblac:"",udblac:"",Uogon:"",uogon:"",Wcirc:"",wcirc:"",Ycirc:"",ycirc:"",Yuml:"",Zacute:"",zacute:"",Zdot:"",zdot:"",Zcaron:"",zcaron:"",fnof:"",imped:"",gacute:"",jmath:"",circ:"",caron:"",Hacek:"",breve:"",Breve:"",dot:"",DiacriticalDot:"",ring:"",ogon:"",tilde:"",DiacriticalTilde:"",dblac:"",DiacriticalDoubleAcute:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",ohm:"",alpha:"",beta:"",gamma:"",delta:"",epsi:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmav:"",varsigma:"",sigmaf:"",sigma:"",tau:"",upsi:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetav:"",vartheta:"",thetasym:"",Upsi:"",upsih:"",phiv:"",straightphi:"",varphi:"",piv:"",varpi:"",Gammad:"",gammad:"",digamma:"",kappav:"",varkappa:"",rhov:"",varrho:"",epsiv:"",varepsilon:"",straightepsilon:"",bepsi:"",backepsilon:"",IOcy:"",DJcy:"",GJcy:"",Jukcy:"",DScy:"",Iukcy:"",YIcy:"",Jsercy:"",LJcy:"",NJcy:"",TSHcy:"",KJcy:"",Ubrcy:"",DZcy:"",Acy:"",Bcy:"",Vcy:"",Gcy:"",Dcy:"",IEcy:"",ZHcy:"",Zcy:"",Icy:"",Jcy:"",Kcy:"",Lcy:"",Mcy:"",Ncy:"",Ocy:"",Pcy:"",Rcy:"",Scy:"",Tcy:"",Ucy:"",Fcy:"",KHcy:"",TScy:"",CHcy:"",SHcy:"",SHCHcy:"",HARDcy:"",Ycy:"",SOFTcy:"",Ecy:"",YUcy:"",YAcy:"",acy:"",bcy:"",vcy:"",gcy:"",dcy:"",iecy:"",zhcy:"",zcy:"",icy:"",jcy:"",kcy:"",lcy:"",mcy:"",ncy:"",ocy:"",pcy:"",rcy:"",scy:"",tcy:"",ucy:"",fcy:"",khcy:"",tscy:"",chcy:"",shcy:"",shchcy:"",hardcy:"",ycy:"",softcy:"",ecy:"",yucy:"",yacy:"",iocy:"",djcy:"",gjcy:"",jukcy:"",dscy:"",iukcy:"",yicy:"",jsercy:"",ljcy:"",njcy:"",tshcy:"",kjcy:"",ubrcy:"",dzcy:"",ensp:"",emsp:"",emsp13:"",emsp14:"",numsp:"",puncsp:"",thinsp:"",ThinSpace:"",hairsp:"",VeryThinSpace:"",ZeroWidthSpace:"",NegativeVeryThinSpace:"",NegativeThinSpace:"",NegativeMediumSpace:"",NegativeThickSpace:"",zwnj:"",zwj:"",lrm:"",rlm:"",hyphen:"",dash:"",ndash:"",mdash:"",horbar:"",Verbar:"",Vert:"",lsquo:"",OpenCurlyQuote:"",rsquo:"",rsquor:"",CloseCurlyQuote:"",sbquo:"",lsquor:"",ldquo:"",OpenCurlyDoubleQuote:"",rdquo:"",rdquor:"",CloseCurlyDoubleQuote:"",bdquo:"",ldquor:"",dagger:"",Dagger:"",ddagger:"",bull:"",bullet:"",nldr:"",hellip:"",mldr:"",permil:"",pertenk:"",prime:"",Prime:"",tprime:"",bprime:"",backprime:"",lsaquo:"",rsaquo:"",oline:"",OverBar:"",caret:"",hybull:"",frasl:"",bsemi:"",qprime:"",MediumSpace:"",ThickSpace:"",NoBreak:"",ApplyFunction:"",af:"",InvisibleTimes:"",it:"",InvisibleComma:"",ic:"",euro:"",Copf:"",complexes:"",incare:"",gscr:"",hamilt:"",HilbertSpace:"",Hscr:"",Hfr:"",Poincareplane:"",Hopf:"",quaternions:"",planckh:"",planck:"",hbar:"",plankv:"",hslash:"",Iscr:"",imagline:"",image:"",Im:"",imagpart:"",Ifr:"",Lscr:"",lagran:"",Laplacetrf:"",ell:"",Nopf:"",naturals:"",numero:"",copysr:"",weierp:"",wp:"",Popf:"",primes:"",Qopf:"",rationals:"",Rscr:"",realine:"",real:"",Re:"",realpart:"",Rfr:"",Ropf:"",reals:"",rx:"",trade:"",TRADE:"",Zopf:"",integers:"",mho:"",Zfr:"",zeetrf:"",iiota:"",bernou:"",Bernoullis:"",Bscr:"",Cfr:"",Cayleys:"",escr:"",Escr:"",expectation:"",Fscr:"",Fouriertrf:"",phmmat:"",Mellintrf:"",Mscr:"",order:"",orderof:"",oscr:"",alefsym:"",aleph:"",beth:"",gimel:"",daleth:"",CapitalDifferentialD:"",DD:"",DifferentialD:"",dd:"",ExponentialE:"",exponentiale:"",ee:"",ImaginaryI:"",ii:"",frac13:"",frac23:"",frac15:"",frac25:"",frac35:"",frac45:"",frac16:"",frac56:"",frac18:"",frac38:"",frac58:"",frac78:"",larr:"",leftarrow:"",LeftArrow:"",slarr:"",ShortLeftArrow:"",uarr:"",uparrow:"",UpArrow:"",ShortUpArrow:"",rarr:"",rightarrow:"",RightArrow:"",srarr:"",ShortRightArrow:"",darr:"",downarrow:"",DownArrow:"",ShortDownArrow:"",harr:"",leftrightarrow:"",LeftRightArrow:"",varr:"",updownarrow:"",UpDownArrow:"",nwarr:"",UpperLeftArrow:"",nwarrow:"",nearr:"",UpperRightArrow:"",nearrow:"",searr:"",searrow:"",LowerRightArrow:"",swarr:"",swarrow:"",LowerLeftArrow:"",nlarr:"",nleftarrow:"",nrarr:"",nrightarrow:"",rarrw:"",rightsquigarrow:"",nrarrw:"",Larr:"",twoheadleftarrow:"",Uarr:"",Rarr:"",twoheadrightarrow:"",Darr:"",larrtl:"",leftarrowtail:"",rarrtl:"",rightarrowtail:"",LeftTeeArrow:"",mapstoleft:"",UpTeeArrow:"",mapstoup:"",map:"",RightTeeArrow:"",mapsto:"",DownTeeArrow:"",mapstodown:"",larrhk:"",hookleftarrow:"",rarrhk:"",hookrightarrow:"",larrlp:"",looparrowleft:"",rarrlp:"",looparrowright:"",harrw:"",leftrightsquigarrow:"",nharr:"",nleftrightarrow:"",lsh:"",Lsh:"",rsh:"",Rsh:"",ldsh:"",rdsh:"",crarr:"",cularr:"",curvearrowleft:"",curarr:"",curvearrowright:"",olarr:"",circlearrowleft:"",orarr:"",circlearrowright:"",lharu:"",LeftVector:"",leftharpoonup:"",lhard:"",leftharpoondown:"",DownLeftVector:"",uharr:"",upharpoonright:"",RightUpVector:"",uharl:"",upharpoonleft:"",LeftUpVector:"",rharu:"",RightVector:"",rightharpoonup:"",rhard:"",rightharpoondown:"",DownRightVector:"",dharr:"",RightDownVector:"",downharpoonright:"",dharl:"",LeftDownVector:"",downharpoonleft:"",rlarr:"",rightleftarrows:"",RightArrowLeftArrow:"",udarr:"",UpArrowDownArrow:"",lrarr:"",leftrightarrows:"",LeftArrowRightArrow:"",llarr:"",leftleftarrows:"",uuarr:"",upuparrows:"",rrarr:"",rightrightarrows:"",ddarr:"",downdownarrows:"",lrhar:"",ReverseEquilibrium:"",leftrightharpoons:"",rlhar:"",rightleftharpoons:"",Equilibrium:"",nlArr:"",nLeftarrow:"",nhArr:"",nLeftrightarrow:"",nrArr:"",nRightarrow:"",lArr:"",Leftarrow:"",DoubleLeftArrow:"",uArr:"",Uparrow:"",DoubleUpArrow:"",rArr:"",Rightarrow:"",Implies:"",DoubleRightArrow:"",dArr:"",Downarrow:"",DoubleDownArrow:"",hArr:"",Leftrightarrow:"",DoubleLeftRightArrow:"",iff:"",vArr:"",Updownarrow:"",DoubleUpDownArrow:"",nwArr:"",neArr:"",seArr:"",swArr:"",lAarr:"",Lleftarrow:"",rAarr:"",Rrightarrow:"",zigrarr:"",larrb:"",LeftArrowBar:"",rarrb:"",RightArrowBar:"",duarr:"",DownArrowUpArrow:"",loarr:"",roarr:"",hoarr:"",forall:"",ForAll:"",comp:"",complement:"",part:"",PartialD:"",npart:"",exist:"",Exists:"",nexist:"",NotExists:"",nexists:"",empty:"",emptyset:"",emptyv:"",varnothing:"",nabla:"",Del:"",isin:"",isinv:"",Element:"",in:"",notin:"",NotElement:"",notinva:"",niv:"",ReverseElement:"",ni:"",SuchThat:"",notni:"",notniva:"",NotReverseElement:"",prod:"",Product:"",coprod:"",Coproduct:"",sum:"",Sum:"",minus:"",mnplus:"",mp:"",MinusPlus:"",plusdo:"",dotplus:"",setmn:"",setminus:"",Backslash:"",ssetmn:"",smallsetminus:"",lowast:"",compfn:"",SmallCircle:"",radic:"",Sqrt:"",prop:"",propto:"",Proportional:"",vprop:"",varpropto:"",infin:"",angrt:"",ang:"",angle:"",nang:"",angmsd:"",measuredangle:"",angsph:"",mid:"",VerticalBar:"",smid:"",shortmid:"",nmid:"",NotVerticalBar:"",nsmid:"",nshortmid:"",par:"",parallel:"",DoubleVerticalBar:"",spar:"",shortparallel:"",npar:"",nparallel:"",NotDoubleVerticalBar:"",nspar:"",nshortparallel:"",and:"",wedge:"",or:"",vee:"",cap:"",caps:"",cup:"",cups:"",int:"",Integral:"",Int:"",tint:"",iiint:"",conint:"",oint:"",ContourIntegral:"",Conint:"",DoubleContourIntegral:"",Cconint:"",cwint:"",cwconint:"",ClockwiseContourIntegral:"",awconint:"",CounterClockwiseContourIntegral:"",there4:"",therefore:"",Therefore:"",becaus:"",because:"",Because:"",ratio:"",Colon:"",Proportion:"",minusd:"",dotminus:"",mDDot:"",homtht:"",sim:"",Tilde:"",thksim:"",thicksim:"",nvsim:"",bsim:"",backsim:"",race:"",ac:"",mstpos:"",acE:"",acd:"",wreath:"",VerticalTilde:"",wr:"",nsim:"",NotTilde:"",esim:"",EqualTilde:"",eqsim:"",nesim:"",NotEqualTilde:"",sime:"",TildeEqual:"",simeq:"",nsime:"",nsimeq:"",NotTildeEqual:"",cong:"",TildeFullEqual:"",simne:"",ncong:"",NotTildeFullEqual:"",asymp:"",ap:"",TildeTilde:"",approx:"",thkap:"",thickapprox:"",nap:"",NotTildeTilde:"",napprox:"",ape:"",approxeq:"",apid:"",napid:"",bcong:"",backcong:"",asympeq:"",CupCap:"",nvap:"",bump:"",HumpDownHump:"",Bumpeq:"",nbump:"",NotHumpDownHump:"",bumpe:"",HumpEqual:"",bumpeq:"",nbumpe:"",NotHumpEqual:"",esdot:"",DotEqual:"",doteq:"",nedot:"",eDot:"",doteqdot:"",efDot:"",fallingdotseq:"",erDot:"",risingdotseq:"",colone:"",coloneq:"",Assign:"",ecolon:"",eqcolon:"",ecir:"",eqcirc:"",cire:"",circeq:"",wedgeq:"",veeeq:"",trie:"",triangleq:"",equest:"",questeq:"",ne:"",NotEqual:"",equiv:"",Congruent:"",bnequiv:"",nequiv:"",NotCongruent:"",le:"",leq:"",nvle:"",ge:"",GreaterEqual:"",geq:"",nvge:"",lE:"",LessFullEqual:"",leqq:"",nlE:"",nleqq:"",gE:"",GreaterFullEqual:"",geqq:"",ngE:"",ngeqq:"",NotGreaterFullEqual:"",lnE:"",lneqq:"",lvnE:"",lvertneqq:"",gnE:"",gneqq:"",gvnE:"",gvertneqq:"",Lt:"",NestedLessLess:"",ll:"",nLtv:"",NotLessLess:"",nLt:"",Gt:"",NestedGreaterGreater:"",gg:"",nGtv:"",NotGreaterGreater:"",nGt:"",twixt:"",between:"",NotCupCap:"",nlt:"",NotLess:"",nless:"",ngt:"",NotGreater:"",ngtr:"",nle:"",NotLessEqual:"",nleq:"",nge:"",NotGreaterEqual:"",ngeq:"",lsim:"",LessTilde:"",lesssim:"",gsim:"",gtrsim:"",GreaterTilde:"",nlsim:"",NotLessTilde:"",ngsim:"",NotGreaterTilde:"",lg:"",lessgtr:"",LessGreater:"",gl:"",gtrless:"",GreaterLess:"",ntlg:"",NotLessGreater:"",ntgl:"",NotGreaterLess:"",pr:"",Precedes:"",prec:"",sc:"",Succeeds:"",succ:"",prcue:"",PrecedesSlantEqual:"",preccurlyeq:"",sccue:"",SucceedsSlantEqual:"",succcurlyeq:"",prsim:"",precsim:"",PrecedesTilde:"",scsim:"",succsim:"",SucceedsTilde:"",NotSucceedsTilde:"",npr:"",nprec:"",NotPrecedes:"",nsc:"",nsucc:"",NotSucceeds:"",sub:"",subset:"",vnsub:"",NotSubset:"",nsubset:"",sup:"",supset:"",Superset:"",vnsup:"",NotSuperset:"",nsupset:"",nsub:"",nsup:"",sube:"",SubsetEqual:"",subseteq:"",supe:"",supseteq:"",SupersetEqual:"",nsube:"",nsubseteq:"",NotSubsetEqual:"",nsupe:"",nsupseteq:"",NotSupersetEqual:"",subne:"",subsetneq:"",vsubne:"",varsubsetneq:"",supne:"",supsetneq:"",vsupne:"",varsupsetneq:"",cupdot:"",uplus:"",UnionPlus:"",sqsub:"",SquareSubset:"",sqsubset:"",NotSquareSubset:"",sqsup:"",SquareSuperset:"",sqsupset:"",NotSquareSuperset:"",sqsube:"",SquareSubsetEqual:"",sqsubseteq:"",sqsupe:"",SquareSupersetEqual:"",sqsupseteq:"",sqcap:"",SquareIntersection:"",sqcaps:"",sqcup:"",SquareUnion:"",sqcups:"",oplus:"",CirclePlus:"",ominus:"",CircleMinus:"",otimes:"",CircleTimes:"",osol:"",odot:"",CircleDot:"",ocir:"",circledcirc:"",oast:"",circledast:"",odash:"",circleddash:"",plusb:"",boxplus:"",minusb:"",boxminus:"",timesb:"",boxtimes:"",sdotb:"",dotsquare:"",vdash:"",RightTee:"",dashv:"",LeftTee:"",top:"",DownTee:"",bottom:"",bot:"",perp:"",UpTee:"",models:"",vDash:"",DoubleRightTee:"",Vdash:"",Vvdash:"",VDash:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",prurel:"",vltri:"",vartriangleleft:"",LeftTriangle:"",vrtri:"",vartriangleright:"",RightTriangle:"",ltrie:"",trianglelefteq:"",LeftTriangleEqual:"",nvltrie:"",rtrie:"",trianglerighteq:"",RightTriangleEqual:"",nvrtrie:"",origof:"",imof:"",mumap:"",multimap:"",hercon:"",intcal:"",intercal:"",veebar:"",barvee:"",angrtvb:"",lrtri:"",xwedge:"",Wedge:"",bigwedge:"",xvee:"",Vee:"",bigvee:"",xcap:"",Intersection:"",bigcap:"",xcup:"",Union:"",bigcup:"",diam:"",diamond:"",Diamond:"",sdot:"",sstarf:"",Star:"",divonx:"",divideontimes:"",bowtie:"",ltimes:"",rtimes:"",lthree:"",leftthreetimes:"",rthree:"",rightthreetimes:"",bsime:"",backsimeq:"",cuvee:"",curlyvee:"",cuwed:"",curlywedge:"",Sub:"",Subset:"",Sup:"",Supset:"",Cap:"",Cup:"",fork:"",pitchfork:"",epar:"",ltdot:"",lessdot:"",gtdot:"",gtrdot:"",Ll:"",nLl:"",Gg:"",ggg:"",nGg:"",leg:"",LessEqualGreater:"",lesseqgtr:"",lesg:"",gel:"",gtreqless:"",GreaterEqualLess:"",gesl:"",cuepr:"",curlyeqprec:"",cuesc:"",curlyeqsucc:"",nprcue:"",NotPrecedesSlantEqual:"",nsccue:"",NotSucceedsSlantEqual:"",nsqsube:"",NotSquareSubsetEqual:"",nsqsupe:"",NotSquareSupersetEqual:"",lnsim:"",gnsim:"",prnsim:"",precnsim:"",scnsim:"",succnsim:"",nltri:"",ntriangleleft:"",NotLeftTriangle:"",nrtri:"",ntriangleright:"",NotRightTriangle:"",nltrie:"",ntrianglelefteq:"",NotLeftTriangleEqual:"",nrtrie:"",ntrianglerighteq:"",NotRightTriangleEqual:"",vellip:"",ctdot:"",utdot:"",dtdot:"",disin:"",isinsv:"",isins:"",isindot:"",notindot:"",notinvc:"",notinvb:"",isinE:"",notinE:"",nisd:"",xnis:"",nis:"",notnivc:"",notnivb:"",barwed:"",barwedge:"",Barwed:"",doublebarwedge:"",lceil:"",LeftCeiling:"",rceil:"",RightCeiling:"",lfloor:"",LeftFloor:"",rfloor:"",RightFloor:"",drcrop:"",dlcrop:"",urcrop:"",ulcrop:"",bnot:"",profline:"",profsurf:"",telrec:"",target:"",ulcorn:"",ulcorner:"",urcorn:"",urcorner:"",dlcorn:"",llcorner:"",drcorn:"",lrcorner:"",frown:"",sfrown:"",smile:"",ssmile:"",cylcty:"",profalar:"",topbot:"",ovbar:"",solbar:"",".mw-parser-outpu":"","vanchor>:target~.vanchor-text{background-color:#b1d2ff}@medi":"","creen{html.skin-theme-clientpref-nigh":"","mw-parser-outpu":"","vanchor>:target~.vanchor-text{background-color:#0f4dc9}}@medi":"",cree:"",n:"","prefers-color-scheme:dark){html.skin-theme-clientpref-o":"","mw-parser-outpu":"","vanchor>:target~.vanchor-text{background-color:#0f4dc9}}angzarr":"",lmoust:"",lmoustache:"",rmoust:"",rmoustache:"",tbrk:"",OverBracket:"",bbrk:"",UnderBracket:"",bbrktbrk:"",OverParenthesis:"",UnderParenthesis:"",OverBrace:"",UnderBrace:"",trpezium:"",elinters:"",blank:"",oS:"",circledS:"",boxh:"",HorizontalLine:"",boxv:"",boxdr:"",boxdl:"",boxur:"",boxul:"",boxvr:"",boxvl:"",boxhd:"",boxhu:"",boxvh:"",boxH:"",boxV:"",boxdR:"",boxDr:"",boxDR:"",boxdL:"",boxDl:"",boxDL:"",boxuR:"",boxUr:"",boxUR:"",boxuL:"",boxUl:"",boxUL:"",boxvR:"",boxVr:"",boxVR:"",boxvL:"",boxVl:"",boxVL:"",boxHd:"",boxhD:"",boxHD:"",boxHu:"",boxhU:"",boxHU:"",boxvH:"",boxVh:"",boxVH:"",uhblk:"",lhblk:"",block:"",blk14:"",blk12:"",blk34:"",squ:"",square:"",Square:"",squf:"",squarf:"",blacksquare:"",FilledVerySmallSquare:"",EmptyVerySmallSquare:"",rect:"",marker:"",fltns:"",xutri:"",bigtriangleup:"",utrif:"",blacktriangle:"",utri:"",triangle:"",rtrif:"",blacktriangleright:"",rtri:"",triangleright:"",xdtri:"",bigtriangledown:"",dtrif:"",blacktriangledown:"",dtri:"",triangledown:"",ltrif:"",blacktriangleleft:"",ltri:"",triangleleft:"",loz:"",lozenge:"",cir:"",tridot:"",xcirc:"",bigcirc:"",ultri:"",urtri:"",lltri:"",EmptySmallSquare:"",FilledSmallSquare:"",starf:"",bigstar:"",star:"",phone:"",female:"",male:"",spades:"",spadesuit:"",clubs:"",clubsuit:"",hearts:"",heartsuit:"",diams:"",diamondsuit:"",sung:"",flat:"",natur:"",natural:"",sharp:"",check:"",checkmark:"",cross:"",malt:"",maltese:"",sext:"",VerticalSeparator:"",lbbrk:"",rbbrk:"",bsolhsub:"",suphsol:"",lobrk:"",LeftDoubleBracket:"",robrk:"",RightDoubleBracket:"",lang:"",LeftAngleBracket:"",langle:"",rang:"",RightAngleBracket:"",rangle:"",Lang:"",Rang:"",loang:"",roang:"",xlarr:"",longleftarrow:"",LongLeftArrow:"",xrarr:"",longrightarrow:"",LongRightArrow:"",xharr:"",longleftrightarrow:"",LongLeftRightArrow:"",xlArr:"",Longleftarrow:"",DoubleLongLeftArrow:"",xrArr:"",Longrightarrow:"",DoubleLongRightArrow:"",xhArr:"",Longleftrightarrow:"",DoubleLongLeftRightArrow:"",xmap:"",longmapsto:"",dzigrarr:"",nvlArr:"",nvrArr:"",nvHarr:"",Map:"",lbarr:"",rbarr:"",bkarow:"",lBarr:"",rBarr:"",dbkarow:"",RBarr:"",drbkarow:"",DDotrahd:"",UpArrowBar:"",DownArrowBar:"",Rarrtl:"",latail:"",ratail:"",lAtail:"",rAtail:"",larrfs:"",rarrfs:"",larrbfs:"",rarrbfs:"",nwarhk:"",nearhk:"",searhk:"",hksearow:"",swarhk:"",hkswarow:"",nwnear:"",nesear:"",toea:"",seswar:"",tosa:"",swnwar:"",rarrc:"",nrarrc:"",cudarrr:"",ldca:"",rdca:"",cudarrl:"",larrpl:"",curarrm:"",cularrp:"",rarrpl:"",harrcir:"",Uarrocir:"",lurdshar:"",ldrushar:"",LeftRightVector:"",RightUpDownVector:"",DownLeftRightVector:"",LeftUpDownVector:"",LeftVectorBar:"",RightVectorBar:"",RightUpVectorBar:"",RightDownVectorBar:"",DownLeftVectorBar:"",DownRightVectorBar:"",LeftUpVectorBar:"",LeftDownVectorBar:"",LeftTeeVector:"",RightTeeVector:"",RightUpTeeVector:"",RightDownTeeVector:"",DownLeftTeeVector:"",DownRightTeeVector:"",LeftUpTeeVector:"",LeftDownTeeVector:"",lHar:"",uHar:"",rHar:"",dHar:"",luruhar:"",ldrdhar:"",ruluhar:"",rdldhar:"",lharul:"",llhard:"",rharul:"",lrhard:"",udhar:"",UpEquilibrium:"",duhar:"",ReverseUpEquilibrium:"",RoundImplies:"",erarr:"",simrarr:"",larrsim:"",rarrsim:"",rarrap:"",ltlarr:"",gtrarr:"",subrarr:"",suplarr:"",lfisht:"",rfisht:"",ufisht:"",dfisht:"",lopar:"",ropar:"",lbrke:"",rbrke:"",lbrkslu:"",rbrksld:"",lbrksld:"",rbrkslu:"",langd:"",rangd:"",lparlt:"",rpargt:"",gtlPar:"",ltrPar:"",vzigzag:"",vangrt:"",angrtvbd:"",ange:"",range:"",dwangle:"",uwangle:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",bemptyv:"",demptyv:"",cemptyv:"",raemptyv:"",laemptyv:"",ohbar:"",omid:"",opar:"",operp:"",olcross:"",odsold:"",olcir:"",ofcir:"",olt:"",ogt:"",cirscir:"",cirE:"",solb:"",bsolb:"",boxbox:"",trisb:"",rtriltri:"",LeftTriangleBar:"",NotLeftTriangleBar:"",RightTriangleBar:"",NotRightTriangleBar:"",iinfin:"",infintie:"",nvinfin:"",eparsl:"",smeparsl:"",eqvparsl:"",lozf:"",blacklozenge:"",RuleDelayed:"",dsol:"",xodot:"",bigodot:"",xoplus:"",bigoplus:"",xotime:"",bigotimes:"",xuplus:"",biguplus:"",xsqcup:"",bigsqcup:"",qint:"",iiiint:"",fpartint:"",cirfnint:"",awint:"",rppolint:"",scpolint:"",npolint:"",pointint:"",quatint:"",intlarhk:"",pluscir:"",plusacir:"",simplus:"",plusdu:"",plussim:"",plustwo:"",mcomma:"",minusdu:"",loplus:"",roplus:"",Cross:"",timesd:"",timesbar:"",smashp:"",lotimes:"",rotimes:"",otimesas:"",Otimes:"",odiv:"",triplus:"",triminus:"",tritime:"",iprod:"",intprod:"",amalg:"",capdot:"",ncup:"",ncap:"",capand:"",cupor:"",cupcap:"",capcup:"",cupbrcap:"",capbrcup:"",cupcup:"",capcap:"",ccups:"",ccaps:"",ccupssm:"",And:"",Or:"",andand:"",oror:"",orslope:"",andslope:"",andv:"",orv:"",andd:"",ord:"",wedbar:"",sdote:"",simdot:"",congdot:"",ncongdot:"",easter:"",apacir:"",apE:"",napE:"",eplus:"",pluse:"",Esim:"",Colone:"",Equal:"",eDDot:"",ddotseq:"",equivDD:"",ltcir:"",gtcir:"",ltquest:"",gtquest:"",les:"",LessSlantEqual:"",leqslant:"",nles:"",nleqslant:"",NotLessSlantEqual:"",ges:"",GreaterSlantEqual:"",geqslant:"",nges:"",ngeqslant:"",NotGreaterSlantEqual:"",lesdot:"",gesdot:"",lesdoto:"",gesdoto:"",lesdotor:"",gesdotol:"",lap:"",lessapprox:"",gap:"",gtrapprox:"",lne:"",lneq:"",gne:"",gneq:"",lnap:"",lnapprox:"",gnap:"",gnapprox:"",lEg:"",lesseqqgtr:"",gEl:"",gtreqqless:"",lsime:"",gsime:"",lsimg:"",gsiml:"",lgE:"",glE:"",lesges:"",gesles:"",els:"",eqslantless:"",egs:"",eqslantgtr:"",elsdot:"",egsdot:"",el:"",eg:"",siml:"",simg:"",simlE:"",simgE:"",LessLess:"",NotNestedLessLess:"",GreaterGreater:"",NotNestedGreaterGreater:"",glj:"",gla:"",ltcc:"",gtcc:"",lescc:"",gescc:"",smt:"",lat:"",smte:"",smtes:"",late:"",lates:"",bumpE:"",pre:"",preceq:"",PrecedesEqual:"",npre:"",NotPrecedesEqual:"",npreceq:"",sce:"",succeq:"",SucceedsEqual:"",nsce:"",NotSucceedsEqual:"",nsucceq:"",prE:"",scE:"",prnE:"",precneqq:"",scnE:"",succneqq:"",prap:"",precapprox:"",scap:"",succapprox:"",prnap:"",precnapprox:"",scnap:"",succnapprox:"",Pr:"",Sc:"",subdot:"",supdot:"",subplus:"",supplus:"",submult:"",supmult:"",subedot:"",supedot:"",subE:"",subseteqq:"",nsubE:"",nsubseteqq:"",supE:"",supseteqq:"",nsupE:"",nsupseteqq:"",subsim:"",supsim:"",subnE:"",subsetneqq:"",vsubnE:"",varsubsetneqq:"",supnE:"",supsetneqq:"",vsupnE:"",varsupsetneqq:"",csub:"",csup:"",csube:"",csupe:"",subsup:"",supsub:"",subsub:"",supsup:"",suphsub:"",supdsub:"",forkv:"",topfork:"",mlcp:"",Dashv:"",DoubleLeftTee:"",Vdashl:"",Barv:"",vBar:"",vBarv:"",Vbar:"",Not:"",bNot:"",rnmid:"",cirmid:"",midcir:"",topcir:"",nhpar:"",parsim:"",parsl:"",nparsl:"",fflig:"",filig:"",fllig:"",ffilig:"",ffllig:"",Ascr:"",Cscr:"",Dscr:"",Gscr:"",Jscr:"",Kscr:"",Nscr:"",Oscr:"",Pscr:"",Qscr:"",Sscr:"",Tscr:"",Uscr:"",Vscr:"",Wscr:"",Xscr:"",Yscr:"",Zscr:"",ascr:"",bscr:"",cscr:"",dscr:"",fscr:"",hscr:"",iscr:"",jscr:"",kscr:"",lscr:"",mscr:"",nscr:"",pscr:"",qscr:"",rscr:"",sscr:"",tscr:"",uscr:"",vscr:"",wscr:"",xscr:"",yscr:"",zscr:"",Afr:"",Bfr:"",Dfr:"",Efr:"",Ffr:"",Gfr:"",Jfr:"",Kfr:"",Lfr:"",Mfr:"",Nfr:"",Ofr:"",Pfr:"",Qfr:"",Sfr:"",Tfr:"",Ufr:"",Vfr:"",Wfr:"",Xfr:"",Yfr:"",afr:"",bfr:"",cfr:"",dfr:"",efr:"",ffr:"",gfr:"",hfr:"",ifr:"",jfr:"",kfr:"",lfr:"",mfr:"",nfr:"",ofr:"",pfr:"",qfr:"",rfr:"",sfr:"",tfr:"",ufr:"",vfr:"",wfr:"",xfr:"",yfr:"",zfr:"",Aopf:"",Bopf:"",Dopf:"",Eopf:"",Fopf:"",Gopf:"",Iopf:"",Jopf:"",Kopf:"",Lopf:"",Mopf:"",Oopf:"",Sopf:"",Topf:"",Uopf:"",Vopf:"",Wopf:"",Xopf:"",Yopf:"",aopf:"",bopf:"",copf:"",dopf:"",eopf:"",fopf:"",gopf:"",hopf:"",iopf:"",jopf:"",kopf:"",lopf:"",mopf:"",nopf:"",oopf:"",popf:"",qopf:"",ropf:"",sopf:"",topf:"",uopf:"",vopf:"",wopf:"",xopf:"",yopf:"",zopf:""};function ps(e,t){if(!t)return e;const r=`${e.codePointAt(0).toString(16)}`;return r.length<=4?`U+${r.padStart(4,"0")}`:`U+${r.padStart(6,"0")}`}var cs=Object.freeze({__proto__:null,gash:"IDL=1\n-- Output characters either from U+xxxx notation or HTML entity names.\n--\n-- For example `char U+00BO` or `char deg` \nchar [--code] ENTITY_NAME...\n:: generateChar( $1, { code } )\n",generateChar:function(e,{code:t}){let r=[],n=[];for(const i of e){const e=i.trim();if(Object.hasOwn(ls,e)){r.push(ps(ls[e],t));continue}const o=/^U\+([0-9a-fA-F]{4,6})$/.exec(e)?.[1];if("string"!=typeof o)n.push(e);else{const i=parseInt(o,16);i<1114111?r.push(ps(String.fromCodePoint(i),t)):n.push(e)}}if(n.length)throw new Error("unknown characters "+n.map((e=>JSON.stringify(e))).join(" "));return r.join(t?" ":"")}});var us=Object.freeze({__proto__:null,default:function(e,t){console[e](t)},js_hell:'IDL=1    \n    -- Write a messge to the log. (i.e. call `console[LEVEL](TEXT)`)    \n    log [--level=(debug|log|info|error|warn)] TEXT     \n    :: default( level = "log", $1 )   '});async function ds(e=80){const{user:t,builtin:r,packageScripts:n}=await async function(){const e=new Sl;await e.addCwdPackageTree();const t=[],r=[],n=[];for(const i of e.packages()){const{name:e,type:o,source:a}=i;if(a===ul)t.push(e);else if(o===pl)n.push(e);else{const t=await i.isRunnable();t&&r.push(e+(t?"":""))}}return t.sort(((e,t)=>e.localeCompare(t))),r.sort(((e,t)=>e.localeCompare(t))),n.sort(((e,t)=>e.localeCompare(t))),{builtin:t,user:r,packageScripts:n}}();return{usage:"gash SCRIPTLET ...",summary:"",details:[...Nn(r,e,"builtins: "),...t.length?["",...Nn(t,e,"package:  ")]:[],...n.length?["",...Nn(n,e,"npm run:  ")]:[]],defaults:[]}}const fs="\n[--log=FILE]   -- Save `console.xxx()` messages to FILE, instead of writing them to stderr.\n[--stacktrace] -- Print a full stacktrace on error.\n",ms={">":"--output","<":"--input","2>":"--log"};var hs=Object.freeze({__proto__:null,default:async function(e=null,{helpStyle:t="hg",SCREEN_COLUMNS:r=80,externalName:n="$0"}={}){let i,o,a,s,l;if(e){const t=function(e,t=e.name){const r=e=>e.replaceAll(/\s*\r?\n\s*/g," ").trim();let n=t;const i=r(e.summary),o=e.details?e.details.map(((t,n)=>r(t)+(n<e.details.length-1?"\n":""))):[],a=[],s=e=>!e.isInline()&&e.platform,l=e.getUsage(fs),p=Array.from(l.enumAllOptions()),c=l.getCliMap();let u="",d=!1,f="";for(const e of p)if(s(e))f&&(f+=" "),f+="["+e.toBareUsage(c)+"]";else if(e.mandatory){const t=e.toBareUsage(c);u+=" "+t,e.annotation&&a.push("   "+t+": "+e.annotation)}else{d=!0;let t="   "+e.toBareUsage(c);e.annotation&&(t+=": "+e.annotation),void 0!==e.defaultValue?"boolean"!=typeof e.defaultValue&&(t+=" [DEFAULT: "+JSON.stringify(e.defaultValue)+"]"):void 0!==e.defaultText&&("symbol"!=typeof e.defaultText?t+=" [DEFAULT: "+JSON.stringify(e.defaultText)+"]":e.defaultText===Mi&&("input"===e.key?t+=" [DEFAULT: _stdin_]":"output"===e.key?t+=" [DEFAULT: _stdout_]":t+=" [DEFAULT: _file topic_]")),a.push(t)}return d&&(n+=" [OPTION]..."),n+=u,n+=" "+l.getPostionalString(),{usage:n,summary:i,details:o,options:a,defaults:[],extraOptions:f}}(e,"$0"!==e.name?e.name:n);i=t.usage,o=t.summary?t.summary:"",l=t.defaults,a=[...t.details,...t.options],s=t.extraOptions}else({usage:i,summary:o,details:a,defaults:l}=await ds(r));const p=a?Array.isArray(a)?a:[a]:[];let c;return Array.isArray(o)||(o=o?[o]:[]),c="gnu"===t?[`usage: ${i}`,...s?[`addtional options: ${s}`]:[],...o,...l,...p]:function(...e){const t=e[Symbol.iterator](),r=[...t.next().value];for(const e of t)e.length&&(r.push(""),r.push(...e));return r.push(""),r}([i],o,p,l,s?[`addtional options: ${s}`]:[]),c}});var gs=Object.freeze({__proto__:null,default:async function(e,t){const{name:r,args:n}=Ba(t),{main:i}=await Cl(e,{shim:"IDL=1 cmd"});if("function"!=typeof i[r])throw new TypeError("Module's binding is missing");return await i[r].apply(void 0,await n)},js_hell:"IDL=1\n-- Import PACKAGE_NAME and use the js-hell syntax BINDING_TEXT to invoke a function. \ncall PACKAGE_NAME BINDING_TEXT :: default($packageName,$bindingText)"});var ys=Object.freeze({__proto__:null,default:function*(t,{lastModified:r=!0,size:n=!0,summary:i=!0,useColor:o=!0,dirs:a=!0,locale:s}={}){const l=new Intl.DateTimeFormat(s,{dateStyle:"short",timeStyle:"short"}),p="en-GB"===l.resolvedOptions().locale?e=>l.format(e).replace(",",""):e=>l.format(e),c=new Intl.NumberFormat,u=e=>c.format(e);let d=0,f=0;const m=o?`[${I.colors.whiteBright[0]}m`:"",h=o?`[${I.colors.gray[0]}m`:"",g=o?`[${I.colors.reset[0]}m`:"";for(const{size:i,webkitRelativePath:o,lastModified:s,isDirectory:l}of t){if(!a&&l)continue;let t=l?m:"";if(r&&(t+=p(s)+"\t"),n&&(t+=(l?" ":u(i))+"\t",d+=l?0:i),l)t+=o;else{const{dir:r,base:n}=e.parse(o);t+=`${h}${r}${r?e.sep:""}${g}${n}`}t+=g,yield t,++f}i&&(yield n?`Total: ${f} files; ${u(d)} bytes`:`Total: ${f} files`)},js_hell:'IDL=1\n    dir [(FILE|DIR)...] \n    :: default( \n        *( $1 ?? cwd.glob( "*", { exclude } ) ).map( f => ({f.size,f.lastModified,f.webkitRelativePath,f.isDirectory}) )\n        ,{\n            @option lastModified = true, \n            @option size = true, \n            @option summary = true, \n            useColor: @option color = true, \n            @option dirs = true,\n            locale: (@option(Str) locale) ?? undefined \n        }\n    ) as *String'});var vs=Object.freeze({__proto__:null,default:function*(e,t){for(const{name:r,data:n}of t){const t=n.toString().split(/\r?\n/);e:for(let n=0;n<t.length;++n){let i=0;for(;;){const o=t[n].indexOf(e,i);if(-1===o)continue e;yield`${r}:${n+1}.${o}:${t[n]}`,i=o+e.length}}}},js_hell:"IDL=1\n   -- Search for occurences of SEARCH_STR in FILE... \n   findstr SEARCH_STR FILE... :: default($searchStr, *$files.map( f => ({ name: f.webkitRelativePath, data: f.toText()}) )) as *String\n"});var ws=Object.freeze({__proto__:null,default:async function(e){const t=await import(e);return Object.keys(t)},js_hell:"IDL=1\n-- List the exports in the ESM module MJS_FILE.\nOUTPUT_FORMAT=Enum\nget-exports MJS_FILE :: default($1.toURL())"});function bs(e,t){if("number"==typeof t){if(!Number.isInteger(t)||t<0)throw new TypeError("Numeric key must be an unsigned integer");if(!Array.isArray(e))throw new TypeError("Numeric key requires an array")}else{if("string"!=typeof t)throw new TypeError("`key` must be an unsigned integer or a string");if("object"!=typeof e||!e||Array.isArray(e))throw new TypeError("String key requires a non-null dictionary object")}}var xs=Object.freeze({__proto__:null,default:function(e,t,r){let n=e;for(let e=0;e<t.length-1;++e){const r=t[e];bs(n,r),n=n[r]}const i=t.at(-1);return bs(n,i),n[i]=r,e},js_hell:"IDL=1 json-set JSON_FILE KEY_NAME... JSON :: default( JSON_FILE.toJSON(), $2, $3) as JSON -> JSON_FILE"});var Es=Object.freeze({__proto__:null,default:function(e,t=255,{crypto:r=!1}){if(r){let r;if(255===t)r=new Uint8Array(e);else if(65535===t)r=new Uint16Array(e);else{if(4294967295!==t)throw new TypeError("Illegal maximum value for cryptograph random numbers");r=new Uint32Array(e)}return globalThis.crypto.getRandomValues(r),r}{const r=[];for(let n=0;n<e;++n)r.push(Math.trunc(Math.random()*t));return r}},js_hell:"IDL=1\n-- Generate COUNT random numbers between 0 and MAX_COUNT (inclusive; 0 <= x <= MAX_COUNT).\n-- MAX_COUNT defaults to 255 (i.e. bytes).\n\nrand \n    [--crypto] -- Use `crypto.getRandomValues()` instead of `Math.random()`; MAX_INT must be set for 8-, 16-, 32- or bit unsigned ints.  \n    [MAX_INT] \n    COUNT \n    :: default($2, $1 = 255, {crypto=false})\n"});var Ts=Object.freeze({__proto__:null,default:function(e,t){return e.prepare(`SELECT ${t}`).all()},js_hell:"IDL=1 \n-- Run the SQL query `` `SELECT ${QUERY_TEXT}` `` on DATABASE_FILE.\n--  \n-- If DATABASE_FILE isn't a table, it will be converted to database with table name 'STDIN'; for example,\n-- `js-hell select --input=file.csv '\"FROM STDIN Name,sum( Amount ) AS Total GROUP BY Name ORDER BY Name\"'`\n-- \nselect [--input=DATABASE_FILE] QUERY_TEXT :: default( await input.database('STDIN'), $1 ) as JSON"});var ks=Object.freeze({__proto__:null,default:function(e,t){if("object"!=typeof e||Array.isArray(e))throw new Error("$1 must be a plain object (a 'dictionary')");return Ti.fromTemplateContents(t).exec(new Map(Object.entries(e)),{})},js_hell:"IDL=1\n    -- Treat TEMPLATE_FILE as a template literal and output it. \n    -- JSON|FILE is used to populate the global namespace (i.e. provides the execution context - like a `with` statement. \n    template \n        (JSON|FILE) \n        TEMPLATE_FILE  \n    :: default( $1, $2.toText() ) as String"});var Ss=Object.freeze({__proto__:null,default:function(e,t,r){const n=l(t)?[""]:r.split(p);return e.split(p).flatMap((e=>{const r=[];for(const i of n){const n=s(e,t+i);E(n)&&r.push(n)}return r}))},js_hell:"IDL=1\n-- Locate CMD_NAME in the current PATH.\n-- (If CMD_NAME has no extension, the ones listed in PATHEXT will be tried.)\n-- \n--   * `--path` defaults to env.PATH\n-- \n--   * `--pathext` defaults to env.PATHEXT\n-- \npathfind [--path=TEXT] [--pathext=TEXT] CMD_NAME \n:: default( path ?? env.PATH, $1, pathext ?? env.PATHEXT ?? '' )"});let As=null;async function Os(e,t,r,n={}){const i=await e.importModule(),{idl:o}=e,a=o.createLexicalEnvironment(n);a.appendParsedOptions(o.parseOptions(function*(e,t){if(e.startsWith("/"))throw new TypeError("Illegal path");for(const[e,r]of t.entries())yield{type:Oi,value:`--${e}`,info:Di},yield{type:Ai,value:r,info:Ri};for(const t of e.split("/"))yield{type:Si,value:t,info:Ri}}(t,r)));const s=a.finalise();return await o._exec1(i,s)}function Ns(e){return"application/module+javascript"===e?"application/javascript":e}async function js(e,t,n,i,{remoteDiagnostics:o=!1,sessionId:a,safeCall:s}){let l;try{l=await async function(e,t,n){if(n.startsWith("/"))throw new TypeError("Illegal path");const[i]=n.split("/",2);if(t.has(i)){if(!t.isWebSafe(i))throw new Error("Forbidden");return await t.getScriptlet(i)}const o=wr.fromString(r(e,n),{});if(o.isFile)return o;if(!o.isDirectory)return null;const a=wr.fromString(r(e,n,"index.html"),{});return a.isFile?a:null}(t,e,n)}catch(e){return console.error(e.message),{code:500,message:"Path resolution",content:o?e.stack:""}}if(!l)return{code:404,message:"Not found"};if(l instanceof ts)return await async function(e,t,r,{remoteDiagnostics:n,sessionId:i,safeCall:o}){if(e.startsWith("/"))throw new TypeError("Illegal path");if(!await async function(e){return await e.importModule(),e.idl.getResultType().isScalar("JSON")}(t))return{code:403,message:"Scriptlet doesn't output JSON"};try{const n=await Os(t,e,r,{globalDefaults:jp({sessionId:i})});return{mimeType:"application/json",content:JSON.stringify(o?{success:!0,value:n}:n)}}catch(e){if("object"==typeof e&&e&&e.cause instanceof Error&&(e=e.cause),o)return{mimeType:"application/json",content:JSON.stringify({success:!1,value:n?e.stack:e.message})};console.error(e.message);let t="";return n&&(t=e.stack),{code:500,message:"Scriptlet exception",content:t}}}(n,l,i,{remoteDiagnostics:o,sessionId:a,safeCall:s});if(l.isFile){return{code:200,content:l.getContentAsBuffer(),mimeType:Ns(l.type)}}return{code:403,message:"Forbidden"}}class Is{#we;constructor(e){for(const t of e.trim().split(/;\s*/g)){if(!t.includes("="))continue;const[e,r]=t.split("=",2);"uuid"===e.trimEnd()&&(this.#we=r)}}static fromRequest({cookie:e=""}){return new Is(e)}get(e){return"uuid"===e?this.#we:void 0}has(e){return void 0!==this.#we}}class Ls{#be;#xe;constructor(e){this.#be=e,e=e.trimStart();const[t,r]=e.split(";",2);this.#xe=t.toLowerCase()}get essence(){return this.#xe}toString(){return this.#be}}const $s="content-type";async function qs(e,t,r,n,{remoteDiagnostics:i,safeCall:o}){const{method:a,headers:s,url:l}=r,p=Is.fromRequest(s),c={},{uuid:u,state:d}=function(e,t){let r;if(e.has("uuid")){const t=e.get("uuid").trim();if(/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-4[a-fA-F0-9]{3}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/.test(t))return{uuid:t,state:"="};r="!"}else r="+";const n=R();return t["Set-Cookie"]=`uuid=${n}; Max-Age=604800; SameSite=Strict; Path=/`,{uuid:n,state:r}}(p,c);let f=null;if("POST"===a){if(!Object.hasOwn(s,$s))return console.log("webhost[%s%s]: received %s (no content type) %s",d,u,a,l),n.writeHead(400,"No Content-Type"),void n.end();const e=new Ls(s[$s]);if(console.log("webhost[%s%s]: received %s (%s) %s",d,u,a,e,l),"application/x-www-form-urlencoded"!==e.essence)return n.writeHead(500,"Post must be application/x-www-form-urlencoded"),void n.end();f=new URLSearchParams(await async function(e){let t="";for await(const r of e)t+=`${r}`;return t}(r))}else{if("GET"!==a)return console.log("webhost[%s%s]: received %s %s",d,u,a,l),n.writeHead(501,"Unsupported method"),void n.end();console.log("webhost[%s%s]: received %s %s",d,u,a,l)}const m=new URL(l,"https://dummyservername.internal"),h=m.pathname.slice(1);let g=m.searchParams;if(f)if(0===g.size)g=f;else for(const[e,t]of f.entries())g.append(e,t);const y=await js(e,t,h,g,{remoteDiagnostics:i,sessionId:u,safeCall:o}),{code:v=200,message:w="OK",mimeType:b="text/plain",content:x=""}=y,E=Buffer.from(x);c["Content-Type"]=b,c["Content-Length"]=E.length,n.writeHead(v,w,c),n.end(E)}var Rs=Object.freeze({__proto__:null,default:async function({host:e="127.0.0.1",port:t=8111,cwd:n,remoteStacktrace:i=!1,abortOnInput:o=!0,usePackageJson:a=!0,safeCall:s=!1}={}){const l=o&&process.stdin.isTTY?(As||(process.stdin.setRawMode(!0),As=new Promise((e=>process.stdin.on("data",(t=>{As=null,console.log("[abort]"),e("abort")}))))),As):new Promise((()=>{}));console.warn("This is EXPERIMENTAL. Do NOT deploy in a production environment.");const p=new Sl({builtins:!1});let d;if(a){const e=Js(`${n}`);if(!e)throw new Error("Couldn't find a `package.json` file");await p.addJsonPackageFromUrl(e,{recurse:!0}),d=c(u(e))}else await p.init(),d=r(`${n}`);console.info("webhost:",d),console.info("webhost: packages",p.packages().map((e=>e.name))),D.createServer(((e,t)=>qs(p,d,e,t,{remoteDiagnostics:i,safeCall:s}))).listen({host:e,port:t},((...r)=>{console.info("webhost: listening on %s:%d",e,t,r)})),await Promise.race([new Promise((e=>e)),l])},js_hell:'IDL=1\n-- The experimental web host (xwh).\n--\n-- This serves a package:\n--\n--  * Ordinary files are returned as is (provided they match the files key.)\n-- \n--  * js-hell scriptlets are executed as CGI.\n--\n--  See README.md for more info.\n-- \n HOST="0.0.0.0" PORT="8111"\n $0 \n    [--remote-stacktrace]     -- Output exceptions, etc... to scripts.\n    [--no-abort-on-input]     -- Don\'t listen on stdin and abort on any input.\n    [--no-package-json]       -- Serve files from the current directory without any CGI.\n    [--safe-call]             -- Use the safecall RPI format for all scriptlets. See docs. \n    [[HOST_STRING] PORT_INT]             \n::\n  default( {host:$1 = "127.0.0.1", port:$2 = 8111,cwd,remoteStacktrace,abortOnInput,usePackageJson:packageJson,safeCall} )'}),Ds={name:"gash",version:"1.0.20250311",description:"A tool for running javascript from the command-line (CLI). Instead of creating a CLI tool, annotate your library and gash will run it for you.",keywords:["cli","shell","command line"],homepage:"https://github.com/fuchsia/gash#readme",repository:"github:fuchsia/gash",bugs:"https://github.com/fuchsia/gash/issues","-- It's not importable, so skip main":"","-- main":"lib/host/main.mjs",directories:{lib:"lib"},devBin:{"gash-dev":"lib/bin/cli.mjs"},bin:"dist/gash.mjs","-- files: we don't need anything other than bin, plus README, LICENCE, and package.json; all of which are auto included.":"",files:[],scripts:{"test-debug":"node --no-warnings -- node_modules/jasmine/bin/jasmine.js --reporter=./test-data/specReporter.mjs",test:"npx jasmine","mimetype-extensions-make":"gash lib/utils/mimetype-extensions-make.mjs node_modules/mime-db/db.json --output=lib/utils/mimetype-extensions.json","make-dist":"rollup -c rollup.config.mjs"},gash:{"-- Ugh. This is needed for a test. FIXME":"",jasmine:"API=1 jasmine :: default()"},author:"",license:"BSD-1-Clause",devDependencies:{"@rollup/plugin-json":"^6.1.0",jasmine:"^5.5.0","mime-db":"^1.52.0",terser:"^5.34.1"},engines:{node:">=16.14"}};var Us=Object.freeze({__proto__:null,default:function(e){return e?void 0===e.version?"(undefined)":e.version:Ds.version},js_hell:"IDL=1 \n\n-- Output the version of js-hell, or the version of SCRIPTLET if supplied.  \n\n$0 [SCRIPTLET] :: default($1 = null )"});const _s=[{nodetype:"module",idl:"IDL=1 bitmask -- Return a bitmask of all the bit indices\n INT...     :: with() Math.bits( ...$1 )",moduleUrl:"about:blankjs#bitmask",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 cat     -- Copy FILE to stdout                    \n (FILE|URL) :: with() await fetch($1).buffer() as Buffer",moduleUrl:"about:blankjs#cat",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/char.mjs",module:cs,version:"1.0.20250311"},{nodetype:"module",idl:'IDL=1 OUTPUT_MIMETYPE="text/csv" csv -- Output a JSON table as CSV.\n [--input=JSON_FILE] :: with( toCSV,fromObjectArray ) toCSV( fromObjectArray( input.toJSON() ), { eol: EOL }  )',moduleUrl:"file:///z:/www/js-hell/lib/formatOutput.mjs#csv",module:$n,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 psv -- Output a JSON table as pipe-separated variables - suitable for use as a markdown table\n [--input=JSON_FILE] :: with( toMarkdown,fromObjectArray ) toMarkdown( fromObjectArray( input.toJSON() ), { eol: EOL }  )",moduleUrl:"file:///z:/www/js-hell/lib/formatOutput.mjs#psv",module:$n,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 echo TEXT... :: with() TEXT.join(' ') as String",moduleUrl:"about:blankjs#echo",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 -- Echo an option value instead of a positional. (Used for testing.)\n echo-value --value=TEXT :: with() value as String",moduleUrl:"about:blankjs#echo-value",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 -- Single argument version of echo. (Because lists can't contain expression.)\necho1 TEXT :: with() $1 as String",moduleUrl:"about:blankjs#echo1",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 -- Used for testing: output the JSON\nOUTPUT_FORMAT=JSON0 echo-json JSON :: with() $1",moduleUrl:"about:blankjs#echo-json",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","-- Fetch VAR_NAME from the lexical environemnt. For example `get cwd` or `get --output-format=JSON EOL`","get VAR_NAME :: with() $LEXICAL_ENVIRONMENT$.get(VAR_NAME)"],moduleUrl:"about:blankjs#get",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/log.mjs",module:us,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 product -- Product of all the numbers.            \n INT...     :: with() Math.product( ...$1 )",moduleUrl:"about:blankjs#product",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 split -- Split text into chunks.              \n [--limit=COUNT] SPLIT_STRING TEXT :: with() $2.split( $1, limit ?? undefined)",moduleUrl:"about:blankjs#split",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","shuffle           -- Randomise the order of a set of strings.","   [--seed=COUNT] -- The number seed. If ommitted, a random number will be picked.","   STRING...",":: with( )","    ( seed ?? Math.random32() )","    |> $1.map( text => ({text,hash:text.hash( % )}) )","    |> %.toSorted( ( a, b ) => Math.diff( a.hash, b.hash ) )","    |> %.map( a => a.text )"],moduleUrl:"about:blankjs#shuffle",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 avg     -- Average of the list of numbers         \n [INT...]     :: with() Math.quotient( Math.sum( ...$1 ), $1.length )",moduleUrl:"about:blankjs#avg",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 sum     -- Sum all the numbers.                   \n INT...     :: with() Math.sum( ...$1 )",moduleUrl:"about:blankjs#sum",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 help    [SCRIPTLET] :: default($1.idl ?? null,{SCREEN_COLUMNS,externalName:$1.name ?? 'help'})",moduleUrl:"file:///z:/www/js-hell/lib/host/help.mjs",module:hs,version:"1.0.20250311"},{nodetype:"node:dep",idl:"IDL=1 cp      -- Reserved for future use.\n :: with() new Error( 'reserved for future use.' )",moduleUrl:"node:fs#cp",module:f,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/call.mjs",module:gs,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/dir.mjs",module:ys,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/findstr.mjs",module:vs,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 false :: with () false",moduleUrl:"about:blankjs#false",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/get-exports.mjs",module:ws,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","-- Parse a JSON file and output it _as_ JSON.","-- ","-- For example `json somefile.json --output-format=psv` will turn it into a markdown table.","json JSON_FILE :: with( ) $1.toJSON() as JSON"],moduleUrl:"about:blankjs#json",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/json-set.mjs",module:xs,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/rand.mjs",module:Es,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","resolve     -- Run the scriplet resolver on SCRIPTLET and return the URL of the ESM module that will be used.","    [--idl] -- Return the IDL instead of the MODULE_URL.","     SCRIPTLET","     :: with() $1[idl ? 'idl' : 'moduleUrl'].toString()"],moduleUrl:"about:blankjs#resolve",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/select.mjs",module:Ts,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 spawn -- Reserved for future use.\n:: with() new Error( 'Reserved for future use.')",moduleUrl:"about:blankjs#spawn",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 true :: with () true",moduleUrl:"about:blankjs#true",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/template.mjs",module:ks,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 zeroes [BYTE_COUNT] :: with() Buffer.alloc( $1 = 0 ) as Buffer",moduleUrl:"about:blankjs#zeroes",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","-- Move up through the directory tree and return the first directory conaining FILE_NAME.","-- ","-- ### Example","-- ```","-- js-hell get-projectdir package.json","-- ```","get-projectdir","     [--relative] -- Return a relative path, instead of an absolute one.","     FILE_NAME ",":: default($fileName,cwd.toString(),{relative=false}) as Dirname"],moduleUrl:"file:///z:/www/js-hell/lib/host/getProjectdir.mjs#get-projectdir",module:ns,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","-- Split STRING into individual arguments using js-hell's internal tokeniser.","-- (This can be useful for seeing how js-hell is interpreting arguments or will call","-- an external command.)","--","-- Arguments are separated by spaces (any codepoint matching /\\s/)","-- and by the specials `!?$%^=@#~()[]{}<>&|,;`'\"`.","--","-- Empty strings, and strings containing spaces or special characters can be quoted","-- with single or double quotes (\"\" or '').","--","-- There in no escaping: quotes run through to next occurence of the quote character.","-- (This means you can't use strings that contain both `\"` and `'`. It's for Windows","-- filenames - the plan is to add `` quoting with escaping.)","--","-- Quotes can only happen at the start of a token (or the start of an option's",'-- value). So `some" "thing` is NOT permitted - it has to be `"some thing"`. (But','-- `--char=" "` is fine to specify a space.)',"","argtok STRING :: shfy($string) as JSON"],moduleUrl:"file:///z:/www/js-hell/lib/args/argtok.mjs",module:Hi,version:"1.0.20250311"},{nodetype:"module",idl:["IDL=1","-- List the names and aliases in the type registry","idl-types :: list()"],moduleUrl:"file:///z:/www/js-hell/lib/types/registry.mjs#idl-types",module:Wr,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/builtins/pathfind.mjs",module:Ss,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 repl -- Reserved for future use.\n:: with() new Error( 'Reserved for future use.' )",moduleUrl:"about:blankjs#repl",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 rm -- Reserved for future use.\n:: with() new Error( 'Reserved for future use.' )",moduleUrl:"about:blankjs#rm",module:void 0,version:"1.0.20250311"},{nodetype:"module",idl:"IDL=1 run -- Reserved for future use.\n:: with() new Error( 'Reserved for future use.' )",moduleUrl:"about:blankjs#run",module:void 0,version:"1.0.20250311"},{nodetype:"node:dep",idl:"IDL=1 uuid -- Output a random UUID (i.e. wraps `crypto.getRandomUUID()`)\n:: randomUUID()",moduleUrl:"node:crypto#uuid",module:q,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/webhost/server.mjs#xwh",module:Rs,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/version.mjs",module:Us,version:"1.0.20250311"},{nodetype:"module",idl:"*",moduleUrl:"file:///z:/www/js-hell/lib/host/version.mjs#ver",module:Us,version:"1.0.20250311"}];let Cs=0;class Ms{#Ee;#Te;default;constructor(e,{startupDir:t}={}){this.#Ee=e,this.#Te=t,this.default=()=>this.exec()}async exec(){const e=++Cs;console.log("[!%d] %s>%s",e,this.#Te,this.#Ee);const{shell:t}=fr(),r=await t.execJob(["node",Wa,this.#Ee],{startupDir:this.#Te});return console.log("[!%d] exited (%d)",e,r),0===r}toScriptlet(e){return ts.from(`IDL=1 -- Execute the script:\n--\n-- >${JSON.stringify(this.#Ee).slice(1,-1)}\n${e} :: default()`,`script:${this.#Ee}`,this,e)}}async function Ps(e){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Invalid arg argument");const{shell:t}=fr();if(Array.isArray(e)&&e.some((e=>"string"!=typeof e)))throw new Error(`gash(): args must all be strings ${JSON.stringify(e)}`);return 0===await t.execJob(["node",Wa,...Array.isArray(e)?e:[e]],{})}const zs=new URL("./builtins.json",import.meta.url),Bs="root-package";function Fs(e){return Object.keys("object"==typeof e&&e?e:{})}async function Vs(e){try{return"file:"===new URL(e).protocol?JSON.parse(h(u(e),"utf8")):(await import(e,{with:{type:"json"}})).default}catch(e){return}}function Js(t){const r=rs("package.json",t,{relative:!1});return r?d(e.join(r,"package.json")):""}function Ws(e,t){return"string"!=typeof e.main?null:new URL(e.main,t)}function Gs(e){const t=Wa+" ",r=`${e}`.trimStart();return r.startsWith("js-hell ")||r.startsWith(t)?r:""}function Hs(e){return"object"==typeof e[Xa]?e[Xa]:"object"==typeof e[Ka]?e[Ka]:null}function Ks(e){return Array.isArray(e)&&(e=e.join("\n")),"string"==typeof e&&"*"===(e=e.trim())}function Xs(e){return"object"==typeof e&&e&&!Array.isArray(e)}const Zs="root",Ys="module",Qs="ignore",el="node:dep",tl="child-package",rl="nodep",nl="nested",il="about:",ol="blankjs",al=`${il}${ol}`,sl=Zs,ll=Ys,pl="script",cl="shim",ul="js-hell:builtin";function dl(e,t,r){e.has(t)||e.set(t,r)}class fl{name;type;baseUrl;value;source;constructor({name:e,type:t,baseUrl:r,value:n,source:i}){Object.assign(this,{name:e,type:t,baseUrl:r,value:n,source:i})}isRunnable(){return!1}toScriptlet(){throw new TypeError("Not runnable!")}}class ml{name;type;baseUrl;value;source;constructor(e,{name:t=e.name,baseUrl:r=e.moduleUrl,type:n=ll,source:i}={}){Object.assign(this,{name:t,type:n,value:e,source:i})}isRunnable(){return!0}toScriptlet(){return this.value}}class hl extends ml{constructor(e,t){super(e,t)}toScriptlet(){if(!this.value.idl.isValidGashUsage())throw new Error("`gash()` cannot be used in a `with()` statement");return this.value}}class gl{#ke;#Se;#de;name;type;baseUrl;value;source;constructor({name:e,type:t,baseUrl:r,value:n,source:i}){Object.assign(this,{name:e,type:t,value:n,source:i}),this.#ke=r}async resolveJson(){if(void 0!==this.#Se)return;const e=await Vs(this.#ke);if(e.name!==this.name)throw new TypeError("Package name doesn't match name under which it was loaded");if(this.#de=Ws(e,this.#ke),!this.#de)throw new TypeError(U`Package ${this.name} is not executable (missing or invalid "main" key in package.json)`);if(this.type===cl){if(Hs(e))throw new TypeError(U`Package ${this.name} cannot be overridden with a shim as it has a js-hell descriptor`)}else this.value=Hs(e);this.#Se=e}async isRunnable(){try{return await this.resolveJson(),!!this.value}catch(e){return!1}}async toScriptlet(){return await this.resolveJson(),new ts(this.value,{module:void 0,moduleUrl:this.#de})}}function yl(t,r,n){const i=e.dirname(u(n));return new Ms(r,{startupDir:i}).toScriptlet(t)}const vl=new Set,wl=Symbol(Bs);function bl(e,t=!1,r){const n={};if("object"!=typeof e||Array.isArray(e))return vl.has(r)||(console.warn("warning: missing or malformed package list %s",r),vl.add(r)),n;const i=function(e){let t=!1,r="";for(const n of[Za,Xa,Ka])if(Object.hasOwn(e,n)){if(t)throw new TypeError(`package cannot have mix \`${Za}\`, \`${Xa}\` and \`${Ka}\` keys; pick one.`);t=!0,r=n}return r}(e);if(i){const t=e[i];if("object"==typeof t){if(null===t)throw new TypeError(`invalid ${i} entry in package.json: null`);if(!Array.isArray(t))return t}const r=e.name;if("string"!=typeof r)throw new TypeError(`if idl is used ${i} the package must have a name`);n[r]=t,n[wl]=r}if(t){for(const t of Fs(e.dependencies))Object.hasOwn(n,t)||(n[t]="*");for(const t of Fs(e.devDependencies))Object.hasOwn(n,t)||(n[t]="*")}return n}function xl(e,t){return null!=e&&Object.hasOwn(e,t)}function El(e,t,r){if(e.startsWith("./")){const t=new URL(e,r);return function(e){"file:"!=typeof e.protocol||new URL(e.pathname,"file:")}(t),{type:Ys,url:t,name:void 0}}if(e.startsWith("node:"))return{type:el,url:new URL(e),name:void 0};if(e.startsWith("#"))return{type:Ys,url:new URL(e,al),name:void 0};if(e.startsWith("about:")){const t=new URL(e);if("blankjs"===t.pathname)return console.assert("about:blankjs"===al,"The code is broken: it assumes `about:blankjs` is BLANKMODULE_URL"),{type:Ys,url:t,name:void 0}}if(e.startsWith("--"))return{type:Qs,url:e,name:void 0};if(e===t.name)return{type:Zs,url:Ws(t,r),name:e};if(xl(t.dependencies,e)||xl(t.devDependencies,e)){const t=new URL(`./node_modules/${e}/package.json`,r);return{type:tl,url:t,name:void 0}}return{type:rl,url:e,name:void 0}}function Tl({protocol:e,pathname:t}){return e===il&&t===ol}async function kl(e,t,r){const n=t;t===ul&&(t=zs);const{version:i}=r,o=[];for(const{type:a,url:s,name:l,idl:p,key:c}of function*(e,t,r){for(const[n,i]of Object.entries(e)){let{type:e,url:o,name:a}=El(n,r,t);if(e===Ys&&Tl(o)&&Xs(i))e=nl,a=o.hash.slice(1);else if("string"!=typeof i&&!Array.isArray(i))throw new Error(U`Invalid IDL for entry ${n}: it must be a string`);yield{type:e,url:o,name:a,idl:i,key:n}}}(e,t,r))if(a!==Qs)if(a===nl){const e=await kl(p,t,r);if(0===e.length)throw new Error(U`No sub commands for ${s}`);const i=await Promise.all(e.map((e=>e.toScriptlet())));o.push(await os.fromScriptlets(i,{name:l,source:n}))}else if(a===rl)console.error("missing dependency: %s",s,t);else if(a===tl)if(console.assert(void 0===l,"name shouldn't be defined here"),Ks(p)){const e=new Sl;if(await e.addJsonPackageFromUrl(s,{recurse:!1}),e.hasTrueRootScriptlet()){const t=await e.getTrueRootScriptlet();o.push(new ml(t,{type:a,source:n}))}else e.getOwnScriptletEntries(s).length&&o.push(os.fromPackageTree(e,{url:s,name:c}))}else Xs(p)?console.error("%s: nested IDL not supported here",c):o.push(new gl({name:c,type:cl,baseUrl:s,value:p,source:n}));else if(a===Zs){const e=new ts(p,{moduleUrl:s,name:l,version:i}),t=new ml(e,{type:sl,source:n});o.push(t);const r=Object.create(t,Object.getOwnPropertyDescriptors({name:Bs,isRunnable(){return Object.getPrototypeOf(this).isRunnable()},toScriptlet(){return Object.getPrototypeOf(this).toScriptlet()}}));o.push(r)}else if(a===el){if(Ks(p)){console.error("%s: cannot use '*' as the IDL",c);continue}if(Xs(p)){console.error("%s: cannot use a nested IDL key for a `node:` module",c);continue}const e=new ts(p,{moduleUrl:s,version:i});o.push(new ml(e,{type:a,source:n}))}else{if(a!==Ys)throw new Error(U`Unknown node type \`${a}\``);if(Xs(p))console.error("%s: nested IDL not supported here",c);else{let e;const t=Tl(s);t&&(e=Object.create(null),e.gash=Ps);const r=new ts(p,{module:e,moduleUrl:s,version:i});o.push(new(t?hl:ml)(r,{type:a,source:n}))}}return o}class Sl{#Ae;#Oe;constructor({builtins:e=!0}={}){this.#Oe=e}async init(){if(!this.#Ae&&(this.#Ae=new Map,this.#Oe)){if(Array.isArray(_s))for(const{nodetype:e,idl:t,moduleUrl:r,module:n,version:i}of _s)this.addScriptlet(e,new ts(t,{moduleUrl:r,module:n,version:i}),ul);else await this.addScriptletList(_s,ul,Ds);{const e=new ts(as,{module:ss,name:"js-hell"});e.idl.addTail(),this.addScriptlet(ll,e,ul)}{const e=new ts(as,{module:ss,name:Wa});e.idl.addTail(),this.addScriptlet(ll,e,ul)}}}async addJsonPackageFromUrl(e,{recurse:t=!1}){if(!e)throw new Error("No package url");await this.init(),await async function(e,t,{recurse:r=!1}){const n=t.toString(),i=await Vs(n),o=bl(i,r,n);await e.addScriptletList(o,t,i),r&&i?.scripts&&e.addScriptNodes(i.scripts,t)}(this,e,{recurse:t})}async addCwdPackageTree(e="."){const t=function(e="."){return Js(e)}(e=`${e}`);t?await this.addJsonPackageFromUrl(t,{recurse:!0}):await this.init()}has(e){return this.#Ae.has(e)}isWebSafe(e){const t=this.#Ae.get(e);return(t.type===ll||type===cl)&&t.source!==ul||(console.log("not websafe?",t.type,t.source),!1)}static isNonShim(e){return null==e||""!==e||"*"!==e}async getScriptlet(e,t){if(!Sl.isNonShim(t))throw new TypeError("No shims!");return this.#Ae.get(e).toScriptlet()}hasTrueRootScriptlet(){return this.#Ae.has(Bs)}getTrueRootScriptlet(e){return this.getScriptlet(Bs,e)}getCompositeRootScriptlet(e,{url:t,name:r}={}){if(this.hasTrueRootScriptlet())return this.getTrueRootScriptlet(e);if(!Sl.isNonShim(e))throw new TypeError("No shims!");return os.fromPackageTree(this,{url:t,name:r}).toScriptlet()}async addScriptletList(e,t,r={}){const n=await kl(e,t,r),i=this.#Ae;for(const e of n)dl(i,e.name,e)}addScriptNodes(e,t){const r=this.#Ae;for(const[i,o]of(n=e,Object.entries("object"==typeof n&&n?n:{}))){const e=Gs(o);dl(r,i,e?new ml(yl(i,e,t),{type:"js-hell script"},this):new fl({name:i,type:pl,baseUrl:t,value:{scriptText:o}},this))}var n}addScriptlet(e,t,r){const n=new ml(t,{type:e,source:r},this);return dl(this.#Ae,n.name,n),n}packages(){return Array.from(this.#Ae.values()).filter((e=>!!e))}getOwnScriptletEntries(e){return e=e.toString(),Array.from(this.#Ae.values()).flatMap((t=>t?t.type!==ll&&"catalogue"!==t.type||t.source.toString()!==e?[]:[[t.name,t.value]]:[]))}}const Al="json_url",Ol="script_url";async function Nl(e,t){e=`${e}`;const r=await import(e),n=es(r);if("string"==typeof n)return ts.from(n,e,r);if(t)return ts.from(t,e,r);throw new TypeError(`Incompatible module (missing or invalid "${Ha}" export in module ${JSON.stringify(e)})`)}async function jl(e,t){const{type:r,filename:n}=function(e){const t=z(e);if(t===C){const t=s(e,"package.json");if(z(t)!==M)throw new Error(`missing ${t}`);return{type:Al,filename:t}}if(t===P)throw new Error(U`no FILE ${e}`);if(t!==M)throw new Error(U`cannot read ${e}`);if(e.endsWith(".mjs")||e.endsWith(".js"))return{type:Ol,filename:e};if(e.endsWith(".json"))return{type:Al,filename:e};throw new Error(U`cannot process file ${e}`)}(e),o=d(n);if(r===Ol)return Nl(o,t);if(r===Al){const r=new Sl;return await r.addJsonPackageFromUrl(o,{recurse:!1}),r.getCompositeRootScriptlet(t,{url:o,name:i(e)})}throw new Error(U`Unknown file type ${r}`)}const Il=/^(?:https?|file):/,Ll=/^(?:\.?[/\\]|[A-Za-z]:)/,$l=/[.\\/]/,ql="file",Rl="url",Dl="file-or-package",Ul="package";async function _l(e="help",{shim:t="",cwd:r}){const n=function(e){return Il.test(e)?Rl:Ll.test(e)?ql:!e.startsWith("@")&&$l.test(e)?Dl:Ul}(e);if(n===ql)return jl(e,t);if(n===Rl)return async function(e,t){return Nl(e,t)}(e,t);const i=new Sl;if(await i.addCwdPackageTree(r),"--help"!==e&&"-h"!==e||(e="help"),i.has(e))return i.getScriptlet(e,t);if(n===Dl)return jl(e,t);if(n!==Ul)throw new TypeError(U`Unknown package type ${n}`);throw new Error(U`no PACKAGE ${e}`)}async function Cl(e,{shim:t,cwd:r}={}){const n=await _l(e,{shim:t,cwd:r});return await n.importModule(),n}const Ml=globalThis.fetch;function Pl(e){return new Response(e,{status:200,statusText:"OK"})}function zl(e,t){if(Buffer.isBuffer(e))return Pl(e);const r=new URL(e);return"file:"===r.protocol.toLowerCase()?Pl(h(u(r))):Ml(e,t)}zl[re]=zl;const{abs:Bl,ceil:Fl,clz32:Vl,floor:Jl,imul:Wl,log2:Gl,max:Hl,min:Kl,pow:Xl,random:Zl,round:Yl,sign:Ql,trunc:ep}=Math;var tp=Object.freeze({__proto__:null,abs:Bl,bits:function(...e){let t=0;for(const r of e)t|=1<<r;return t},ceil:Fl,clz32:Vl,diff:(e,t)=>e-t,div:(e,t)=>e/t,equal:(e,t)=>Number(e)===Number(t),floor:Jl,imul:Wl,log2:Gl,max:Hl,min:Kl,neg:e=>-e,percent:e=>e/100,pow:Xl,product:function(...e){let t=1;for(const r of e)t*=r;return t},quotient:(e,t)=>e/t,random:Zl,random32:()=>4294967295*Math.random()>>>0,reciprocal:e=>1/e,round:Yl,sign:Ql,sum:function(...e){let t=0;for(const r of e)t+=Number(r);return t},trunc:ep}),rp=Object.freeze({__proto__:null,basename:i,dirname:c,extname:l});const{styleText:np=(e,t)=>t}=j,ip=e=>process.stdout.write(np(["bold"],e));function op(){if(!process.stdout.isTTY||!process.stdin.isTTY)throw new Error("Cannot readline (not a terminal)")}function ap(){const e=Buffer.alloc(1);process.stdin.setRawMode(!1);let t="";for(;T(process.stdin.fd,e),13!==e[0];)t+=e.toString();return t}var sp=Object.freeze({__proto__:null,alert:function(e="Press any key..."){op(),ip(e);const t=Buffer.alloc(1);process.stdin.setRawMode(!0),T(process.stdin.fd,t),process.stdout.write("\r\n")},confirm:function(e){op(),ip(e+" [Y]es/[N]o? ");const t=ap();return process.stdout.write("\r\n"),t.trimStart().toLowerCase().startsWith("y")},prompt:function(e="Enter a value:",t){return op(),e.trimEnd()===e&&(e+=" "),ip(e),ap()}});class lp{#h;setValueAsBuffer(e){this.#h=e}getContentAsBuffer(){return this.#h}}function pp(e,t,r,n){new zn(e,r,t).setValue(n)}function cp(e,t,r){const n=Ln(t,e,r),i=new wr("stdin","/dev",void 0,n,(()=>{const n=new lp;return pp(n,e,t,r),n.getContentAsBuffer()}));return Ln===In?(i.toText=()=>r,i.text=async()=>r):Ln===jn&&(i.toText=()=>JSON.stringify(r),i.text=async()=>JSON.stringify(r)),i.json=async()=>r,i.toJSON=()=>r,i}const up="Statement",dp="value",fp=!1,mp=!0;class hp{type=up;cwdForResolveScriptlet;argv;scriptletName;scriptlet;module;usage;pipeTail;stacktrace;inspect;logfile;cwd;optionEntries;constructor(e,{cwdForResolveScriptlet:t,stacktrace:r,inspect:n,pipeTail:i}){Object.assign(this,{cwdForResolveScriptlet:t,scriptletName:e[0].value,argv:e,stacktrace:r,inspect:n,pipeTail:i})}async resolveScriptlet(){if(this.argv[0].type!==Si)throw new Error("Internal error ($0 should be a literal)");this.scriptletName=this.argv[0].value;const e=await Cl(this.scriptletName),t=await e.importModule(),r=e.idl.getOptionConflicts(fs);if(r.size)throw new TypeError(U`scriptlet ${this.scriptletName} cannot use options `+Array.from(r).map((e=>JSON.stringify(e))).join(" "));const n=e.idl.getUsage(fs,ms);this.scriptlet=e,this.argv[0].value=e.name,this.module=t,this.usage=n}resolveOptions(){const{argv:e,usage:t}=this,r=[];let n,i,{stacktrace:o,inspect:a}=this;for(const s of t.parseOptions(e)){const{key:e,value:t,source:l}=s;"cwd"===e?n=t:"log"===e?i=t:"stacktrace"===e?l!==da&&(o=t):"inspect"===e?l!==da&&(a=t):r.push(s)}Object.assign(this,{optionEntries:r,cwd:n,stacktrace:o,inspect:a,logfile:i})}async exec(e,t=!1,r=null){if(![dp,fp,mp].includes(t))throw new TypeError("Invalid value for capture");const{scriptlet:n,argv:i,pipeTail:o,optionEntries:a}=this,{idl:s}=n,l=s.createLexicalEnvironment(e);if(l.setFileTopic(r),l.appendParsedOptions(a),o&&!l.usesFileTopic())throw new TypeError(U`cannot pipe to ${this.scriptletName}`);const p=l.finalise(),c=function(e){const{outputFormat:t,outputTextEncoding:r="utf8",outputMimetype:n,EOL:i=("win32"===process.platform?"\r\n":"\n"),SCREEN_COLUMNS:o=80,output:a}=e;return{output:a,format:t,EOL:i,screenColumns:o,textEncoding:r,mimetype:n}}(p),u=this.getResultType(),d=!(c.output instanceof Ra);if(!s.canGuaranteeNoOuput()&&t!==fp&&t!==dp&&d)throw new TypeError("cannot use `--output` inside a pipe");if(void 0!==c.format&&t===dp)throw new TypeError("cannot use --output-format in a subshell (pipe and format)");let f;try{f=await s._exec1(this.module,p,e)}catch(e){if("ScriptletError"!==e.name||void 0===e.cause)throw e;return{success:!1,value:e.cause}}if("boolean"==typeof f&&void 0===c.format){if(d)throw new TypeError("cannot save boolean output");if(t!==fp&&t!==dp)throw new TypeError("cannot pipe boolean output to a command");return{success:!0,value:f}}if(null==f){if(d)throw new TypeError("Command has no output to save");if(t!==fp&&t!==dp)throw new TypeError("cannot pipe command as it has no output");return{success:!0,value:f}}if(t===fp)return function(e,t,r){pp(e.output,e,t,r)}(c,u,f),{success:!0,value:void 0};if(t===dp)return{success:!0,value:f};if(t===mp)return{success:!0,value:cp(c,u,f)};throw new Error("Illegal value for `capture`")}error(e){this.stacktrace?console.error("%s: %s",this.scriptletName,e.stack):console.error("%s: %s",this.scriptletName,e.message)}howIsInputConsumed(){const e=this.scriptlet.idl.inputUsedWithMethodCall();return e&&1===e.size?e.values().next().value:""}getResultType(){return this.scriptlet.idl.getResultType()}static get type(){return up}}const gp="operator",yp=["&&","|",...Object.keys(ms)];function vp({value:e}){if(!yp.includes(e))throw new Error(`Unsupported operator '${e}'`);return!Object.hasOwn(ms,e)}class wp{type=gp;operator;lhs;rhs;constructor(e,t,r){this.operator=t,this.lhs=e,this.rhs=r}}const bp="[2K";class xp extends ${#Ne;#je;#Ie;#Le="";#$e="";#qe="";#Re="";#De(){""!==this.#Re&&this.#Ne.write(bp)}#Ue(){""!==this.#Re&&this.#Ne.write(this.#Re)}constructor(e,t=0,{colorMode:r}={}){super({stdout:e,colorMode:r}),this.#je=t,this.#Ie=!!e.isTTY,this.#Ne=e}debug(...e){this.#je>=1&&(super.debug(...e),this.#Le="debug")}error(...e){this.#je>=-2&&(this.#De(),super.error(...e),this.#Ue(),this.#Le="error")}info(...e){this.#je>=0&&(this.#De(),super.info(...e),this.#Ue(),this.#Le="info")}log(...e){this.#je>=0&&(this.#De(),super.log(...e),this.#Ue(),this.#Le="log")}warn(...e){this.#je>=-1&&(this.#De(),super.warn(...e),this.#Ue(),this.#Le="warn")}count(e="default"){this.#Ie&&"count"===this.#Le&&this.#$e===e&&this.#Ne.write("M"),super.count(e),this.#Le="count",this.#$e=e}countReset(e="default"){this.#Ie&&"count"===this.#Le&&this.#$e===e&&this.#Ne.write("M"+bp)}status(e,...t){if(!this.#Ie)return;this.#qe=L({color:!0,breakLength:1/0,compact:1/0},e,...t);const r="number"==typeof this.#Ne.columns?this.#Ne.columns:80;this.#Re=this.#qe.slice(0,r-1)+"\r",this.#Ne.write(bp+this.#Re)}statusClear(){this.#Ie&&""!==this.#Re&&(this.#Ne.write(bp),this.#qe="",this.#Re="")}statusFlush(){""!==this.#Re&&(this.#Ie?this.#Ne.write("\n"):this.#Ne.write(this.#qe+"\n"),this.#qe="",this.#Re="")}}class Ep{#_e;get shell(){return this.#_e}#Ce;#Me;get console(){return this.#Me}lexicalEnvironmentOptions;#Pe=null;constructor(e,t={},r=e.console){this.#_e=e,this.#Me=r,this.lexicalEnvironmentOptions=t}async openLog(e){if(!e)return;if(void 0!==this.#Ce)throw new Error("Job cannot have multiple log files");const t=this.#Ce=k(e);await new Promise((e=>t.once("open",e))),this.#Ce=t,this.#Me=new xp(t,0,{colorMode:!1})}async flushStatusAndCloseLog(){if(this.#Me.statusFlush?.(),void 0===this.#Ce)return;const e=this.#Ce;this.#Ce=void 0,this.#Me=this.#_e.console;const t=new Promise((t=>e.once("close",(()=>t()))));e.close(),await t}registerCleanup(e){if("function"!=typeof e)throw new Error("Callback must be a function");this.#Pe||(this.#Pe=[]),this.#Pe.push(e)}finalise({stacktrace:e=!1}={}){const t=this.#Pe;if(t){this.#Pe=null;for(let r=t.length;r--;){const n=t[r];try{n()}catch(t){this.#Me.error("cleanup:",e?t.stack:t.message)}}}}hasFinalisation(){return!!this.#Pe?.length}}class Tp extends Error{constructor(...e){super(...e)}static name="VersionError";get name(){return Tp.name}}let kp;const Sp=new Map([["--help","help"],["-h","help"],["/?","help"],["--version","version"],["-v","version"]]);function Ap(e,{stacktrace:t=!1,inspect:r=!1,reparse:n=!1,head:i=!0,pipeTail:o=!1,jsHellAllowed:a=!1,versionAllowed:s=!1}={}){if(!0!==a)throw new TypeError("`js-hell` should always be a valid initial token");const l=[];let p,c="",u=!1,d=!1,f=null;const m=ma.fromOptionsOnly("\n[--stacktrace]\n[--inspect]\n[(--cwd|-C)=DIR]\n[(--help|-h)] \n[(--version|-v)] \n");let h;for(const i of m.rawParse(function*(){for(let t=!0;;t=!1){const{value:r,done:i}=e.next();if(i)return void(u=!0);if(!a||r.type!==Si||"js-hell"!==r.value&&r.value!==Wa){if(r.type!==Ni)h=r;else{if(t)throw new Error(`Operator '${r.value}' not allowed as first argument`);if(vp(r)){c=r.value;break}}yield r}else n=!0,s=!0}}())){if(""===i.key){if(void 0===h)throw console.log(i),new Error("Internal parse error");l.push(h);break}if("stacktrace"===i.key)t=!0;else if("inspect"===i.key)r=!0;else if(Sp.has(i.optionName)){if(f)throw new Error("Multiple redirects");const e=Sp.get(i.optionName);l.unshift({type:Si,value:e,info:Ri}),f=e}else{if("cwd"!==i.key)throw new Error("Intenal error - unknown option should have been caught");p=i.value}}for(;;){const{value:t,done:r}=e.next();if(r){u=!0;break}if(t.type===Oi)if(Sp.has(t.value)){if(t.info===Di&&(console.warn(`${t.value} doesn't take an argument`),d=!0),f)throw new Error("Multiple redirects");{const e=Sp.get(t.value);l.unshift({type:Si,value:e,info:Ri}),f=e}}else l.push(t);else if(t.type===Ni){if(d)throw new Error("Reached unreachable state");if(vp(t)){c=t.value;break}l.push(t)}else d?d=!1:l.push(t)}if(u&&n&&!c&&1===l.length&&l[0].type===Si&&void 0===p){let e=l[0].value;if(s&&e.startsWith("CLI=")){const t=new te(e,{pos:4}),r=Oa(t);if(1!==r.major||0!==r.minor)throw new Tp(`Unsupported CLI version (${r.text})`);e=t.tail()}return Ap(Vi(e),{stacktrace:t,inspect:r,jsHellAllowed:!0})}if(0===l.length){if(!i||c)throw new Error("expected scriptlet name");l.push({type:Si,value:"help"})}if(l[0].type!==Si)throw new Error("expected scriptlet name");const g=new hp(l,{cwdForResolveScriptlet:p,stacktrace:t,inspect:r,pipeTail:o});if(!c)return g;if(u)throw new Error("expected command");return new wp(g,c,Ap(e,{head:!1,pipeTail:"|"===c,jsHellAllowed:!0}))}class Op{#p;#ze;lastJoin="";nextJoin="";constructor(e){this.#ze=e}next(e){const t=this.#ze;if(null===t)return{node:t,pipeTail:!1,pipeHead:!1};if(this.lastJoin=this.nextJoin,"&&"===this.lastJoin&&!1===e)return{node:this.#ze=null,pipeTail:!1,pipeHead:!1};const r="|"===this.lastJoin;if(t.type===up)return this.nextJoin="",this.#ze=null,{node:t,pipeTail:r,pipeHead:!1};if(t.type===gp){if(this.nextJoin=t.operator,t.lhs.type===up)return this.#ze=t.rhs,{node:t.lhs,pipeTail:r,pipeHead:"|"===this.nextJoin};throw new TypeError("Invalid CliNode tree")}throw new TypeError("Invalid CliNode type")}}const Np="00000000-0000-0000-0000-000000000000";function jp({stdout:e,EOL:t=("win32"===process.platform?"\r\n":"\n"),sessionId:r=Np,env:n=process.env}={}){return{EOL:t,SCREEN_COLUMNS:e?.columns??80,expandGlobs:!0,fetch:zl,...rp,Buffer:Buffer,Math:tp,Uint8Array:Uint8Array,console:console,...sp,env:n,sessionId:r}}class Ip{pwd;chdir;stdout;stdin;stderr;console;EOL;constructor({platform:e=process.platform,cwd:t=process.cwd,chdir:r=process.chdir,stdin:n=process.stdin,stdout:i=process.stdout,stderr:o=process.stderr,console:a=new xp(o,0,{colorMode:"auto"}),EOL:s=("win32"===e?"\r\n":"\n")}=process){Object.assign(this,{pwd:t,chdir:r,stdout:i,stdin:n,stderr:o,console:a,EOL:s})}async execJob(e,{capture:t,startupDir:r=this.pwd()}){const{pwd:n,chdir:i,stdin:o,stdout:a,stderr:s,EOL:l}=this;let p=!0;const c=Np;try{i(r);const s=e.slice(1);s[0]=Wa;const u=Array.from(Wi(s)),d=new Op(Ap(u.values(),{reparse:!0,jsHellAllowed:!0,versionAllowed:!0}));let f,m,h=!1;for(let{node:e,pipeHead:r,pipeTail:s}=d.next();e;({node:e,pipeHead:r,pipeTail:s}=d.next(m))){if(s&&!h)throw new Error("pipe has a tail but no head");f=s?m:o,p=e.stacktrace;const u=e.cwdForResolveScriptlet;void 0!==u&&i(u),await e.resolveScriptlet();const d=new Ep(this);try{if(e.resolveOptions(),s&&""===e.fileTopicKey)throw new TypeError(U`cannot pipe to ${e.scriptletName} - it doesn't consume stdin`);void 0!==e.cwd&&i(e.cwd),({stacktrace:p}=e);const u=s?f:null,g=r?mp:t?dp:fp,y={stdin:o,stdout:a,cwd:n(),globalDefaults:jp({stdout:a,EOL:l,sessionId:c}),inspect:e.inspect,brk:!1};await d.openLog(e.logfile);const v=d.console;y.globalDefaults.console=v,d.lexicalEnvironmentOptions=y;const{success:w,value:b}=await mr(d,(()=>e.exec(y,g,u)));if(!w)return v.statusFlush?.(),e.error(b),2;if(v.statusClear?.(),r)m=b,h=!0;else{if(!t&&"boolean"!=typeof b&&void 0!==b)throw new Error("No result expected");m=b,h=!1}}finally{d.finalise({stacktrace:p}),await d.flushStatusAndCloseLog()}}return t?{success:!0,value:m}:!1===m?1:0}catch(e){return"string"==typeof e.sourceText&&"number"==typeof e.sourceIndex&&(console.log("processing: %s",e.sourceText.replaceAll(/[\r\n]/g," ")),console.log("processing: %s","_".repeat(e.sourceIndex)+"^")),console.error(Wa+": %s",p&&"parse"!==e.type&&e.name!==Tp.name?e.stack:e.message),5}}finalise(){}}var Lp=Object.freeze({__proto__:null,default:async function({argv:e=process.argv,capture:t,startupDir:r,...n}={}){if(void 0!==fr()){console.assert((i=n,0===Object.keys(i).length),"Extra options passed to shell won't be used.");return fr().shell.execJob(e,{capture:t,startupDir:r})}{void 0===kp&&(kp=globalThis.console,Object.defineProperty(globalThis,"console",{get:()=>fr()?.console??kp})),function(){const{alert:e,prompt:t,confirm:r}=sp;void 0===globalThis.alert?globalThis.alert=e:globalThis.alert!==e&&console.warn("global `alert`: already exists, and won't be gash's version."),void 0===globalThis.prompt?globalThis.prompt=t:globalThis.prompt!==t&&console.warn("global `prompt`: already exists, and won't be gash's version."),void 0===globalThis.confirm?globalThis.confirm=r:globalThis.confirm!==r&&console.warn("global `confirm`: already exists, and won't be gash's version.")}();const i=new Ip(n),o=new Ep(i,{},i.console);try{return await mr(o,(()=>i.execJob(e,{capture:t,startupDir:r})))}finally{console.assert(!o.hasFinalisation(),"The login job should have no registered cleanup."),o.finalise(),i.finalise()}}var i},getGlobalDefaults:jp,parseInvocation:Ap});
